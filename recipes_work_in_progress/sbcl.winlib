export NAME="Steel Bank Common Lisp"
export STATUS=
export URL=http://www.sbcl.org/
export BASENAME=sbcl
export DESCRIPTION="Steel Bank Common Lisp (SBCL) is a high performance Common Lisp compiler. It is open source / free software, with a permissive license. In addition to the compiler and runtime system for ANSI Common Lisp, it provides an interactive environment including a debugger, a statistical profiler, a code coverage tool, and many other extensions."
export CATEGORY=development
export TYPE=application
#export VERSION=1.4.12
#export VERSIONDATE=20180929
#export VERSION=1.4.13
#export VERSIONDATE=20181028
#export VERSION=1.4.14
#export VERSIONDATE=20181129
#export VERSION=1.4.15
#export VERSIONDATE=20181230
#export VERSION=1.4.16
#export VERSIONDATE=20190127
#export VERSION=1.5.0
#export VERSIONDATE=20190225
#export VERSION=1.5.1
#export VERSIONDATE=20190331
#export VERSION=1.5.2
#export VERSIONDATE=20190430
#export VERSION=1.5.3
#export VERSIONDATE=20190528
#export VERSION=1.5.4
#export VERSIONDATE=20190630
#export VERSION=1.5.5
#export VERSIONDATE=20190728
#export VERSION=1.5.6
#export VERSIONDATE=20190826
#export VERSION=1.5.7
#export VERSIONDATE=20190928
#export VERSION=1.5.8
#export VERSIONDATE=20191026
#export VERSION=1.5.9
#export VERSIONDATE=20191127
#export VERSION=2.0.0
#export VERSIONDATE=20191229
#export VERSION=2.0.1
#export VERSIONDATE=20200127
#export VERSION=2.0.2
#export VERSIONDATE=20200301
#export VERSION=2.0.3
#export VERSIONDATE=20200329
#export VERSION=2.0.4
#export VERSIONDATE=20200427
#export VERSION=2.0.5
#export VERSIONDATE=20200531
#export VERSION=2.0.6
#export VERSIONDATE=20200629
#export VERSION=2.0.7
#export VERSIONDATE=20200731
#export VERSION=2.0.8
#export VERSIONDATE=20200831
#export VERSION=2.0.9
#export VERSIONDATE=20200928
#export VERSION=2.0.10
#export VERSIONDATE=20201027
#export VERSION=2.0.11
#export VERSIONDATE=20201129
#export VERSION=2.1.0
#export VERSIONDATE=20201229
#export VERSION=2.1.1
#export VERSIONDATE=20210130
#export VERSION=2.1.2
#export VERSIONDATE=20210302
#export VERSION=2.1.3
#export VERSIONDATE=20210329
#export VERSION=2.1.4
#export VERSIONDATE=20210429
#export VERSION=2.1.5
#export VERSIONDATE=20210531
#export VERSION=2.1.6
#export VERSIONDATE=20210629
#export VERSION=2.1.7
#export VERSIONDATE=20210730
#export VERSION=2.1.8
#export VERSIONDATE=20210830
#export VERSION=2.1.9
#export VERSIONDATE=20210928
#export VERSION=2.1.10
#export VERSIONDATE=20211029
#export VERSION=2.1.11
#export VERSIONDATE=20211201
#export VERSION=2.2.0
#export VERSIONDATE=20211231
#export VERSION=2.2.1
#export VERSIONDATE=20220130
#export VERSION=2.2.2
#export VERSIONDATE=20220227
#export VERSION=2.2.3
#export VERSIONDATE=20220329
#export VERSION=2.2.4
#export VERSIONDATE=20220430
#export VERSION=2.2.5
#export VERSIONDATE=20220531
#export VERSION=2.2.6
#export VERSIONDATE=20220630
#export VERSION=2.2.7
#export VERSIONDATE=20220729
#export VERSION=2.2.8
#export VERSIONDATE=20220830
#export VERSION=2.2.9
#export VERSIONDATE=20220929
#export VERSION=2.2.10
#export VERSIONDATE=20221031
#export VERSION=2.2.11
#export VERSIONDATE=20221129
#export VERSION=2.3.0
#export VERSIONDATE=20221229
#export VERSION=2.3.1
#export VERSIONDATE=20230128
export VERSION=2.3.2
export VERSIONDATE=20230226
wl-showstatus --package-version
export DEPENDENCIES=
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=cmake,msitools
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=COPYING
export LICENSETYPE=BSD-style
#export DOWNLOADURL="http://www.sbcl.org/platform-table.html"
export DOWNLOADURL="https://sourceforge.net/projects/sbcl/files/sbcl/"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
#export DOWNLOADSOURCEURL=https://download.sourceforge.net/project/sbcl/sbcl/$VERSION/sbcl-$VERSION-source.tar.bz2
export DOWNLOADSOURCEURL=https://downloads.sourceforge.net/project/sbcl/sbcl/$VERSION/sbcl-$VERSION-source.tar.bz2
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
tar xfj $TARBALLDIR/$BASENAME/sbcl-$VERSION-source.tar.bz2
cd $BASENAME-$VERSION

wl-download -v -d $TARBALLDIR/$BASENAME http://prdownloads.sourceforge.net/sbcl/sbcl-1.4.2-x86$(if ( echo $RUNPLATFORM | grep -q x86_64 ); then echo "-64"; fi)-windows-binary.msi
#wl-download -v -d $TARBALLDIR/$BASENAME https://download.sourceforge.net/project/sbcl/sbcl/$VERSION/sbcl-$VERSION-x86$(if ( echo $RUNPLATFORM | grep -q x86_64 ); then echo "-64"; fi)-windows-binary.msi
$MINGWPREFIX/share/msitools/bin/msiextract.exe -C prebuilt $TARBALLDIR/$BASENAME/sbcl-1.4.2-x86$(if ( echo $RUNPLATFORM | grep -q x86_64 ); then echo "-64"; fi)-windows-binary.msi
#$MINGWPREFIX/share/msitools/bin/msiextract.exe -C prebuilt $TARBALLDIR/$BASENAME/sbcl-$VERSION-x86$(if ( echo $RUNPLATFORM | grep -q x86_64 ); then echo "-64"; fi)-windows-binary.msi
#mv -f prebuilt/PFiles/Steel\ Bank\ Common\ Lisp/*/* prebuilt/
#mv -f prebuilt/Program\ Files/Steel\ Bank\ Common\ Lisp/*/* prebuilt/
mv -f prebuilt/PFiles/Steel\ Bank\ Common\ Lisp/1.4.2/* prebuilt/

wl-showstatus build &&
 #PATH=$(pwd)/prebuilt/PFiles/Steel\ Bank\ Common\ Lisp/1.4.2:$PATH ./make.sh --prefix=$INSTALLPREFIX &&
 CC=${CC:-gcc} ./make.sh --prefix=$INSTALLPREFIX --xc-host="$(pwd)/prebuilt/sbcl.exe --core $(pwd)/prebuilt/sbcl.core" &&
    echo OK
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION



