export NAME="NodeGui"
export STATUS=
export URL=https://docs.nodegui.org/
export BASENAME=nodegui
export DESCRIPTION="NodeGui - Build performant, native, cross platform desktop apps with JavaScript and CSS"
export CATEGORY=
export TYPE=library
#export VERSION=0.39.1
#export VERSIONDATE=20211001
#export VERSION=0.41.0
#export VERSIONDATE=20211113
#export VERSION=0.42.0
#export VERSIONDATE=20211205
#export VERSION=0.43.0
#export VERSIONDATE=20211212
#export VERSION=0.44.0
#export VERSIONDATE=20211227
#export VERSION=0.44.2
#export VERSIONDATE=20211229
#export VERSION=0.45.3
#export VERSIONDATE=20220102
#export VERSION=0.45.4
#export VERSIONDATE=20220103
#export VERSION=0.46.0
#export VERSIONDATE=20220210
#export VERSION=0.47.0
#export VERSIONDATE=20220305
#export VERSION=0.48.0
#export VERSIONDATE=20220402
#export VERSION=0.49.0
#export VERSIONDATE=20220409
#export VERSION=0.50.0
#export VERSIONDATE=20220420
#export VERSION=0.51.0
#export VERSIONDATE=20220520
#export VERSION=0.52.0
#export VERSIONDATE=20220524
#export VERSION=0.53.0
#export VERSIONDATE=20220528
#export VERSION=0.54.0
#export VERSIONDATE=20220606
#export VERSION=0.55.0
#export VERSIONDATE=20220702
#export VERSION=0.56.0
#export VERSIONDATE=20220716
#export VERSION=0.57.0
#export VERSIONDATE=20220816
#export VERSION=0.57.1
#export VERSIONDATE=20220904
#export VERSION=0.57.2
#export VERSIONDATE=20221118
#export VERSION=0.57.3
#export VERSIONDATE=20221203
#export VERSION=0.58.0
#export VERSIONDATE=20230217
export VERSION=0.59.0
export VERSIONDATE=20230308
wl-showstatus --package-version
export DEPENDENCIES=qt
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=cmake,ninja
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=LICENSE
export LICENSETYPE=MIT
export DOWNLOADURL="https://github.com/nodegui/nodegui/releases"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=https://github.com/nodegui/nodegui/archive/refs/tags/v$VERSION.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
tar xz --force-local -f $TARBALLDIR/$BASENAME/v$VERSION.tar.gz
cd $BASENAME-$VERSION
# fix config/napi.cmake (version >= 0.39.1)
patch -ulbf config/napi.cmake << EOF
@@ -7,4 +7,4 @@
     )
-    string(REPLACE "\\n" "" NODE_ADDON_API_DIR \${NODE_ADDON_API_DIR})
-    string(REPLACE "\\"" "" NODE_ADDON_API_DIR \${NODE_ADDON_API_DIR})
+    string(REPLACE "\\n" "" NODE_ADDON_API_DIR "\${NODE_ADDON_API_DIR}")
+    string(REPLACE "\\"" "" NODE_ADDON_API_DIR "\${NODE_ADDON_API_DIR}")

EOF
mkdir -p build_win &&
 wl-showstatus configure &&
 PATH=$PATH:$MINGWPREFIX/qt/bin QTDIR=$MINGWPREFIX/qt QMAKESPEC=$MINGWPREFIX/qt/mkspecs/win32-g++ cmake.exe -Wno-dev -GNinja -DCMAKE_INSTALL_PREFIX:PATH=$INSTALLPREFIX -DCMAKE_BUILD_TYPE:STRING=Release -S. -Bbuild_win &&
 wl-showstatus build &&
 ninja -Cbuild_win &&
 wl-showstatus build-install &&
 ninja -Cbuild_win install/strip &&
    echo OK
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION



