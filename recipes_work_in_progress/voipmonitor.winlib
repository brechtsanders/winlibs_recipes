export NAME="VoIP monitor"
export STATUS=
export URL=http://www.voipmonitor.org/
export BASENAME=voipmonitor
export DESCRIPTION="VoIPmonitor is open source network packet sniffer with commercial frontend for SIP SKINNY RTP and RTCP VoIP protocols running on linux. VoIPmonitor is designed to analyze quality of VoIP call based on network parameters - delay variation and packet loss according to ITU-T G.107 E-model which predicts quality on MOS scale. Calls with all relevant statistics are saved to MySQL or ODBC database. Optionally each call can be saved to pcap file with either only SIP / SKINNY protocol or SIP/RTP/RTCP/T.38/udptl protocols. VoIPmonitor can also decode audio."
export CATEGORY=communication
export TYPE=application
#export VERSION=15.4.5
#export VERSIONDATE=20160316
#export VERSION=15.5.6
#export VERSIONDATE=20160406
#export VERSION=15.6
#export VERSIONDATE=20160411
#export VERSION=15.7
#export VERSIONDATE=20160421
#export VERSION=16.0
#export VERSIONDATE=20160528
#export VERSION=16.1
#export VERSIONDATE=20160627
#export VERSION=17.0
#export VERSIONDATE=20160802
#export VERSION=17.1
#export VERSIONDATE=20160824
#export VERSION=17.2
#export VERSIONDATE=20160903
#export VERSION=17.3
#export VERSIONDATE=20160905
#export VERSION=17.4
#export VERSIONDATE=20161024
#export VERSION=17.5
#export VERSIONDATE=20161102
#export VERSION=17.6
#export VERSIONDATE=20161122
#export VERSION=17.7
#export VERSIONDATE=20161208
####checking for mysql_config executable... not found
#export VERSION=17.8
#export VERSIONDATE=20161213
#export VERSION=17.9
#export VERSIONDATE=20161214
#export VERSION=17.10
#export VERSIONDATE=20161220
#export VERSION=17.11
#export VERSIONDATE=20170106
####calltable.cpp:17:20: fatal error: syslog.h: No such file or directory
#export VERSION=17.12
#export VERSIONDATE=20170110
#export VERSION=17.14
#export VERSIONDATE=20170118
#export VERSION=17.15
#export VERSIONDATE=20170131
#export VERSION=18.0
#export VERSIONDATE=20170206
#export VERSION=18.1
#export VERSIONDATE=20170208
#export VERSION=18.2
#export VERSIONDATE=20170212
####make: *** No rule to make target 'asm/byteorder.h', needed by 'calltable.o'.  Stop.
#export VERSION=18.3.1
#export VERSIONDATE=20170215
#export VERSION=19.0
#export VERSIONDATE=20170217
#export VERSION=19.3
#export VERSIONDATE=20170403
#export VERSION=19.4
#export VERSIONDATE=20170426
#export VERSION=19.5
#export VERSIONDATE=20170518
#export VERSION=20.0
#export VERSIONDATE=20170620
#export VERSION=20.1
#export VERSIONDATE=20170622
#export VERSION=20.2
#export VERSIONDATE=20170629
#export VERSION=20.4
#export VERSIONDATE=20170815
#export VERSION=20.4.4
#export VERSIONDATE=20171216
#export VERSION=21.0
#export VERSIONDATE=20171003
#export VERSION=21.1
#export VERSIONDATE=20171012
#export VERSION=21.2
#export VERSIONDATE=20171017
#export VERSION=21.3
#export VERSIONDATE=20171116
#export VERSION=21.4
#export VERSIONDATE=20171204
#export VERSION=21.5
#export VERSIONDATE=20171209
#export VERSION=21.5.1
#export VERSIONDATE=20171216
#export VERSION=21.7
#export VERSIONDATE=20180131
#export VERSION=21.8
#export VERSIONDATE=20180207
#export VERSION=22.0
#export VERSIONDATE=20180217
#export VERSION=22.1
#export VERSIONDATE=20180312
#export VERSION=22.3
#export VERSIONDATE=20180330
#export VERSION=22.4
#export VERSIONDATE=20180405
#export VERSION=22.5
#export VERSIONDATE=20180416
#export VERSION=22.6
#export VERSIONDATE=20180516
#export VERSION=22.7
#export VERSIONDATE=20180619
#export VERSION=22.8
#export VERSIONDATE=20180629
#export VERSION=22.9
#export VERSIONDATE=20180712
#export VERSION=22.10
#export VERSIONDATE=20180802
#export VERSION=22.11
#export VERSIONDATE=20180820
#export VERSION=22.12
#export VERSIONDATE=20180828
#export VERSION=22.12.2
#export VERSIONDATE=20181004
#export VERSION=23.1
#export VERSIONDATE=20181102
#export VERSION=23.2
#export VERSIONDATE=20181206
#export VERSION=23.4
#export VERSIONDATE=20190109
#export VERSION=23.5
#export VERSIONDATE=20190117
#export VERSION=23.6
#export VERSIONDATE=20190208
#export VERSION=23.7
#export VERSIONDATE=20190307
#export VERSION=24.0
#export VERSIONDATE=20190315
#export VERSION=24.1
#export VERSIONDATE=20190412
#export VERSION=24.2
#export VERSIONDATE=20190423
#export VERSION=25.0
#export VERSIONDATE=20190613
#export VERSION=25.1
#export VERSIONDATE=20190629
#export VERSION=25.2
#export VERSIONDATE=20190709
#export VERSION=25.3
#export VERSIONDATE=20190724
#export VERSION=25.4
#export VERSIONDATE=20190809
#export VERSION=25.5
#export VERSIONDATE=20190820
#export VERSION=25.6
#export VERSIONDATE=20190908
#export VERSION=25.7
#export VERSIONDATE=20190920
#export VERSION=25.9
#export VERSIONDATE=20191113
####jitterbuffer/asterisk/endian.h:58:2: error: #error Need to know endianess
#export VERSION=26.0
#export VERSIONDATE=20191124
#export VERSION=26.1
#export VERSIONDATE=20191125
#export VERSION=26.2
#export VERSIONDATE=20191130
#export VERSION=26.3
#export VERSIONDATE=20191206
#export VERSION=26.4
#export VERSIONDATE=20191209
#export VERSION=26.5
#export VERSIONDATE=20200106
#export VERSION=26.7
#export VERSIONDATE=20200115
#export VERSION=26.8
#export VERSIONDATE=20200123
#export VERSION=26.9
#export VERSIONDATE=20200207
#export VERSION=26.10
#export VERSIONDATE=20200213
#export VERSION=26.11
#export VERSIONDATE=20200312
#export VERSION=26.12
#export VERSIONDATE=20200313
#export VERSION=26.13
#export VERSIONDATE=20200320
#export VERSION=26.14
#export VERSIONDATE=20200420
#export VERSION=26.15
#export VERSIONDATE=20200508
#export VERSION=26.16
#export VERSIONDATE=20200526
#export VERSION=26.17
#export VERSIONDATE=20200624
#export VERSION=26.18
#export VERSIONDATE=20200703
#export VERSION=26.19
#export VERSIONDATE=20200721
#export VERSION=26.20
#export VERSIONDATE=20200812
#export VERSION=26.21
#export VERSIONDATE=20200828
#export VERSION=26.22
#export VERSIONDATE=20200912
#export VERSION=27.0
#export VERSIONDATE=20200921
#export VERSION=27.1
#export VERSIONDATE=20201015
#export VERSION=27.2
#export VERSIONDATE=20201124
#export VERSION=27.2.1
#export VERSIONDATE=20201124
#export VERSION=27.2.2
#export VERSIONDATE=20201202
#export VERSION=27.4
#export VERSIONDATE=20201230
#export VERSION=27.6
#export VERSIONDATE=20210216
#export VERSION=27.6.1
#export VERSIONDATE=20210217
#export VERSION=27.7
#export VERSIONDATE=20210218
#export VERSION=27.7.1
#export VERSIONDATE=20210224
#export VERSION=27.7.2
#export VERSIONDATE=20210303
#export VERSION=27.7.3
#export VERSIONDATE=20210306
#export VERSION=27.7.4
#export VERSIONDATE=20210311
#export VERSION=27.8
#export VERSIONDATE=20210407
#export VERSION=28.0
#export VERSIONDATE=20210505
#export VERSION=28.1
#export VERSIONDATE=20210506
#export VERSION=28.2
#export VERSIONDATE=20210526
#export VERSION=28.3
#export VERSIONDATE=20210609
#export VERSION=28.4
#export VERSIONDATE=20210623
#export VERSION=28.4.1
#export VERSIONDATE=20210624
#export VERSION=28.5
#export VERSIONDATE=20210630
#export VERSION=28.6
#export VERSIONDATE=20210715
#export VERSION=28.7
#export VERSIONDATE=20210727
#export VERSION=28.8
#export VERSIONDATE=20210817
#export VERSION=29.0
#export VERSIONDATE=20211117
#export VERSION=29.1
#export VERSIONDATE=20211221
#export VERSION=29.1.1
#export VERSIONDATE=20220113
#export VERSION=29.1.2
#export VERSIONDATE=20220120
#export VERSION=29.1.3
#export VERSIONDATE=20220126
#export VERSION=29.1.4
#export VERSIONDATE=20220128
#export VERSION=29.2
#export VERSIONDATE=20220302
#export VERSION=30.0
#export VERSIONDATE=20220429
#export VERSION=30.1
#export VERSIONDATE=20220622
#export VERSION=30.2
#export VERSIONDATE=20220715
#export VERSION=30.3
#export VERSIONDATE=20220805
#export VERSION=30.4
#export VERSIONDATE=20220913
#export VERSION=30.5
#export VERSIONDATE=20221005
#export VERSION=30.6
#export VERSIONDATE=20221018
#export VERSION=30.7
#export VERSIONDATE=20221027
#export VERSION=30.8
#export VERSIONDATE=20221029
#export VERSION=30.8.1
#export VERSIONDATE=20221101
#export VERSION=30.8.2
#export VERSIONDATE=20221105
#export VERSION=30.8.3
#export VERSIONDATE=20221111
#export VERSION=31.0
#export VERSIONDATE=20230104
#export VERSION=31.0.2
#export VERSIONDATE=20230104
#export VERSION=31.1
#export VERSIONDATE=20230118
#export VERSION=31.2
#export VERSIONDATE=20230201
#export VERSION=31.2.1
#export VERSIONDATE=20230202
#export VERSION=31.2.2
#export VERSIONDATE=20230207
#export VERSION=31.3
#export VERSIONDATE=20230221
#export VERSION=31.4
#export VERSIONDATE=20230315
#export VERSION=31.5
#export VERSIONDATE=20230321
#export VERSION=31.6
#export VERSIONDATE=20230420
#export VERSION=31.7
#export VERSIONDATE=20230607
#export VERSION=31.7.1
#export VERSIONDATE=20230607
#export VERSION=31.7.2
#export VERSIONDATE=20230608
#export VERSION=31.7.3
#export VERSIONDATE=20230609
#export VERSION=31.7.4
#export VERSIONDATE=20230622
#export VERSION=31.7.5
#export VERSIONDATE=20230623
#export VERSION=31.8
#export VERSIONDATE=20230825
#export VERSION=31.9
#export VERSIONDATE=20230905
#export VERSION=2023.11.0
#export VERSIONDATE=20231122
#export VERSION=2023.11.3
#export VERSIONDATE=20231125
#export VERSION=2023.11.4
#export VERSIONDATE=20231125
#export VERSION=2023.11.6
#export VERSIONDATE=20231129
#export VERSION=2023.11.7
#export VERSIONDATE=20231130
#export VERSION=2023.11.9
#export VERSIONDATE=20231201
#export VERSION=2023.12.0
#export VERSIONDATE=20231206
#export VERSION=2023.12.1
#export VERSIONDATE=20231211
#export VERSION=2023.12.2
#export VERSIONDATE=20231215
#export VERSION=2023.12.3
#export VERSIONDATE=20231220
#export VERSION=2024.01
#export VERSIONDATE=20240104
#export VERSION=2024.01.1
#export VERSIONDATE=20240106
#export VERSION=2024.01.2
#export VERSIONDATE=20240124
#export VERSION=2024.01.3
#export VERSIONDATE=20240124
#export VERSION=2024.01.4
#export VERSIONDATE=20240129
#export VERSION=2024.01.5
#export VERSIONDATE=20240131
#export VERSION=2024.01.6
#export VERSIONDATE=20240201
#export VERSION=2024.02.1
#export VERSIONDATE=20240202
#export VERSION=2024.02.2
#export VERSIONDATE=20240221
#export VERSION=2024.02.3
#export VERSIONDATE=20240224
#export VERSION=2024.02.5
#export VERSIONDATE=20240226
#export VERSION=2024.02.6
#export VERSIONDATE=20240301
#export VERSION=2024.03.1
#export VERSIONDATE=20240310
#export VERSION=2024.04.1
#export VERSIONDATE=20240402
#export VERSION=2024.05.1
#export VERSIONDATE=20240403
#export VERSION=2024.05.2
#export VERSIONDATE=20240505
#export VERSION=2024.06.1
#export VERSIONDATE=20240619
#export VERSION=2024.06.2
#export VERSIONDATE=20240620
#export VERSION=2024.07.1
#export VERSIONDATE=20240717
#export VERSION=2024.08.1
#export VERSIONDATE=20240807
#export VERSION=2024.09.1
#export VERSIONDATE=20240907
#export VERSION=2024.09.2
#export VERSIONDATE=20240911
#export VERSION=2024.09.3
#export VERSIONDATE=20240919
#export VERSION=2024.09.4
#export VERSIONDATE=20240920
#export VERSION=2024.10.1
#export VERSIONDATE=20241002
#export VERSION=2024.10.2
#export VERSIONDATE=20241022
#export VERSION=2024.11.0
#export VERSIONDATE=20241125
export VERSION=2024.11.1
export VERSIONDATE=20241128
wl-showstatus --package-version
export DEPENDENCIES=rrdtool,xz,libssh,gnutls,libpng,fftw,libpng,openssl,snappy,libvorbis,jemalloc
export OPTIONALDEPENDENCIES=gperftools
export BUILDDEPENDENCIES=
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=COPYING
export LICENSETYPE=
export DOWNLOADURL="https://sourceforge.net/projects/voipmonitor/files/"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
#export DOWNLOADSOURCEURL=http://downloads.sourceforge.net/project/voipmonitor/$(echo $VERSION|sed -e "s/^\([0-9]*\.[0-9]*\)\..*$/\1/")/$BASENAME-$VERSION-src.tar.gz
export DOWNLOADSOURCEURL=https://downloads.sourceforge.net/project/voipmonitor/$(echo $VERSION|sed -e "s/^\([0-9]*\.[0-9]*\)\..*$/\1/")/$BASENAME-$VERSION-src.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
tar xz --force-local -f $TARBALLDIR/$BASENAME/$BASENAME-$VERSION-src.tar.gz
cd $BASENAME-$VERSION-src
# fix detection of endianness in jitterbuffer/asterisk/endian.h
mv jitterbuffer/asterisk/endian.h jitterbuffer/asterisk/endian.h.bak
cat > jitterbuffer/asterisk/endian.h << EOF
#ifndef __BYTE_ORDER
#define __LITTLE_ENDIAN 1234
#define __BYTE_ORDER __LITTLE_ENDIAN
#endif
EOF
cat jitterbuffer/asterisk/endian.h.bak >> jitterbuffer/asterisk/endian.h
# fix endian.h (version >= 31.7.1)
patch -ulbf endian.h << EOF
@@ -11,2 +11,5 @@
 # define __LITTLE_ENDIAN _LITTLE_ENDIAN
+#elif defined _WIN32
+# define __LITTLE_ENDIAN 1234
+# define __BYTE_ORDER __LITTLE_ENDIAN
 #else
EOF
# fix tools_global.h (version >= 31.7.1)
patch -ulbf tools_global.h << EOF
@@ -14,3 +14,5 @@
 #include <unistd.h>
+#ifndef _WIN32
 #include <sys/syscall.h>
+#endif
 #include <unicode/ucnv.h>
EOF
# fix ip.h (version >= 31.7.1)
patch -ulbf ip.h << EOF
@@ -21,2 +21,11 @@
 #include <sys/types.h>
+#ifdef _WIN32
+#include <winsock2.h>
+#include <ws2tcpip.h>
+#include <stdint.h>
+#define u_int8_t uint8_t
+#define u_int16_t uint16_t
+#define u_int32_t uint32_t
+#define u_int64_t uint64_t
+#else
 #include <sys/socket.h>
@@ -26,2 +35,3 @@
 #include <arpa/inet.h>
+#endif
 #include <string>
EOF
# fix heap_safe.h (version >= 31.7.1)
patch -ulbf heap_safe.h << EOF
@@ -6,3 +6,5 @@
 #include <string.h>
+#ifndef _WIN32
 #include <syslog.h>
+#endif
 #include <string>
EOF
# fix missing files
mkdir -p asm
touch asm/byteorder.h
mkdir -p winfix/sys winfix/arpa winfix/net winfix/netinet
echo "#include <winsock.h>" > winfix/sys/socket.h
echo "#include <winsock.h>" > winfix/arpa/inet.h
echo "#include <ws2tcpip.h>" > winfix/netinet/ip6.h
echo "#include <ws2ipdef.h>" >> winfix/netinet/ip6.h
#echo "#include <ws2tcpip.h>" > winfix/netdb.h
cat > winfix/syslog.h << EOF
EOF
touch winfix/netdb.h winfix/sys/ioctl.h winfix/sys/resource.h winfix/sys/syscall.h winfix/endian.h winfix/net/if.h winfix/net/ethernet.h winfix/netinet/in.h winfix/netinet/ip.h winfix/netinet/tcp.h
# fix undefined u_int16_t in bswap.h (version >= 2024.02.1)
mv bswap.h bswap.h.bak &&
echo "#include <stdint.h>" > bswap.h &&
echo "#define u_int16_t uint16_t" >> bswap.h &&
echo "#define u_int32_t uint32_t" >> bswap.h &&
echo "#define u_int64_t uint64_t" >> bswap.h &&
echo "typedef unsigned char u_char;" >> bswap.h &&
cat bswap.h.bak >> bswap.h
# fix detection of libcurl (version >= 31.5)
sed -i.bak -e "s/as_fn_error\(.*Bad curl version\)/echo\1/" configure
wl-showstatus configure &&
 #./autogen.sh &&
 #    echo OK
 ## fix building DLLs on 64-bit
 #if ( echo $RUNPLATFORM | grep -q x86_64 ); then
 # echo "AM_GNU_GETTEXT_VERSION([$(gettext --version|head -n1|sed -e "s/^.* \([0-9\.]*\) *$/\1/")])" >> configure.ac &&
 # autoreconf -f -i -I m4 -I $MINGWPREFIX/share/aclocal
 #fi
 #INTLTOOL_PERL="$PERLDIR/bin/perl.exe" 
 #PERL="$PERLDIR/bin/perl.exe -I$PERLDIR/lib" 
 #PYTHON=$PYDIR/python.exe 
 #PYTHON=$PYDIR/python.exe C_INCLUDE_PATH=$PYDIR/include${C_INCLUDE_PATH:+:$C_INCLUDE_PATH} 
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM LDFLAGS="-Wl,--as-needed -Wl,-no-undefined" &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM LDFLAGS="-Wl,--as-needed" &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --with-mysql=$MINGWPREFIX CFLAGS="-I$(pwd)/winfix" CXXFLAGS="-I$(pwd)/winfix" &&
 ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --with-mysql=$MINGWPREFIX/bin/mysql_config.exe CFLAGS="-I$PWD/winfix" CXXFLAGS="-I$PWD/winfix -I$MINGWPREFIX/include/mariadb" &&
 ## fix detection of endianness
 #echo "#ifndef __BYTE_ORDER" >> config.h &&
 #echo "#define __LITTLE_ENDIAN 1234" >> config.h &&
 #echo "#define __BYTE_ORDER __LITTLE_ENDIAN" >> config.h &&
 #echo "#endif" >> config.h &&
 ## fix building DLLs
 #mv libtool libtool.bak &&
 #sed -e "s/\(allow_undefined=\)yes/\1no/" libtool.bak > libtool &&
 wl-showstatus build &&
 make CC="${CC:-gcc} -I$(pwd)/winfix" CXX="${CXX:-g++} -I$(pwd)/winfix -I$MINGWPREFIX/include/pcap" &&
 wl-showstatus build-install &&
 #make install-strip &&
 make install CC=${CC:-gcc} &&
    echo OK
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION-src



