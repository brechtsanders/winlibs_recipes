export NAME="Blender"
export STATUS=
export URL=https://www.blender.org/
export BASENAME=blender
export DESCRIPTION="Blender is the free and open source 3D creation suite. It supports the entirety of the 3D pipelineâ€”modeling, rigging, animation, simulation, rendering, compositing and motion tracking, even video editing and game creation."
export CATEGORY=graphics,video
export TYPE=application
#export VERSION=2.78c
#export VERSIONDATE=20170429
####Set the cache entry 'PYTHON_INCLUDE_DIR' to point to a valid python include path. Containing Python.h for python version "3.5"
####intern/ghost/intern/GHOST_WindowWin32.h:46:20: fatal error: wintab.h: No such file or directory
#export VERSION=2.79
#export VERSIONDATE=20170912
#export VERSION=2.79a
#export VERSIONDATE=20180228
#export VERSION=2.79b
#export VERSIONDATE=20180324
#export VERSION=2.80
#export VERSIONDATE=20180730
#export VERSION=2.81
#export VERSIONDATE=20191121
#export VERSION=2.81a
#export VERSIONDATE=20191206
#export VERSION=2.82
#export VERSIONDATE=20200213
#export VERSION=2.82a
#export VERSIONDATE=20200314
#export VERSION=2.83.0
#export VERSIONDATE=20200604
#export VERSION=2.83.1
#export VERSIONDATE=20200626
#export VERSION=2.83.2
#export VERSIONDATE=20200709
#export VERSION=2.83.3
#export VERSIONDATE=20200722
#export VERSION=2.83.4
#export VERSIONDATE=20200805
#export VERSION=2.83.5
#export VERSIONDATE=20200819
#export VERSION=2.83.6
#export VERSIONDATE=20200909
#export VERSION=2.83.7
#export VERSIONDATE=20200930
#export VERSION=2.83.8
#export VERSIONDATE=20201021
#export VERSION=2.83.9
#export VERSIONDATE=20201111
#export VERSION=2.83.10
#export VERSIONDATE=20201209
#export VERSION=2.83.12
#export VERSIONDATE=20210127
#export VERSION=2.83.13
#export VERSIONDATE=20210310
#export VERSION=2.83.14
#export VERSIONDATE=20210512
#export VERSION=2.83.15
#export VERSIONDATE=20210520
#export VERSION=2.83.16
#export VERSIONDATE=20210616
#export VERSION=2.83.17
#export VERSIONDATE=20210811
#export VERSION=2.83.18
#export VERSIONDATE=20210929
#export VERSION=2.83.19
#export VERSIONDATE=20220202
#export VERSION=2.83.20
#export VERSIONDATE=20220420
#export VERSION=2.90.0
#export VERSIONDATE=20200901
#export VERSION=2.90.1
#export VERSIONDATE=20200923
#export VERSION=2.91.0
#export VERSIONDATE=20201125
#export VERSION=2.91.2
#export VERSIONDATE=20210120
#export VERSION=2.92.0
#export VERSIONDATE=20210225
#export VERSION=2.93.0
#export VERSIONDATE=20210603
#export VERSION=2.93.1
#export VERSIONDATE=20210623
#export VERSION=2.93.2
#export VERSIONDATE=20210804
#export VERSION=2.93.3
#export VERSIONDATE=20210818
#export VERSION=2.93.4
#export VERSIONDATE=20210901
#export VERSION=2.93.5
#export VERSIONDATE=20211006
#export VERSION=2.93.6
#export VERSIONDATE=20211117
#export VERSION=2.93.7
#export VERSIONDATE=20211215
#export VERSION=2.93.8
#export VERSIONDATE=20220202
#export VERSION=2.93.9
#export VERSIONDATE=20220420
#export VERSION=2.93.13
#export VERSIONDATE=20221221
#export VERSION=2.93.16
#export VERSIONDATE=20230321
#export VERSION=2.93.17
#export VERSIONDATE=20230418
#export VERSION=2.93.18
#export VERSIONDATE=20230523
#export VERSION=3.0.0
#export VERSIONDATE=20211203
#export VERSION=3.0.1
#export VERSIONDATE=20220126
#export VERSION=3.1.0
#export VERSIONDATE=20220309
#export VERSION=3.1.1
#export VERSIONDATE=20220330
#export VERSION=3.1.2
#export VERSIONDATE=20220401
#export VERSION=3.2.0
#export VERSIONDATE=20220608
#export VERSION=3.2.1
#export VERSIONDATE=20220706
#export VERSION=3.2.2
#export VERSIONDATE=20220803
#export VERSION=3.3.0
#export VERSIONDATE=20220907
#export VERSION=3.3.1
#export VERSIONDATE=20221005
#export VERSION=3.3.2
#export VERSIONDATE=20221207
#export VERSION=3.3.3
#export VERSIONDATE=20230117
#export VERSION=3.3.4
#export VERSIONDATE=20230221
#export VERSION=3.3.5
#export VERSIONDATE=20230221
#export VERSION=3.3.6
#export VERSIONDATE=20230418
#export VERSION=3.3.7
#export VERSIONDATE=20230523
#export VERSION=3.3.8
#export VERSIONDATE=20230620
#export VERSION=3.3.9
#export VERSIONDATE=20230718
#export VERSION=3.3.10
#export VERSIONDATE=20230817
#export VERSION=3.3.11
#export VERSIONDATE=20230921
#export VERSION=3.3.12
#export VERSIONDATE=20231019
#export VERSION=3.3.13
#export VERSIONDATE=20231124
#export VERSION=3.3.14
#export VERSIONDATE=20231214
#export VERSION=3.3.15
#export VERSIONDATE=20240125
#export VERSION=3.3.16
#export VERSIONDATE=20240226
#export VERSION=3.3.17
#export VERSIONDATE=20240320
#export VERSION=3.3.18
#export VERSIONDATE=20240416
#export VERSION=3.3.19
#export VERSIONDATE=20240521
#export VERSION=3.3.20
#export VERSIONDATE=20240625
#export VERSION=3.3.21
#export VERSIONDATE=20240716
#export VERSION=3.4.0
#export VERSIONDATE=20221207
#export VERSION=3.4.1
#export VERSIONDATE=20221220
#export VERSION=3.5.0
#export VERSIONDATE=20230329
#export VERSION=3.5.1
#export VERSIONDATE=20230425
#export VERSION=3.6.0
#export VERSIONDATE=20230627
#export VERSION=3.6.1
#export VERSIONDATE=20230718
#export VERSION=3.6.2
#export VERSIONDATE=20230817
#export VERSION=3.6.3
#export VERSIONDATE=20230921
#export VERSION=3.6.4
#export VERSIONDATE=20230926
#export VERSION=3.6.5
#export VERSIONDATE=20231019
#export VERSION=3.6.7
#export VERSIONDATE=20231214
#export VERSION=3.6.8
#export VERSIONDATE=20240125
#export VERSION=3.6.9
#export VERSIONDATE=20240226
#export VERSION=3.6.10
#export VERSIONDATE=20240320
#export VERSION=3.6.11
#export VERSIONDATE=20240416
#export VERSION=3.6.12
#export VERSIONDATE=20240521
#export VERSION=3.6.13
#export VERSIONDATE=20240625
#export VERSION=3.6.14
#export VERSIONDATE=20240716
#export VERSION=3.6.15
#export VERSIONDATE=20240820
#export VERSION=3.6.16
#export VERSIONDATE=20240924
#export VERSION=3.6.17
#export VERSIONDATE=20241015
#export VERSION=3.6.18
#export VERSIONDATE=20241119
#export VERSION=3.6.19
#export VERSIONDATE=20241217
#export VERSION=3.6.20
#export VERSIONDATE=20250121
#export VERSION=3.6.21
#export VERSIONDATE=20250218
#export VERSION=4.0.0
#export VERSIONDATE=20231114
#export VERSION=4.0.1
#export VERSIONDATE=20231117
#export VERSION=4.0.2
#export VERSIONDATE=20231207
#export VERSION=4.1.0
#export VERSIONDATE=20240327
#export VERSION=4.1.1
#export VERSIONDATE=20240416
#export VERSION=4.2.0
#export VERSIONDATE=20240716
#export VERSION=4.2.1
#export VERSIONDATE=20240820
#export VERSION=4.2.2
#export VERSIONDATE=20240924
#export VERSION=4.2.4
#export VERSIONDATE=20241119
#export VERSION=4.2.5
#export VERSIONDATE=20241217
#export VERSION=4.2.6
#export VERSIONDATE=20250121
#export VERSION=4.2.7
#export VERSIONDATE=20250218
#export VERSION=4.2.8
#export VERSIONDATE=20250318
#export VERSION=4.3.0
#export VERSIONDATE=20241119
#export VERSION=4.3.1
#export VERSIONDATE=20241210
#export VERSION=4.3.2
#export VERSIONDATE=20241217
export VERSION=4.4.0
export VERSIONDATE=20250318
####Compiler is unsupported
wl-showstatus --package-version
export DEPENDENCIES=
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=cmake
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=COPYING
export LICENSETYPE=GPL
#export DOWNLOADURL="https://www.blender.org/download/"
#export DOWNLOADURL="http://download.blender.org/source/"
export DOWNLOADURL="https://download.blender.org/source/"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=http://download.blender.org/source/$BASENAME-$VERSION.tar.gz
export DOWNLOADSOURCEURL=https://download.blender.org/source/$BASENAME-$VERSION.tar.xz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
#tar xz --force-local -f $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.gz
tar xJ --force-local -f $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.xz
patch -ulbf CMakeLists.txt << EOF
@@ -805,3 +805,4 @@
 elseif(WIN32)
-  include(platform_win32)
+  add_definitions(-DWIN32)
+  include(platform_unix)
 elseif(APPLE)
EOF
# fix build_files/cmake/platform/platform_win32.cmake (version >= 2.83.2)
patch -ulbf build_files/cmake/platform/platform_win32.cmake << EOF
@@ -24,3 +24,3 @@

-if(NOT MSVC)
+if(NOT MSVC AND NOT MINGW)
   message(FATAL_ERROR "Compiler is unsupported")
EOF
## fix build_files/cmake/platform/platform_win32.cmake (version >= 2.93.2)
#patch -ulbf build_files/cmake/platform/platform_win32.cmake << EOF
#@@ -24,5 +24,2 @@
#
#-if(NOT MSVC)
#-  message(FATAL_ERROR "Compiler is unsupported")
#-endif()
#
#EOF
## fix build_files/cmake/platform/platform_win32.cmake (version >= 3.2.0)
#patch -ulbf build_files/cmake/platform/platform_win32.cmake << EOF
#@@ -7,5 +7,2 @@
#
#-if(NOT MSVC)
#-  message(FATAL_ERROR "Compiler is unsupported")
#-endif()
#
#@@ -42,3 +39,3 @@
#   if(WITH_BLENDER AND CMAKE_CXX_COMPILER_VERSION VERSION_LESS 19.28.29921) # MSVC 2019 16.9.16
#-    message(FATAL_ERROR "Compiler is unsupported, MSVC 2019 16.9.16 or newer is required for building blender.")
#+    message(WARNING "Compiler is unsupported, MSVC 2019 16.9.16 or newer is required for building blender.")
#   endif()
#EOF
# fix build_files/cmake/platform/platform_win32.cmake (version >= 3.6.3)
patch -ulbf build_files/cmake/platform/platform_win32.cmake << EOF
@@ -8,3 +8,3 @@
 if(NOT MSVC)
-  message(FATAL_ERROR "Compiler is unsupported")
+  message(WARNING "Compiler is unsupported")
 endif()
@@ -43,3 +43,3 @@
     if(CMAKE_CXX_COMPILER_VERSION VERSION_LESS 19.28.29921) # MSVC 2019 16.9.16
-      message(FATAL_ERROR "Compiler is unsupported, MSVC 2019 16.9.16 or newer is required for building blender.")
+      message(WARNING "Compiler is unsupported, MSVC 2019 16.9.16 or newer is required for building blender.")
     endif()
EOF
## avoid MSVC stuff
#cp -f build_files/cmake/platform/platform_unix.cmake build_files/cmake/platform/platform_win32.cmake
cd $BASENAME-$VERSION
wl-showstatus configure &&
 mkdir -p build_win &&
 mkdir -p build_win/dummylib/python/include/python3.5 &&
 cp -f $PYDIR/include/Python.h build_win/dummylib/python/include/python3.5/ &&
 #cmake.exe -G"MSYS Makefiles" -DCMAKE_INSTALL_PREFIX:PATH=$INSTALLPREFIX -DCMAKE_BUILD_TYPE:STRING=Release -DLIBDIR:PATH=$MINGWPREFIX/lib -DWITH_RAYOPTIMIZATION:BOOL=OFF -DWITH_PYTHON_INSTALL:BOOL=OFF -DWITH_PYTHON_INSTALL_NUMPY:BOOL=OFF -DWITH_PYTHON_MODULE:BOOL=OFF -DPYTHON_INCLUDE_DIR:PATH=$PYDIR/include -S. -Bbuild_win &&
 #cmake.exe -G"MSYS Makefiles" -DCMAKE_INSTALL_PREFIX:PATH=$INSTALLPREFIX -DCMAKE_BUILD_TYPE:STRING=Release -DLIBDIR:PATH=$(pwd)/dummylib -DWITH_RAYOPTIMIZATION:BOOL=OFF -DWITH_PYTHON_INSTALL:BOOL=OFF -DWITH_PYTHON_INSTALL_NUMPY:BOOL=OFF -DWITH_PYTHON_MODULE:BOOL=OFF -DPYTHON_INCLUDE_DIR:PATH=$PYDIR/include -S. -Bbuild_win &&
 cmake.exe -G"MSYS Makefiles" -DCMAKE_INSTALL_PREFIX:PATH=$INSTALLPREFIX -DCMAKE_BUILD_TYPE:STRING=Release -DLIBDIR:PATH=$(pwd)/dummylib -DWITH_RAYOPTIMIZATION:BOOL=OFF -DWITH_PYTHON_INSTALL:BOOL=OFF -DWITH_DRACO:BOOL=OFF -DWITH_PYTHON_INSTALL_NUMPY:BOOL=OFF -DWITH_PYTHON_MODULE:BOOL=OFF -DWITH_PYTHON_NUMPY:BOOL=OFF -DPYTHON_INCLUDE_DIR:PATH=$PYDIR/include -S. -Bbuild_win &&
 wl-showstatus build-install &&
 make -Cbuild_win install/strip &&
    echo OK
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION



