export NAME="gnome-panel (includes libpanelapplet)"
export STATUS=
export URL=http://www.gnome.org/projects/gnome-panel
export BASENAME=gnome-panel
export DESCRIPTION=""
export CATEGORY=
export TYPE=library
#export VERSION=2.32.1
#export VERSIONDATE=20101017
####No package 'gnome-desktop-2.0' found
####No package 'libcanberra-gtk' found
#export VERSION=3.0.0
#export VERSIONDATE=20110405
#export VERSION=3.0.0.1
#export VERSIONDATE=20110406
#export VERSION=3.0.2
#export VERSIONDATE=20110524
####No package 'gnome-desktop-3.0' found
####No package 'dconf' found
#export VERSION=3.1.5
#export VERSIONDATE=20110813
#export VERSION=3.2.0
#export VERSIONDATE=20110926
#export VERSION=3.2.1
#export VERSIONDATE=20111016
#export VERSION=3.3.1
#export VERSIONDATE=20111024
#export VERSION=3.3.3
#export VERSIONDATE=20120117
#export VERSION=3.3.5
#export VERSIONDATE=20120206
#export VERSION=3.4.0
#export VERSIONDATE=20120326
#export VERSION=3.4.1
#export VERSIONDATE=20120416
#export VERSION=3.4.2
#export VERSIONDATE=20120514
#export VERSION=3.4.2.1
#export VERSIONDATE=20120515
#export DEPENDANCIES=gtk3,gdk-pixbuf,pango,glib2,gnome-desktop,gconf,gnome-menus,dbus-glib,libcanberra
#export VERSION=3.5.3
#export VERSIONDATE=20120627
####No package 'libgnome-menu-3.0' found
#export VERSION=3.5.4
#export VERSIONDATE=20120719
#export VERSION=3.5.91
#export VERSIONDATE=2012094
#export VERSION=3.5.92
#export VERSIONDATE=20120917
####Requested 'dconf >= 0.13.4' but version of dconf is 0.12.1
#export VERSION=3.6.0
#export VERSIONDATE=20120927
#export VERSION=3.6.2
#export VERSIONDATE=20121113
####Package 'gio-unix-2.0', required by 'libgnome-menu-3.0', not found
#export VERSION=3.8.0
#export VERSIONDATE=20130926
#export VERSION=3.8.1
#export VERSIONDATE=20140823
#export VERSION=3.14.0
#export VERSIONDATE=20141029
#export VERSION=3.15.2
#export VERSIONDATE=20141124
#export DEPENDANCIES=gtk3,gdk-pixbuf,pango,glib2,gnome-desktop,gconf,gnome-menus,dbus-glib,libcanberra,dconf
#export VERSION=3.16.0
#export VERSIONDATE=20150325
export VERSION=3.16.1
export VERSIONDATE=20150414
#export VERSION=3.17.1
#export VERSIONDATE=20150429
#export VERSION=3.17.2
#export VERSIONDATE=20150606
####gnome-panel/libpanel-applet-private/panel-applet-container.c:365:3: error: implicit declaration of function 'GTK_SOCKET' [-Werror=implicit-function-declaration]
#export VERSION=3.18.0
#export VERSIONDATE=20150926
#export VERSION=3.18.1
#export VERSIONDATE=20151013
#export VERSION=3.18.2
#export VERSIONDATE=20160217
#export VERSION=3.18.3
#export VERSIONDATE=20160813
####gnome-panel/libpanel-applet-private/panel-applet-container.c:99:3: error: implicit declaration of function 'gtk_socket_new' [-Werror=implicit-function-declaration]
#export VERSION=3.20.0
#export VERSIONDATE=20160417
####Requested 'gtk+-3.0 >= 3.19.6' but version of GTK+ is 3.16.7
#export VERSION=3.20.1
#export VERSIONDATE=20160813
#export VERSION=3.22.0
#export VERSIONDATE=20161009
#export VERSION=3.24.0
#export VERSIONDATE=20170322
#export VERSION=3.24.1
#export VERSIONDATE=20170329
#export VERSION=3.26.0
#export VERSIONDATE=20171009
#export VERSION=3.28.0
#export VERSIONDATE=20180326
#export VERSION=3.30.0
#export VERSIONDATE=20180910
#export VERSION=3.32.0
#export VERSIONDATE=20190505
#export VERSION=3.33.1
#export VERSIONDATE=20190812
#export VERSION=3.34.0
#export VERSIONDATE=20190911
#export VERSION=3.34.1
#export VERSIONDATE=20191008
#export VERSION=3.35.1
#export VERSIONDATE=20191220
#export VERSION=3.35.2
#export VERSIONDATE=20200104
#export VERSION=3.36.0
#export VERSIONDATE=20200309
#export VERSION=3.36.1
#export VERSIONDATE=20200320
#export VERSION=3.36.2
#export VERSIONDATE=20200712
#export VERSION=3.37.1
#export VERSIONDATE=20200503
#export VERSION=3.38.0
#export VERSIONDATE=20201015
#export VERSION=3.40.0
#export VERSIONDATE=20210326
#export VERSION=3.41.1
#export VERSIONDATE=20210506
#export VERSION=3.41.2
#export VERSIONDATE=20210526
#export VERSION=3.42.0
#export VERSIONDATE=20211024
#export VERSION=3.43.1
#export VERSIONDATE=20220313
#export VERSION=3.44.0
#export VERSIONDATE=20220319
####No package 'gdm' found
wl-showstatus --package-version
#export DEPENDANCIES=gdm,gtk3,gdk-pixbuf,pango,glib2,gnome-desktop,gconf,gnome-menus,dbus-glib,libcanberra,dconf,libwnck,libgweather,xproto
export DEPENDANCIES=gdm,gtk3,gdk-pixbuf,pango,glib2,gnome-desktop,gconf,gnome-menus,dbus-glib,libcanberra,dconf,libwnck,libgweather,xorgproto
export OPTIONALDEPENDANCIES=
export BUILDDEPENDANCIES=
export LICENSEFILE=COPYING
export LICENSETYPE=GPL
export DOWNLOADURL="http://ftp.gnome.org/pub/GNOME/sources/gnome-panel/"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
#export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/$BASENAME/`echo $VERSION|sed 's/^\([0-9]*\.[0-9]*\)\..*$/\1/'`/$BASENAME-$VERSION.tar.bz2
export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/$BASENAME/`echo $VERSION|sed 's/^\([0-9]*\.[0-9]*\)\..*$/\1/'`/$BASENAME-$VERSION.tar.xz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
#tar xfj $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.bz2
tar xfJ $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.xz
cd $BASENAME-$VERSION
mkdir -p winfix/sys winfix/gdk
touch winfix/sys/wait.h
touch winfix/gdk/gdkx.h
diff -ulbf gnome-panel/main.c << EOF
--- gnome-panel/main.c  2016-02-17 21:13:20.840290400 +0100
+++ gnome-panel/main.c  2016-02-17 21:15:43.599094600 +0100
@@ -14,3 +14,8 @@
 #include <glib/gi18n.h>
+#ifdef _WIN32
+#include <glib.h>
+#include <stdlib.h>
+#else
 #include <glib-unix.h>
+#endif

@@ -118,4 +123,6 @@

+#ifndef _WIN32
        g_unix_signal_add (SIGTERM, on_term_signal, NULL);
        g_unix_signal_add (SIGINT, on_int_signal, NULL);
+#endif

EOF
# fix missing XK_Super_L/XK_Super_R/XK_Hyper_L/XK_Hyper_R/XK_Meta_L/XK_Meta_R in libpanel-applet/panel-applet-bindings.c
mv libpanel-applet/panel-applet-bindings.c libpanel-applet/panel-applet-bindings.c.bak
echo "#include <X11/keysymdef.h>" > libpanel-applet/panel-applet-bindings.c
cat libpanel-applet/panel-applet-bindings.c.bak >> libpanel-applet/panel-applet-bindings.c
# fix missing XK_Super_L/XK_Super_R/XK_Hyper_L/XK_Hyper_R/XK_Meta_L/XK_Meta_R in gnome-panel/panel-xutils.c
mv gnome-panel/panel-xutils.c gnome-panel/panel-xutils.c.bak
echo "#include <X11/keysymdef.h>" > gnome-panel/panel-xutils.c
cat gnome-panel/panel-xutils.c.bak >> gnome-panel/panel-xutils.c
# fix problem detecting GNU gettext tools on 64-bit
if ( echo $RUNPLATFORM | grep -q x86_64 ); then
 mv configure configure.bak
 sed -e "s/as_fn_error\(.*GNU gettext tools not found; required for intltool\)/as_echo\1/" configure.bak > configure
fi
# remove gio-unix dependancy
mv configure configure.bak
sed -e "s/gio-unix/gio-windows/g" configure.bak > configure
#PATH=$PATH:$PERLDIR/../c/bin INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM LDFLAGS="-no-undefined -Wl,-no-undefined" &&
PATH=$PATH:$PERLDIR/../c/bin INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM CFLAGS="-I$(pwd)/winfix" LDFLAGS="-Wl,-no-undefined" &&
 wl-showstatus build-install &&
 make install-strip &&
    echo OK
# --with-x=no
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && rm -rf $BASENAME-$VERSION



