export NAME="xmake"
export STATUS=
export URL=https://xmake.io/
#export URL=https://github.com/xmake-io/xmake/
export BASENAME=xmake
export DESCRIPTION="A cross-platform build utility based on Lua"
export CATEGORY=development
export TYPE=application
#export VERSION=2.2.7
#export VERSIONDATE=20190704
#export VERSION=2.2.8
#export VERSIONDATE=20190826
#export VERSION=2.2.9
#export VERSIONDATE=20191221
#export VERSION=2.3.1
#export VERSIONDATE=20200223
#export VERSION=2.3.2
#export VERSIONDATE=20200328
#export VERSION=2.3.3
#export VERSIONDATE=20200426
#export VERSION=2.3.4
#export VERSIONDATE=20200607
#export VERSION=2.3.5
#export VERSIONDATE=20200628
#export VERSION=2.3.6
#export VERSIONDATE=20200729
#export VERSION=2.3.7
#export VERSIONDATE=20200915
#export VERSION=2.3.8
#export VERSIONDATE=20201018
#export VERSION=2.3.9
#export VERSIONDATE=20201125
#export VERSION=2.5.1
#export VERSIONDATE=20210121
#export VERSION=2.5.2
#export VERSIONDATE=20210228
#export VERSION=2.5.3
#export VERSIONDATE=20210408
#export VERSION=2.5.4
#export VERSIONDATE=20210515
#export VERSION=2.5.5
#export VERSIONDATE=20210701
#export VERSION=2.5.6
#export VERSIONDATE=20210726
#export VERSION=2.5.7
#export VERSIONDATE=20210829
#export VERSION=2.5.8
#export VERSIONDATE=20211009
#export VERSION=2.5.9
#export VERSIONDATE=20211031
#export VERSION=2.6.1
#export VERSIONDATE=20211203
#export VERSION=2.6.2
#export VERSIONDATE=20211217
#export VERSION=2.6.3
#export VERSIONDATE=20220122
#export VERSION=2.6.4
#export VERSIONDATE=20220307
#export VERSION=2.6.5
#export VERSIONDATE=20220425
#export VERSION=2.6.6
#export VERSIONDATE=20220525
#export VERSION=2.6.7
#export VERSIONDATE=20220529
#export VERSION=2.6.8
#export VERSIONDATE=20220623
export VERSION=2.6.9
export VERSIONDATE=20220717
wl-showstatus --package-version
export DEPENDANCIES=lua,luajit,lua-cjson,tbox,libsv,pdcurses
export OPTIONALDEPENDANCIES=
export BUILDDEPENDANCIES=
export LICENSEFILE=LICENSE.md
export LICENSETYPE=Apache
export DOWNLOADURL="https://github.com/xmake-io/xmake/releases"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=https://github.com/xmake-io/xmake/archive/v$VERSION.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
tar xfz $TARBALLDIR/$BASENAME/v$VERSION.tar.gz
cd $BASENAME-$VERSION
mv core/src/sv/makefile core/src/sv/makefile.bak &&
cat > core/src/sv/makefile << EOF
clean:
all:
EOF
mv core/src/luajit/makefile core/src/luajit/makefile.bak &&
cat > core/src/luajit/makefile << EOF
clean:
all:
EOF
#mv core/src/tbox/makefile core/src/tbox/makefile.bak &&
#cat > core/src/tbox/makefile << EOF
#clean:
#all:
#EOF
# use existing lua-cjson
cp -f $MINGWPREFIX/lib/lua/$(lua -v|sed -ne "s/^.*Lua \([0-9]\+\.[0-9]\+\).*$/\1/p")/cjson.dll core/src/lua-cjson/
cat > core/src/lua-cjson/makefile << EOF
build:
clean:
install:
test:
EOF
wl-showstatus build &&
 make -j1 build CFLAG="-I$MINGWPREFIX/include/luajit-2.0" &&
 wl-showstatus install &&
 make -j1 install prefix=$INSTALLPREFIX &&
    echo OK
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION



