export NAME="PHP"
export STATUS=
export URL=http://php.net/
export BASENAME=php
export DESCRIPTION="PHP is a popular general-purpose scripting language that is especially suited to web development."
export CATEGORY=development
export TYPE=application
#export VERSION=7.1.29
#export VERSIONDATE=20190503
#export VERSION=7.1.30
#export VERSIONDATE=20190531
#export VERSION=7.1.31
#export VERSIONDATE=20190802
#export VERSION=7.1.33
#export VERSIONDATE=20191025
#export VERSION=7.2.18
#export VERSIONDATE=20190502
#export VERSION=7.2.19
#export VERSIONDATE=20190531
#export VERSION=7.2.20
#export VERSIONDATE=20190704
#export VERSION=7.2.21
#export VERSIONDATE=20190801
#export VERSION=7.2.24
#export VERSIONDATE=20191024
#export VERSION=7.2.26
#export VERSIONDATE=20191218
#export VERSION=7.2.27
#export VERSIONDATE=20200124
#export VERSION=7.2.28
#export VERSIONDATE=20200220
#export VERSION=7.2.29
#export VERSIONDATE=20200319
#export VERSION=7.2.30
#export VERSIONDATE=20200418
#export VERSION=7.2.31
#export VERSIONDATE=20200514
#export VERSION=7.2.32
#export VERSIONDATE=20200709
#export VERSION=7.2.33
#export VERSIONDATE=20200806
#export VERSION=7.2.34
#export VERSIONDATE=20201001
#export VERSION=7.3.2
#export VERSIONDATE=20190306
#export VERSION=7.3.3
#export VERSIONDATE=20190307
#export VERSION=7.3.4
#export VERSIONDATE=20190404
#export VERSION=7.3.5
#export VERSIONDATE=20190502
#export VERSION=7.3.6
#export VERSIONDATE=20190530
#export VERSION=7.3.7
#export VERSIONDATE=20190704
#export VERSION=7.3.8
#export VERSIONDATE=20190801
#export VERSION=7.3.9
#export VERSIONDATE=20190829
#export VERSION=7.3.10
#export VERSIONDATE=20190927
#export VERSION=7.3.11
#export VERSIONDATE=20191024
#export VERSION=7.3.12
#export VERSIONDATE=20191121
#export VERSION=7.3.13
#export VERSIONDATE=20191218
#export VERSION=7.3.14
#export VERSIONDATE=20200124
#export VERSION=7.3.16
#export VERSIONDATE=20200319
#export VERSION=7.3.17
#export VERSIONDATE=20200416
#export VERSION=7.3.18
#export VERSIONDATE=20200514
#export VERSION=7.3.19
#export VERSIONDATE=20200611
#export VERSION=7.3.20
#export VERSIONDATE=20200709
#export VERSION=7.3.22
#export VERSIONDATE=20200903
#export VERSION=7.3.23
#export VERSIONDATE=20201001
#export VERSION=7.3.24
#export VERSIONDATE=20201029
#export VERSION=7.3.25
#export VERSIONDATE=20201126
#export VERSION=7.3.26
#export VERSIONDATE=20210107
#export VERSION=7.3.27
#export VERSIONDATE=20210204
#export VERSION=7.3.28
#export VERSIONDATE=20210429
#export VERSION=7.3.29
#export VERSIONDATE=20210701
#export VERSION=7.3.30
#export VERSIONDATE=20210826
#export VERSION=7.3.31
#export VERSIONDATE=20210923
#export VERSION=7.3.32
#export VERSIONDATE=20211028
#export VERSION=7.3.33
#export VERSIONDATE=20211118
#export VERSION=7.4.0
#export VERSIONDATE=20191128
#export VERSION=7.4.1
#export VERSIONDATE=20191218
#export VERSION=7.4.2
#export VERSIONDATE=20200123
#export VERSION=7.4.3
#export VERSIONDATE=20200220
#export VERSION=7.4.4
#export VERSIONDATE=20200319
#export VERSION=7.4.5
#export VERSIONDATE=20200416
#export VERSION=7.4.6
#export VERSIONDATE=20200514
#export VERSION=7.4.7
#export VERSIONDATE=20200612
#export VERSION=7.4.8
#export VERSIONDATE=20200709
#export VERSION=7.4.9
#export VERSIONDATE=20200806
#export VERSION=7.4.10
#export VERSIONDATE=20200904
#export VERSION=7.4.11
#export VERSIONDATE=20201001
#export VERSION=7.4.12
#export VERSIONDATE=20201030
#export VERSION=7.4.13
#export VERSIONDATE=20201126
#export VERSION=7.4.14
#export VERSIONDATE=20210107
#export VERSION=7.4.15
#export VERSIONDATE=20210204
#export VERSION=7.4.16
#export VERSIONDATE=20210305
#export VERSION=7.4.19
#export VERSIONDATE=20210506
#export VERSION=7.4.20
#export VERSIONDATE=20210603
#export VERSION=7.4.21
#export VERSIONDATE=20210702
#export VERSION=7.4.22
#export VERSIONDATE=20210730
#export VERSION=7.4.23
#export VERSIONDATE=20210827
#export VERSION=7.4.24
#export VERSIONDATE=20210924
#export VERSION=7.4.26
#export VERSIONDATE=20211118
#export VERSION=7.4.27
#export VERSIONDATE=20211217
#export VERSION=7.4.28
#export VERSIONDATE=20220218
#export VERSION=7.4.29
#export VERSIONDATE=20220414
#export VERSION=7.4.30
#export VERSIONDATE=20220609
#export VERSION=7.4.32
#export VERSIONDATE=20220929
#export VERSION=7.4.33
#export VERSIONDATE=20221103
#export VERSION=8.0.0
#export VERSIONDATE=20201127
#export VERSION=8.0.1
#export VERSIONDATE=20210108
#export VERSION=8.0.2
#export VERSIONDATE=20210204
#export VERSION=8.0.3
#export VERSIONDATE=20210305
#export VERSION=8.0.5
#export VERSIONDATE=20210430
#export VERSION=8.0.7
#export VERSIONDATE=20210604
#export VERSION=8.0.8
#export VERSIONDATE=20210701
#export VERSION=8.0.9
#export VERSIONDATE=20210730
#export VERSION=8.0.10
#export VERSIONDATE=20210826
#export VERSION=8.0.11
#export VERSIONDATE=20210924
#export VERSION=8.0.12
#export VERSIONDATE=20211021
#export VERSION=8.0.13
#export VERSIONDATE=20211119
#export VERSION=8.0.14
#export VERSIONDATE=20211218
#export VERSION=8.0.15
#export VERSIONDATE=20220120
#export VERSION=8.0.16
#export VERSIONDATE=20220218
#export VERSION=8.0.17
#export VERSIONDATE=20220317
#export VERSION=8.0.18
#export VERSIONDATE=20220415
#export VERSION=8.0.19
#export VERSIONDATE=20220512
#export VERSION=8.0.20
#export VERSIONDATE=20220512
#export VERSION=8.0.21
#export VERSIONDATE=20220707
#export VERSION=8.0.22
#export VERSIONDATE=20220804
#export VERSION=8.0.23
#export VERSIONDATE=20220902
#export VERSION=8.0.24
#export VERSIONDATE=20220930
#export VERSION=8.0.25
#export VERSIONDATE=20221028
#export VERSION=8.0.26
#export VERSIONDATE=20221127
#export VERSION=8.0.27
#export VERSIONDATE=20230106
#export VERSION=8.0.28
#export VERSIONDATE=20230214
#export VERSION=8.0.29
#export VERSIONDATE=20230608
#export VERSION=8.0.30
#export VERSIONDATE=20230805
#export VERSION=8.1.0
#export VERSIONDATE=20211126
#export VERSION=8.1.1
#export VERSIONDATE=20211218
#export VERSION=8.1.2
#export VERSIONDATE=20220121
#export VERSION=8.1.3
#export VERSIONDATE=20220218
#export VERSION=8.1.4
#export VERSIONDATE=20220318
#export VERSION=8.1.5
#export VERSIONDATE=20220415
#export VERSION=8.1.6
#export VERSIONDATE=20220513
#export VERSION=8.1.7
#export VERSIONDATE=20220610
#export VERSION=8.1.8
#export VERSIONDATE=20220708
#export VERSION=8.1.9
#export VERSIONDATE=20220804
#export VERSION=8.1.10
#export VERSIONDATE=20220901
#export VERSION=8.1.11
#export VERSIONDATE=20220930
#export VERSION=8.1.12
#export VERSIONDATE=20221029
#export VERSION=8.1.13
#export VERSIONDATE=20221125
#export VERSION=8.1.14
#export VERSIONDATE=20230106
#export VERSION=8.1.16
#export VERSIONDATE=20230215
#export VERSION=8.1.17
#export VERSIONDATE=20230316
#export VERSION=8.1.18
#export VERSIONDATE=20230414
#export VERSION=8.1.19
#export VERSIONDATE=20230512
#export VERSION=8.1.20
#export VERSIONDATE=20230609
#export VERSION=8.1.21
#export VERSIONDATE=20230707
#export VERSION=8.1.22
#export VERSIONDATE=20230804
#export VERSION=8.1.23
#export VERSIONDATE=20230901
#export VERSION=8.1.24
#export VERSIONDATE=20230929
#export VERSION=8.1.25
#export VERSIONDATE=20231028
#export VERSION=8.1.26
#export VERSIONDATE=20231124
#export VERSION=8.1.27
#export VERSIONDATE=20231222
#export VERSION=8.1.28
#export VERSIONDATE=20240413
#export VERSION=8.2.0
#export VERSIONDATE=20221208
#export VERSION=8.2.1
#export VERSIONDATE=20230106
#export VERSION=8.2.2
#export VERSIONDATE=20230203
#export VERSION=8.2.3
#export VERSIONDATE=20230215
#export VERSION=8.2.4
#export VERSIONDATE=20230316
#export VERSION=8.2.5
#export VERSIONDATE=20230414
#export VERSION=8.2.6
#export VERSIONDATE=20230511
#export VERSION=8.2.7
#export VERSIONDATE=20230609
#export VERSION=8.2.8
#export VERSIONDATE=20230706
#export VERSION=8.2.9
#export VERSIONDATE=20230817
#export VERSION=8.2.10
#export VERSIONDATE=20230901
#export VERSION=8.2.11
#export VERSIONDATE=20230929
#export VERSION=8.2.12
#export VERSIONDATE=20231027
#export VERSION=8.2.13
#export VERSIONDATE=20231123
#export VERSION=8.2.14
#export VERSIONDATE=20231222
#export VERSION=8.2.15
#export VERSIONDATE=20240119
#export VERSION=8.2.16
#export VERSIONDATE=20240216
#export VERSION=8.2.17
#export VERSIONDATE=20240315
#export VERSION=8.2.18
#export VERSIONDATE=20240412
#export VERSION=8.2.19
#export VERSIONDATE=20240510
#export VERSION=8.3.0
#export VERSIONDATE=20231124
#export VERSION=8.3.1
#export VERSIONDATE=20231222
#export VERSION=8.3.2
#export VERSIONDATE=20240119
#export VERSION=8.3.3
#export VERSIONDATE=20240216
#export VERSION=8.3.4
#export VERSIONDATE=20240315
#export VERSION=8.3.6
#export VERSIONDATE=20240412
#export VERSION=8.3.7
#export VERSIONDATE=20240510
export VERSION=8.3.8
export VERSIONDATE=20240607
####Zend/zend_ini.h:127:118: error: initializer element is not constant
wl-showstatus --package-version
export DEPENDENCIES=pcre,libgd,libcrypt,netsnmp
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=LICENSE
export LICENSETYPE=
export DOWNLOADURL="http://php.net/downloads.php"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
#export DOWNLOADSOURCEURL=http://php.net/get/php-$VERSION.tar.bz2/from/this/mirror?php-$VERSION.tar.bz2
export DOWNLOADSOURCEURL=https://www.php.net/distributions/php-$VERSION.tar.bz2
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
#tar xj --force-local -f $TARBALLDIR/$BASENAME/mirror*php-$VERSION.tar.bz2
tar xj --force-local -f $TARBALLDIR/$BASENAME/php-$VERSION.tar.bz2
cd $BASENAME-$VERSION
# avoid detection of BZ2_bzerror in configure
sed -i.bak -e "s?return BZ2_bzerror ();?//&?" configure
# fix win32/php_stdint.h (version >= 7.4.12)
patch -ulbf win32/php_stdint.h << EOF
@@ -37,3 +37,3 @@
 // need many of these typedefs and defines for older VS suites
-#if _MSC_VER < 1900
+#if (_MSC_VER < 1900) && !defined(__MINGW32__)

EOF
# fix error: multiple storage classes in declaration specifiers (version >= 8.0.1)
sed -i.bak -e "s/^\(__forceinline \)static /\1/" win32/ioutil.h win32/codepage.h win32/codepage.c
# fix win32/time.h (version >= 8.0.1)
patch -ulbf win32/time.h << EOF
@@ -19,6 +19,2 @@
 /* Struct stuff ************************************************************* */
-struct timezone {
-       int tz_minuteswest;
-       int tz_dsttime;
-};

@@ -30,9 +26,2 @@

-#if !defined(timespec) && _MSC_VER < 1900
-struct timespec
-{
-       time_t   tv_sec;   /* seconds */
-       long     tv_nsec;  /* nanoseconds */
-};
-#endif

@@ -46,2 +35,3 @@
 /* Prototype stuff ********************************************************** */
+#define gettimeofday PHP_gettimeofday
 PHPAPI extern int gettimeofday(struct timeval *time_Info, struct timezone *timezone_Info);
@@ -52,2 +42,3 @@

+#define nanosleep PHP_nanosleep
 PHPAPI int nanosleep( const struct timespec * rqtp, struct timespec * rmtp );
EOF
# fix main/php.h (version >= 8.0.10)
patch -ulbf main/php.h << EOF
@@ -92,2 +92,4 @@

+#undef uid_t
+#undef gid_t
 typedef int uid_t;
@@ -95,3 +97,5 @@
 typedef char * caddr_t;
+#ifndef __MINGW32__
 typedef int pid_t;
+#endif

EOF
wl-showstatus configure &&
 # mkdir -p m4 &&
 # autoreconf -f -i -I m4 -I $MINGWPREFIX/share/aclocal &&
 #./autogen.sh &&
 #    echo OK
 ## fix building DLLs on 64-bit
 #if ( echo $RUNPLATFORM | grep -q x86_64 ); then
 # echo "AM_GNU_GETTEXT_VERSION([$(gettext --version|head -n1|sed -e "s/^.* \([0-9\.]*\) *$/\1/")])" >> configure.ac &&
 # autoreconf -f -i -I m4 -I $MINGWPREFIX/share/aclocal
 #fi
 #INTLTOOL_PERL="$PERLDIR/bin/perl.exe" 
 #PERL="$PERLDIR/bin/perl.exe -I$PERLDIR/lib" 
 #PYTHON=$PYDIR/python.exe 
 #PYTHON=$PYDIR/python.exe C_INCLUDE_PATH=$PYDIR/include${C_INCLUDE_PATH:+:$C_INCLUDE_PATH} 
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM LDFLAGS="-Wl,--as-needed -Wl,-no-undefined" &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM LDFLAGS="-Wl,--as-needed" &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --disable-opcache --with-libxml-dir=$MINGWPREFIX --with-openssl=$MINGWPREFIX --with-pcre-regex=$MINGWPREFIX --with-sqlite3=$MINGWPREFIX --with-zlib=$MINGWPREFIX --with-bz2=$MINGWPREFIX --with-curl=$MINGWPREFIX --with-gdbm=$MINGWPREFIX --with-webp-dir=$MINGWPREFIX --with-jpeg-dir=$MINGWPREFIX --with-png-dir=$MINGWPREFIX --with-zlib-dir=$MINGWPREFIX --with-xpm-dir=$MINGWPREFIX --with-freetype-dir=$MINGWPREFIX --with-mhash=$MINGWPREFIX --with-ldap=$MINGWPREFIX --with-pgsql=$MINGWPREFIX --with-snmp=$MINGWPREFIX --with-pcre-dir=$MINGWPREFIX CFLAGS="-DPHP_WIN32" &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --disable-opcache --with-libxml-dir=$MINGWPREFIX --with-iconv=$MINGWPREFIX --with-openssl=$MINGWPREFIX --with-pcre-regex=$MINGWPREFIX --with-sqlite3=$MINGWPREFIX --with-zlib=$MINGWPREFIX --with-bz2=$MINGWPREFIX --with-curl=$MINGWPREFIX --with-gdbm=$MINGWPREFIX --with-webp-dir=$MINGWPREFIX --with-jpeg-dir=$MINGWPREFIX --with-png-dir=$MINGWPREFIX --with-zlib-dir=$MINGWPREFIX --with-xpm-dir=$MINGWPREFIX --with-freetype-dir=$MINGWPREFIX --with-mhash=$MINGWPREFIX --with-ldap=$MINGWPREFIX --with-pgsql=$MINGWPREFIX --with-snmp=$MINGWPREFIX --with-pcre-dir=$MINGWPREFIX CFLAGS="-DPHP_WIN32" &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-zts --disable-opcache --with-libxml-dir=$MINGWPREFIX --with-iconv=$MINGWPREFIX --with-openssl=$MINGWPREFIX --with-pcre-regex=$MINGWPREFIX --with-sqlite3=$MINGWPREFIX --with-zlib=$MINGWPREFIX --with-bz2=$MINGWPREFIX --with-curl=$MINGWPREFIX --with-gdbm=$MINGWPREFIX --with-webp-dir=$MINGWPREFIX --with-jpeg-dir=$MINGWPREFIX --with-png-dir=$MINGWPREFIX --with-zlib-dir=$MINGWPREFIX --with-xpm-dir=$MINGWPREFIX --with-freetype-dir=$MINGWPREFIX --with-mhash=$MINGWPREFIX --with-ldap=$MINGWPREFIX --with-pgsql=$MINGWPREFIX --with-snmp=$MINGWPREFIX --with-pcre-dir=$MINGWPREFIX CFLAGS="-DPHP_WIN32" &&
 ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-zts --disable-opcache --with-libxml-dir=$MINGWPREFIX --with-iconv=$MINGWPREFIX --with-openssl=$MINGWPREFIX --with-pcre-regex=$MINGWPREFIX --with-sqlite3=$MINGWPREFIX --with-zlib=$MINGWPREFIX --with-bz2=$MINGWPREFIX --with-curl=$MINGWPREFIX --with-gdbm=$MINGWPREFIX --with-webp-dir=$MINGWPREFIX --with-jpeg-dir=$MINGWPREFIX --with-png-dir=$MINGWPREFIX --with-zlib-dir=$MINGWPREFIX --with-xpm-dir=$MINGWPREFIX --with-freetype-dir=$MINGWPREFIX --with-mhash=$MINGWPREFIX --with-ldap=$MINGWPREFIX --with-pgsql=$MINGWPREFIX --with-snmp=$MINGWPREFIX --with-pcre-dir=$MINGWPREFIX --with-external-pcre --with-external-gd --with-external-libcrypt CFLAGS="-DPHP_WIN32" &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-embed=static --disable-fpm --disable-posix --disable-inline-optimization --enable-fd-setsize=256 --enable-maintainer-zts --disable-shared --with-readline --with-openssl --with-zlib --with-bz2 --enable-zip --with-libxml-dir --with-libexpat-dir --with-xsl --enable-wddx --enable-soap --with-xmlrpc --with-gd --with-jpeg-dir --with-png-dir --with-vpx-dir --enable-gd-native-ttf --enable-gd-jis-conv --with-freetype-dir --with-t1lib --enable-exif --enable-calendar --with-curl --with-curlwrappers --enable-ftp --with-libmbfl --with-onig --enable-mbstring --enable-sockets --enable-shmop --enable-bcmath --with-gmp --enable-intl --with-icu-dir --with-pspell --with-iconv-dir --with-gettext --with-mhash --with-mcrypt --with-tidy --with-ldap --with-imap --with-snmp --enable-mysqlnd --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --with-pgsql --with-pdo-pgsql --with-pdo-odbc=generic,/usr/local,odbc32 --with-pdo-dblib --with-db4 --enable-dba --with-custom-odbc CUSTOM_ODBC_LIBS=-lodbc32
 ## fix building DLLs
 #mv libtool libtool.bak &&
 #sed -e "s/\(allow_undefined=\)yes/\1no/" libtool.bak > libtool &&
 # fix missing win32/build/config.w32.h
 #cp -u win32/build/config.w32.h.in main/config.w32.h &&
 cp -u main/php_config.h main/config.w32.h &&
 #wl-showstatus build &&
 #make &&
 wl-showstatus build-install &&
 make install &&
    echo OK
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION



