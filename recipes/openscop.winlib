export NAME="OpenScop library (osl)"
export STATUS=
export URL=https://icps.u-strasbg.fr/people/bastoul/public_html/development/openscop/
export BASENAME=openscop
export DESCRIPTION="OpenScop is an open specification defining a file format and a set of data structures to represent a static control part (SCoP for short), i.e., a program part that can be represented in the polyhedral model. The goal of OpenScop is to provide a common interface to various polyhedral compilation tools in order to simplify their interaction. The OpenScop aim is to provide a stable, unified format that offers a durable guarantee that a tool can use an output or provide an input to another tool without breaking a tool chain because of some internal changes in one element of the chain. The other promise of OpenScop is the ability to assemble or replace the basic blocks of a polyhedral compilation framework at no, or at least low engineering cost."
export CATEGORY=math
export TYPE=library
export VERSION=0.9.0
export VERSIONDATE=20251003
wl-showstatus --package-version
export DEPENDENCIES=gmp,sys_wait_h
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=COPYING
export LICENSETYPE=BSD
export DOWNLOADURL="https://icps.u-strasbg.fr/people/bastoul/public_html/development/openscop/#DL"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=https://icps.u-strasbg.fr/people/bastoul/public_html/development/openscop/docs/osl-$VERSION.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
tar xz --force-local -f $TARBALLDIR/$BASENAME/osl-$VERSION.tar.gz
cd osl-$VERSION
# fix already defined bool in source/extensions/irregular.c (version >= 0.9.0)
sed -i.bak -e "s/\bbool\b/bln/g" source/extensions/irregular.c
wl-showstatus configure &&
 ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --with-gmp=system --enable-portable-binary CFLAGS="-I$MINGWPREFIX/win32ports/include" &&
 # fix building DLLs
 sed -i.bak -e "s/\(allow_undefined=\)yes/\1no/" libtool &&
 wl-showstatus build-install &&
 make install-strip &&
 #( make install-strip || ( make install && strip $INSTALLPREFIX/bin/*.{dll,exe} )) &&
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf osl-$VERSION



