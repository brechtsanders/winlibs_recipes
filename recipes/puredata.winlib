export NAME="Pure Data"
export STATUS=
export URL=http://puredata.info/
export BASENAME=puredata
export DESCRIPTION="Pure Data (aka Pd) is an open source visual programming language. Pd enables musicians, visual artists, performers, researchers, and developers to create software graphically, without writing lines of code. Pd is used to process and generate sound, video, 2D/3D graphics, and interface sensors, input devices, and MIDI. Pd can easily work over local and remote networks to integrate wearable technology, motor systems, lighting rigs, and other equipment. Pd is suitable for learning basic multimedia processing and visual programming methods as well as for realizing complex systems for large-scale projects."
export CATEGORY=development
export TYPE=application
#export VERSION=0.43.4
#export VERSIONDATE=20150301
export VERSION=0.53.0
export VERSIONDATE=20221216
wl-showstatus --package-version
export DEPENDANCIES=libdl
#export DEPENDANCIES=libdl,fftw,asio
export OPTIONALDEPENDANCIES=
export BUILDDEPENDANCIES=
export LICENSEFILE=LICENSE.txt
export LICENSETYPE=BSD
#export DOWNLOADURL="http://sourceforge.net/projects/pure-data/files/pd-extended/ Pd-extended_ -source.tar.bz2"
export DOWNLOADURL="http://puredata.info/downloads/pure-data"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
#export DOWNLOADSOURCEURL=http://downloads.sourceforge.net/project/pure-data/pd-extended/$VERSION/Pd-extended_$VERSION-source.tar.bz2
export DOWNLOADSOURCEURL=https://msp.puredata.info/Software/pd-$(echo $VERSION|sed -e "s/^\([0-9]*\.[0-9]*\)\.\([0-9]*\)/\1-\2/").src.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
#mkdir -p $BASENAME-$VERSION
#tar xfj $TARBALLDIR/$BASENAME/Pd-extended_$VERSION-source.tar.bz2 -C$BASENAME-$VERSION
#cd $BASENAME-$VERSION/pd-extended/pd
tar xfz $TARBALLDIR/$BASENAME/pd-$(echo $VERSION|sed -e "s/^\([0-9]*\.[0-9]*\)\.\([0-9]*\)/\1-\2/").src.tar.gz
cd pd-$(echo $VERSION|sed -e "s/^\([0-9]*\.[0-9]*\)\.\([0-9]*\)/\1-\2/")
#make -Csrc -fmakefile.mingw
# fix missing folder
mkdir -p m4/generated
wl-showstatus preconfigure &&
 aclocal --force -I m4/generated -I m4 &&
 libtoolize --install --force &&
 autoconf --force &&
 automake --add-missing --copy --force-missing &&
 wl-showstatus configure &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM CFLAGS="-fcommon" &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM CFLAGS="-fcommon -I$MINGWPREFIX/include/libdl-win32" &&
 ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-libpd --enable-libpd-utils --enable-fftw --enable-asio --enable-portmidi CFLAGS="-fcommon -I$MINGWPREFIX/include/libdl-win32" &&
 wl-showstatus build-install &&
 make install-strip &&
 #wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd ../../.. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf pd-$(echo $VERSION|sed -e "s/^\([0-9]*\.[0-9]*\)\.\([0-9]*\)/\1-\2/")



