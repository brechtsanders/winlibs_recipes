#export NAME="Vim"
#export STATUS=
#export URL=http://www.vim.org/
#export BASENAME=vim
#export DESCRIPTION="Vim is an advanced text editor that seeks to provide the power of the de-facto Unix editor 'Vi', with a more complete feature set."
#export CATEGORY=office
#export TYPE=application
##export VERSION=7.3
##export VERSIONDATE=20110620
##export VERSION=7.4
##export VERSIONDATE=20130811
##export VERSION=8.0
##export VERSIONDATE=20160912
##export VERSION=8.0.069
##export VERSIONDATE=20161107
##export VERSION=8.0.586
##export VERSIONDATE=20170424
#####src/auto/osdef.h:85:12: error: expected declaration specifiers or '...' before '(' token
#####extern int setjmp(jmp_buf);
##export VERSION=8.1
##export VERSIONDATE=20180517
#export VERSION=8.2
#export VERSIONDATE=20191213
#####src/proto/if_xcmdsrv.pro:4:5: error: conflicting types for 'serverSendToVim'
#####src/proto/os_mswin.pro:46:5: note: previous declaration of 'serverSendToVim' was here
#####src/proto/if_xcmdsrv.pro:5:9: error: conflicting types for 'serverGetVimNames'
#####src/proto/os_mswin.pro:44:9: note: previous declaration of 'serverGetVimNames' was here
#wl-showstatus --package-version
#export DEPENDENCIES=
#export OPTIONALDEPENDENCIES=
#export BUILDDEPENDENCIES=
#export OPTIONALBUILDDEPENDENCIES=
#export LICENSEFILE=COPYING
#export LICENSETYPE="Charityware/GPL"
##export DOWNLOADURL="http://www.vim.org/sources.php"
#export DOWNLOADURL="http://ftp.vim.org/pub/vim/unix/"
##export DOWNLOADURL="https://github.com/vim/vim/tags"
#export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
#export DOWNLOADSOURCEURL=http://ftp.vim.org/pub/vim/unix/$BASENAME-$VERSION.tar.bz2
#wl-showstatus download
#wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
#wl-wait4deps
#tar xfj $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.bz2
#cd vim$(echo $VERSION|sed -e "s/^\([0-9]*\)\.\([0-9]*\).*$/\1\2/")
##mv src/os_unix.h src/os_unix.h.bak
###echo "#include \"os_win32.h\"" > src/os_unix.h
##touch src/os_unix.h
##mv src/os_win32.h src/os_win32.h.bak
##touch src/os_win32.h
## fix src/feature.h (version >= 8.2.5159)
#patch -ulbf src/feature.h << EOF
#@@ -866,4 +866,6 @@
# #if defined(FEAT_NORMAL) || defined(FEAT_GUI_MOTIF)
#+#ifndef _WIN32
# # define WANT_X11
# #endif
#+#endif
#
#EOF
## fix src/os_vms_conf.h (version >= 8.2.5159)
#patch -ulbf src/os_vms_conf.h << EOF
#@@ -203,4 +203,6 @@
# #define XUSE_MTSAFE_API
#+#ifndef _WIN32
# #define HAVE_X11
# #define WANT_X11
#+#endif
# #ifdef HAVE_XPM
#EOF
## fix src/vim.h (version >= 8.2.5159)
#patch -ulbf src/vim.h << EOF
#@@ -237,4 +237,6 @@
#        && (!defined(MACOS_X) || defined(HAVE_CONFIG_H))
#+#ifndef _WIN32
# # include "os_unix.h"      // bring lots of system header files
# #endif
#+#endif
#
#EOF
## fix src/misc1.c (version >= 8.2.5159)
#patch -ulbf src/misc1.c << EOF
#@@ -21,3 +21,5 @@
# #if defined(MSWIN)
#-# include <lm.h>
#+# include <levmar.h>
#+# include <lmaccess.h>
#+# include <lmerr.h>
# #endif
#EOF
#wl-showstatus configure &&
# #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM &&
# ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --without-x --disable-darwin --disable-smack --disable-selinux --disable-xsmp &&
# #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-gui=gtk3 --without-x --disable-darwin --disable-smack --disable-selinux --disable-xsmp &&
# #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-gui=gtk2 --with-features=big --with-tlib=ncurses --disable-gpm --without-x --x-includes=DUMMY --x-libraries=DUMMY --disable-darwin --disable-smack --disable-selinux --disable-xsmp --disable-xim --enable-luainterp=dynamic --enable-perlinterp=dynamic --enable-pythoninterp=dynamic --enable-python3interp=dynamic --enable-rubyinterp=dynamic --with-python3-command=$PYDIR/python.exe &&
# wl-showstatus build-install &&
# make -Csrc &&
# wl-showstatus build-install &&
# make -Csrc install &&
#    echo OK
## wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && rm -rf vim$(echo $VERSION|sed -e "s/^\([0-9]*\)\.\([0-9]*\).*$/\1\2/")



export NAME="Vim"
export STATUS=
export URL=http://www.vim.org/
export BASENAME=vim
export DESCRIPTION="Vim is an advanced text editor that seeks to provide the power of the de-facto Unix editor 'Vi', with a more complete feature set."
export CATEGORY=office
export TYPE=application
#export VERSION=8.2.5159
#export VERSIONDATE=20220625
#export VERSION=8.2.5160
#export VERSIONDATE=20220626
#export VERSION=8.2.5172
#export VERSIONDATE=20220628
#export VERSION=9.0.0000
#export VERSIONDATE=20220628
#export VERSION=9.0.0001
#export VERSIONDATE=20220629
#export VERSION=9.0.0009
#export VERSIONDATE=20220630
#export VERSION=9.0.0042
#export VERSIONDATE=20220706
#export VERSION=9.0.0055
#export VERSIONDATE=20220718
#export VERSION=9.0.0063
#export VERSIONDATE=20220724
#export VERSION=9.0.0117
#export VERSIONDATE=20220731
#export VERSION=9.0.0148
#export VERSIONDATE=20220806
#export VERSION=9.0.0167
#export VERSIONDATE=20220808
#export VERSION=9.0.0213
#export VERSIONDATE=20220815
#export VERSION=9.0.0292
#export VERSIONDATE=20220828
#export VERSION=9.0.0447
#export VERSIONDATE=20220912
#export VERSION=9.0.0771
#export VERSIONDATE=20221016
#export VERSION=9.0.0820
#export VERSIONDATE=20221030
#export VERSION=9.0.0852
#export VERSIONDATE=20221110
#export VERSION=9.0.0870
#export VERSIONDATE=20221113
#export VERSION=9.0.0920
#export VERSIONDATE=20221123
#export VERSION=9.0.0989
#export VERSIONDATE=20221203
export VERSION=9.0.1038
export VERSIONDATE=20221210
wl-showstatus --package-version
export DEPENDENCIES=
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=COPYING
export LICENSETYPE="Charityware/GPL"
#export DOWNLOADURL="http://www.vim.org/sources.php"
#export DOWNLOADURL="http://ftp.vim.org/pub/vim/unix/"
export DOWNLOADURL="https://github.com/vim/vim/tags"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=https://github.com/vim/vim/archive/refs/tags/v$VERSION.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
tar xfz $TARBALLDIR/$BASENAME/v$VERSION.tar.gz
cd $BASENAME-$VERSION
# fix src/misc1.c (version >= 8.2.5159)
patch -ulbf src/misc1.c << EOF
@@ -21,3 +21,6 @@
 #if defined(MSWIN)
-# include <lm.h>
+# include <levmar.h>
+# include <lmaccess.h>
+# include <lmerr.h>
+# include <lmapibuf.h>
 #endif
EOF
wl-showstatus build &&
 make -Csrc -fMake_ming.mak GUI=no &&
 make -Csrc -fMake_ming.mak &&
 #make -Csrc/po -fMake_ming.mak &&
 strip src/*.exe &&
 wl-showstatus install  &&
 mkdir -p $INSTALLPREFIX/bin &&
 cp -f src/*vim*.exe $INSTALLPREFIX/bin/ &&
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && rm -rf vim$(echo $VERSION|sed -e "s/^\([0-9]*\)\.\([0-9]*\).*$/\1\2/")
####TO DO: fix extra startup screen



