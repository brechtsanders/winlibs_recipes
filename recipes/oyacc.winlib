export NAME="oyacc"
export STATUS=
export URL=https://github.com/ibara/yacc
export BASENAME=oyacc
export DESCRIPTION="yacc, or oyacc, is a portable version of the OpenBSD Yacc program."
export CATEGORY=development
export TYPE=application
export VERSION=6.6
export VERSIONDATE=20250102
wl-showstatus --package-version
export DEPENDENCIES=
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=README.md
export LICENSETYPE=BSD
export DOWNLOADURL="https://github.com/ibara/yacc/releases oyacc-"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=https://github.com/ibara/yacc/releases/download/oyacc-$VERSION/oyacc-$VERSION.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
tar xz --force-local -f $TARBALLDIR/$BASENAME/oyacc-$VERSION.tar.gz
cd oyacc-$VERSION
# fix main.c (version >= 6.6)
patch -ulbf main.c << EOF
@@ -37,3 +37,5 @@
 #include <fcntl.h>
+#ifndef _WIN32
 #include <paths.h>
+#endif
 #include <signal.h>
@@ -42,2 +44,8 @@
 #include "defs.h"
+#ifdef _WIN32
+#ifndef __unused
+#define __unused
+char  *__progname;
+#endif
+#endif

EOF
wl-showstatus configure &&
 ./configure --prefix=$INSTALLPREFIX &&
 wl-showstatus build &&
 make &&
 strip *.exe &&
 wl-showstatus build-install &&
 make install DESTDIR=$INSTALLPREFIX BINDIR=/bin MANDIR=/man &&
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf oyacc-$VERSION



