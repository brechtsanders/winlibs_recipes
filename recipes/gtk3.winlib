#export NAME="GTK+ 3"
#export STATUS=
#export URL=http://www.gtk.org/
#export BASENAME=gtk3
#export DESCRIPTION="GTK+ is a highly usable, feature rich toolkit for creating graphical user interfaces which boasts cross platform compatibility and an easy to use API."
#export CATEGORY=gui
#export TYPE=library
##export VERSION=3.0.0
##export VERSIONDATE=20110212
##export VERSION=3.0.1
##export VERSIONDATE=20110222
##export VERSION=3.0.2
##export VERSIONDATE=20110307
##export VERSION=3.0.3
##export VERSIONDATE=20110315
##export VERSION=3.0.4
##export VERSIONDATE=20110322
##export VERSION=3.0.5
##export VERSIONDATE=20110324
##export VERSION=3.0.6
##export VERSIONDATE=20110326
##export VERSION=3.0.7
##export VERSIONDATE=20110402
##export VERSION=3.0.8
##export VERSIONDATE=20110404
##export VERSION=3.0.9
##export VERSIONDATE=20110416
##export VERSION=3.0.10
##export VERSIONDATE=20110523
##export VERSION=3.0.11
##export VERSIONDATE=20110607
##export VERSION=3.0.12
##export VERSIONDATE=20110728
##export VERSION=3.1.2
##export VERSIONDATE=20110414
##export VERSION=3.1.4
##export VERSIONDATE=20110508
##export VERSION=3.1.6
##export VERSIONDATE=20110613
##export VERSION=3.1.8
##export VERSIONDATE=20110713
##export VERSION=3.1.10
##export VERSIONDATE=20110723
##export VERSION=3.1.12
##export VERSIONDATE=20110816
#####Requested 'glib-2.0 >= 2.29.4' but version of GLib is 2.28.8
##export VERSION=3.1.14
##export VERSIONDATE=20110830
##export VERSION=3.1.16
##export VERSIONDATE=20110831
##export VERSION=3.1.18
##export VERSIONDATE=20110906
##export VERSION=3.2.0
##export VERSIONDATE=20110926
##export VERSION=3.2.1
##export VERSIONDATE=20111015
#####Requested 'glib-2.0 >= 2.29.14' but version of GLib is 2.28.8
#####Requested 'pango >= 1.29.0' but version of Pango is 1.28.4
##export VERSION=3.2.2
##export VERSIONDATE=20111112
##export VERSION=3.2.3
##export VERSIONDATE=20120116
##export VERSION=3.2.4
##export VERSIONDATE=20120312
#####Requested 'glib-2.0 >= 2.29.14' but version of GLib is 2.28.1
##export VERSION=3.3.2
##export VERSIONDATE=20111025
##export VERSION=3.3.4
##export VERSIONDATE=20111122
##export VERSION=3.3.8
##export VERSIONDATE=20120117
##export VERSION=3.3.10
##export VERSIONDATE=20120121
##export VERSION=3.3.12
##export VERSIONDATE=20120131
##export VERSION=3.3.14
##export VERSIONDATE=20120207
##export VERSION=3.3.16
##export VERSIONDATE=20120221
##export VERSION=3.3.18
##export VERSIONDATE=20120306
##export VERSION=3.3.20
##export VERSIONDATE=20120321
#####gdk/win32/gdkinput.c:68: error: expected declaration specifiers or '...' before 'GdkExtensionMode'
#####gdk/win32/gdkinput.c:68:33: error: unknown type name 'GdkExtensionMode'
##export VERSION=3.4.0
##export VERSIONDATE=20120326
##export VERSION=3.4.1
##export VERSIONDATE=20120414
##export VERSION=3.4.2
##export VERSIONDATE=20120503
#####gtk/gtkapplicationwindow.c:286:15: error: unknown type name 'GDesktopAppInfo'
##export VERSION=3.4.3
##export VERSIONDATE=20120512
##export VERSION=3.4.4
##export VERSIONDATE=20120716
#####gdk/fallback-c89.c:40: error: expected identifier or '(' before 'sizeof'
#####gdk/fallback-c89.c:40: error: expected ')' before '==' token
##export VERSION=3.5.2
##export VERSIONDATE=20120501
##export VERSION=3.5.4
##export VERSIONDATE=20120604
##export VERSION=3.5.6
##export VERSIONDATE=20120626
##export VERSION=3.5.8
##export VERSIONDATE=20120717
##export VERSION=3.5.10
##export VERSIONDATE=20120807
##export VERSION=3.5.12
##export VERSIONDATE=20120824
##export VERSION=3.5.14
##export VERSIONDATE=20120904
##export VERSION=3.5.16
##export VERSIONDATE=20120905
##export VERSION=3.5.18
##export VERSIONDATE=20120920
#####Requested 'glib-2.0 >= 2.33.1' but version of GLib is 2.32.3
##export VERSION=3.6.0
##export VERSIONDATE=20120925
##export VERSION=3.6.1
##export VERSIONDATE=20121016
##export VERSION=3.6.2
##export VERSIONDATE=20121111
#####gtk/gtk-launch.c:31:33: fatal error: gio/gdesktopappinfo.h: No such file or directory
#####gtk/gtk-launch.c:114: undefined reference to `g_desktop_app_info_new'
##export VERSION=3.6.3
##export VERSIONDATE=20130104
##export VERSION=3.6.4
##export VERSIONDATE=20130107
##export VERSION=3.6.5
##export VERSIONDATE=20140128
#####gdk/win32/gdkwindow-win32.c:1025:59: error: 'MONITOR_DEFAULTTONEAREST' undeclared (first use in this function)
##export VERSION=3.7.0
##export VERSIONDATE=20121023
##export VERSION=3.7.2
##export VERSIONDATE=20121020
##export VERSION=3.7.4
##export VERSIONDATE=20121218
##export VERSION=3.7.6
##export VERSIONDATE=20130115
##export VERSION=3.7.8
##export VERSIONDATE=20130205
##export VERSION=3.7.12
##export VERSIONDATE=20130306
##export VERSION=3.7.14
##export VERSIONDATE=20130319
##export VERSION=3.8.0
##export VERSIONDATE=20130326
##export VERSION=3.8.1
##export VERSIONDATE=20130416
##export VERSION=3.8.2
##export VERSIONDATE=20130513
##export VERSION=3.8.4
##export VERSIONDATE=20130830
##export VERSION=3.8.5
##export VERSIONDATE=20131011
##export VERSION=3.8.6
##export VERSIONDATE=20131017
##export VERSION=3.8.7
##export VERSIONDATE=20131121
##export VERSION=3.8.8
##export VERSIONDATE=20131127
##export VERSION=3.8.9
##export VERSIONDATE=20140128
##export VERSION=3.9.0
##export VERSIONDATE=20130502
##export VERSION=3.9.2
##export VERSIONDATE=20130528
##export VERSION=3.9.4
##export VERSIONDATE=20130617
##export VERSION=3.9.6
##export VERSIONDATE=20130622
##export VERSION=3.9.8
##export VERSIONDATE=20130710
##export VERSION=3.9.10
##export VERSIONDATE=20130730
##export VERSION=3.9.12
##export VERSIONDATE=20130821
##export VERSION=3.9.14
##export VERSIONDATE=20130903
##export VERSION=3.10.0
##export VERSIONDATE=20130924
##export VERSION=3.10.1
##export VERSIONDATE=20131011
##export VERSION=3.10.2
##export VERSIONDATE=20131016
##export VERSION=3.10.3
##export VERSIONDATE=20131112
##export VERSION=3.10.4
##export VERSIONDATE=20131116
##export VERSION=3.10.5
##export VERSIONDATE=20131127
##export VERSION=3.10.6
##export VERSIONDATE=20131205
##export VERSION=3.10.7
##export VERSIONDATE=20140128
##export VERSION=3.10.8
##export VERSIONDATE=20140406
##export VERSION=3.10.9
##export VERSIONDATE=20140513
##export VERSION=3.11.0
##export VERSIONDATE=20131028
##export VERSION=3.11.2
##export VERSIONDATE=20131119
##export VERSION=3.11.4
##export VERSIONDATE=20140115
##export VERSION=3.11.5
##export VERSIONDATE=20140205
##export VERSION=3.11.6
##export VERSIONDATE=20140218
##export VERSION=3.11.7
##export VERSIONDATE=20140219
##export VERSION=3.11.8
##export VERSIONDATE=20140304
#####make[4]: *** No rule to make target `gdk.def', needed by `libgdk-3.la'.  Stop.
#####See also: https://bug702860.bugzilla-attachments.gnome.org/attachment.cgi?id=247517
##export VERSION=3.11.9
##export VERSIONDATE=20140318
#####Requested 'glib-2.0 >= 2.39.5' but version of GLib is 2.38.2
##export VERSION=3.12.0
##export VERSIONDATE=20140325
##export VERSION=3.12.1
##export VERSIONDATE=20140413
##export VERSION=3.12.2
##export VERSIONDATE=20140513
##export VERSION=3.13.1
##export VERSIONDATE=20140429
##export VERSION=3.13.2
##export VERSIONDATE=20140528
##export VERSION=3.13.3
##export VERSIONDATE=20140625
##export VERSION=3.13.4
##export VERSIONDATE=20140715
##export VERSION=3.13.5
##export VERSIONDATE=20140722
##export VERSION=3.13.6
##export VERSIONDATE=20140811
##export VERSION=3.13.7
##export VERSIONDATE=20140817
##export VERSION=3.13.8
##export VERSIONDATE=20140902
#####gtk/gtkprintoperation-win32.c:1670:7: error: unknown type name 'INITCOMMONCONTROLSEX'
##export VERSION=3.13.9
##export VERSIONDATE=20140916
##export VERSION=3.14.0
##export VERSIONDATE=20140922
#####Requested 'pango >= 1.36.7' but version of Pango is 1.36.6
#####gtk/gtkprintoperation-win32.c:1670:7: error: unknown type name 'INITCOMMONCONTROLSEX'
##export VERSION=3.14.1
##export VERSIONDATE=20140930
##export VERSION=3.14.2
##export VERSIONDATE=20141008
##export VERSION=3.14.3
##export VERSIONDATE=20141014
##export VERSION=3.14.4
##export VERSIONDATE=20141022
##export VERSION=3.14.5
##export VERSIONDATE=20141110
##export VERSION=3.14.6
##export VERSIONDATE=20141213
##export VERSION=3.14.7
##export VERSIONDATE=20150111
##export VERSION=3.14.8
##export VERSIONDATE=20150201
##export VERSION=3.14.9
##export VERSIONDATE=20150226
##export VERSION=3.14.10
##export VERSIONDATE=20150323
##export VERSION=3.14.11
##export VERSIONDATE=20150330
##export VERSION=3.14.13
##export VERSIONDATE=20150428
##export VERSION=3.14.14
##export VERSIONDATE=20150708
##export VERSION=3.14.15
##export VERSIONDATE=20150722
##export DEPENDENCIES=glib2,atk,pango,cairo,gdk-pixbuf,gettext,libiconv,libpng,libjpeg,libtiff,freetype2,fontconfig,expat
##export VERSION=3.15.0
##export VERSIONDATE=20141022
#####Requested 'glib-2.0 >= 2.43.0' but version of GLib is 2.42.0
##export VERSION=3.15.1
##export VERSIONDATE=20141028
##export VERSION=3.15.2
##export VERSIONDATE=20141124
##export VERSION=3.15.3
##export VERSIONDATE=20141216
##export VERSION=3.15.4
##export VERSIONDATE=20150120
##export VERSION=3.15.6
##export VERSIONDATE=20150211
#####gtk/a11y/gtkwidgetaccessible.c:400:45: error: 'ATK_STATE_HAS_TOOLTIP' undeclared (first use in this function)
##export VERSION=3.15.7
##export VERSIONDATE=20150217
##export VERSION=3.15.8
##export VERSIONDATE=20150221
##export VERSION=3.15.9
##export VERSIONDATE=20150225
##export VERSION=3.15.10
##export VERSIONDATE=20150303
##export VERSION=3.15.11
##export VERSIONDATE=20150312
##export VERSION=3.15.12
##export VERSIONDATE=20150318
#####Requested 'glib-2.0 >= 2.43.4' but version of GLib is 2.43.2
##export VERSION=3.16.0
##export VERSIONDATE=20150323
##export VERSION=3.16.1
##export VERSIONDATE=20150411
##export VERSION=3.16.2
##export VERSIONDATE=20150414
##export VERSION=3.16.3
##export VERSIONDATE=20150512
##export VERSION=3.16.4
##export VERSIONDATE=20150611
##export VERSION=3.16.5
##export VERSIONDATE=20150708
##export VERSION=3.16.6
##export VERSIONDATE=20150722
##export VERSION=3.16.7
##export VERSIONDATE=20150918
##export VERSION=3.17.1
##export VERSIONDATE=20150429
##export VERSION=3.17.2
##export VERSIONDATE=20150527
##export VERSION=3.17.3
##export VERSIONDATE=20150528
##export VERSION=3.17.4
##export VERSIONDATE=20150528
##export VERSION=3.17.5
##export VERSIONDATE=20150721
##export VERSION=3.17.6
##export VERSIONDATE=20150811
##export VERSION=3.17.7
##export VERSIONDATE=20150818
##export VERSION=3.17.8
##export VERSIONDATE=20150902
##export VERSION=3.17.9
##export VERSIONDATE=20150915
#####Requested 'pango >= 1.37.1' but version of Pango is 1.36.8
##export VERSION=3.18.0
##export VERSIONDATE=20150922
##export VERSION=3.18.1
##export VERSIONDATE=20151004
##export VERSION=3.18.2
##export VERSIONDATE=20151013
##export VERSION=3.18.3
##export VERSIONDATE=20151110
##export VERSION=3.18.4
##export VERSIONDATE=20151113
##export VERSION=3.18.5
##export VERSIONDATE=20151117
##export VERSION=3.18.6
##export VERSIONDATE=20151205
##export VERSION=3.18.7
##export VERSIONDATE=20160128
##export VERSION=3.18.8
##export VERSIONDATE=20160224
##export VERSION=3.18.9
##export VERSIONDATE=20160310
#####Version 3.18.9 is the latest with plain MinGW (i.e. not MinGW-W64)
##export VERSION=3.19.1
##export VERSIONDATE=20151101
##export VERSION=3.19.2
##export VERSIONDATE=20151120
##export VERSION=3.19.3
##export VERSIONDATE=20151127
##export VERSION=3.19.4
##export VERSIONDATE=20151205
##export VERSION=3.19.5
##export VERSIONDATE=20151218
##export VERSION=3.19.6
##export VERSIONDATE=20160109
##export VERSION=3.19.7
##export VERSIONDATE=20160121
##export VERSION=3.19.8
##export VERSIONDATE=20160131
##export VERSION=3.19.9
##export VERSIONDATE=20160217
##export VERSION=3.19.10
##export VERSIONDATE=20160224
##export VERSION=3.19.11
##export VERSIONDATE=20160302
##export VERSION=3.19.12
##export VERSIONDATE=20160315
##export VERSION=3.20.0
##export VERSIONDATE=20160321
##export VERSION=3.20.1
##export VERSIONDATE=20160325
##export VERSION=3.20.2
##export VERSIONDATE=20160405
##export VERSION=3.20.3
##export VERSIONDATE=20160412
##export VERSION=3.20.4
##export VERSIONDATE=20160510
##export VERSION=3.20.5
##export VERSIONDATE=20160520
##export VERSION=3.20.6
##export VERSIONDATE=20160524
##export VERSION=3.20.7
##export VERSIONDATE=20160805
#####You need cairo version newer than 2015-04-14
##export VERSION=3.20.8
##export VERSIONDATE=20160805
##export VERSION=3.20.9
##export VERSIONDATE=20160818
##export VERSION=3.20.10
##export VERSIONDATE=20170222
#####gdk/win32/gdkevents-win32.c:3421:10: error: 'WM_DWMCOMPOSITIONCHANGED' undeclared (first use in this function)
##export VERSION=3.21.1
##export VERSIONDATE=20160428
##export VERSION=3.21.2
##export VERSIONDATE=20160528
##export VERSION=3.21.3
##export VERSIONDATE=20160621
##export VERSION=3.21.4
##export VERSIONDATE=20160718
#####You need a cairo snapshot 1.15.x or 1.16.x release or newer
##export VERSION=3.21.5
##export VERSIONDATE=20160830
##export VERSION=3.21.6
##export VERSIONDATE=20160913
#####Requested 'glib-2.0 >= 2.49.4' but version of GLib is 2.48.2
##export VERSION=3.22.0
##export VERSIONDATE=20160920
#####configure: error: DISPLAYCONFIG_VIDEO_OUTPUT_TECHNOLOGY is unavailable
##export VERSION=3.22.1
##export VERSIONDATE=20161001
#####gdk/win32/gdkevents-win32.c:3536:10: error: 'WM_DWMCOMPOSITIONCHANGED' undeclared (first use in this function)
##export VERSION=3.22.2
##export VERSIONDATE=20161024
##export VERSION=3.22.3
##export VERSIONDATE=20161108
##export VERSION=3.22.4
##export VERSIONDATE=20161119
##export VERSION=3.22.5
##export VERSIONDATE=20161210
##export VERSION=3.22.6
##export VERSIONDATE=20170105
##export VERSION=3.22.7
##export VERSIONDATE=20170117
##export VERSION=3.22.8
##export VERSIONDATE=20170214
##export VERSION=3.22.9
##export VERSIONDATE=20170228
#####configure: error: DISPLAYCONFIG_VIDEO_OUTPUT_TECHNOLOGY is unavailable
#####Solution: in case of the above build version 3.18.9
##export VERSION=3.22.10
##export VERSIONDATE=20170314
##export VERSION=3.22.11
##export VERSIONDATE=20170320
##export VERSION=3.22.12
##export VERSIONDATE=20170409
##export VERSION=3.22.13
##export VERSIONDATE=20170510
##export VERSION=3.22.14
##export VERSIONDATE=20170511
##export VERSION=3.22.15
##export VERSIONDATE=20170512
##export VERSION=3.22.16
##export VERSIONDATE=20170621
##export VERSION=3.22.17
##export VERSIONDATE=20170719
##export VERSION=3.22.18
##export VERSIONDATE=20170815
##export VERSION=3.22.19
##export VERSIONDATE=20170822
##export VERSION=3.22.20
##export VERSIONDATE=20170905
##export VERSION=3.22.21
##export VERSIONDATE=20170912
##export VERSION=3.22.22
##export VERSIONDATE=20171003
##export VERSION=3.22.23
##export VERSIONDATE=20171005
##export VERSION=3.22.25
##export VERSIONDATE=20171030
##export VERSION=3.22.26
##export VERSIONDATE=20171108
#####gdk/win32/gdkmonitor-win32.c:43:22: fatal error: cfgmgr32.h: No such file or directory
##export VERSION=3.22.27
##export VERSIONDATE=20180214
#####gtk/gtkfontchooserdialog.c:29:10: fatal error: gtkfontchooserwidgetprivate.h: No such file or directory
##export VERSION=3.22.28
##export VERSIONDATE=20180215
##export VERSION=3.22.29
##export VERSIONDATE=20180313
##export VERSION=3.22.30
##export VERSIONDATE=20180417
##export VERSION=3.23.0
##export VERSIONDATE=20180624
##export VERSION=3.23.1
##export VERSIONDATE=20180719
#####gtk/gtkfontchooserwidget.c:63:10: fatal error: language-names.h: No such file or directory
##export VERSION=3.23.2
##export VERSIONDATE=20180731
##export VERSION=3.23.3
##export VERSIONDATE=20180829
##export VERSION=3.24.0
##export VERSIONDATE=20180904
##export VERSION=3.24.1
##export VERSIONDATE=20180919
##export VERSION=3.24.2
##export VERSIONDATE=20181213
##export VERSION=3.24.3
##export VERSIONDATE=20190115
##export VERSION=3.24.4
##export VERSIONDATE=20190122
##export VERSION=3.24.5
##export VERSIONDATE=20190205
##export VERSION=3.24.6
##export VERSIONDATE=20190313
##export VERSION=3.24.7
##export VERSIONDATE=20190313
##export VERSION=3.24.8
##export VERSIONDATE=20190412
##export VERSION=3.24.9
##export VERSIONDATE=20190619
##export VERSION=3.24.10
##export VERSIONDATE=20190704
##export VERSION=3.24.11
##export VERSIONDATE=20190904
##export VERSION=3.24.12
##export VERSIONDATE=20190904
##export VERSION=3.24.13
##export VERSIONDATE=20191128
##export VERSION=3.24.14
##export VERSIONDATE=20200218
##export VERSION=3.24.16
##export VERSIONDATE=20200328
#export VERSION=3.24.17
#export VERSIONDATE=20200404
#####gdk/win32/gdkmonitor-win32.c:176: undefined reference to `SetupDiGetDevicePropertyW'
#####Requested 'graphene-1.0 >= 1.5.1' but version of Graphene is 1.4.0
#wl-showstatus --package-version
#export DEPENDENCIES=glib2,atk,pango,cairo,gdk-pixbuf,gettext,libiconv,libpng,libjpeg,libtiff,freetype2,fontconfig,expat,libepoxy,harfbuzz,fribidi
#export OPTIONALDEPENDENCIES=libx11
#export BUILDDEPENDENCIES=
#export OPTIONALBUILDDEPENDENCIES=
#export LICENSEFILE=COPYING
#export LICENSETYPE=LGPL2
#export DOWNLOADURL="http://ftp.gnome.org/pub/gnome/sources/gtk+/ gtk+-"
#export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
##export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/gtk+/`echo $VERSION|sed 's/^\([0-9]*\.[0-9]*\)\..*$/\1/'`/gtk+-$VERSION.tar.bz2
#export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/gtk+/`echo $VERSION|sed 's/^\([0-9]*\.[0-9]*\)\..*$/\1/'`/gtk+-$VERSION.tar.xz
#wl-showstatus download
#wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
#wl-wait4deps
##tar xj --force-local -f $TARBALLDIR/$BASENAME/gtk+-$VERSION.tar.bz2
#tar xJ --force-local -f $TARBALLDIR/$BASENAME/gtk+-$VERSION.tar.xz
#cd gtk+-$VERSION
## skip making tests
#cat > gtk/tests/Makefile.in << EOF
#all:
#install:
#install-strip:
#clean:
#EOF
#cat > tests/Makefile.in << EOF
#all:
#install:
#install-strip:
#clean:
#EOF
## skip making demos
#cat > demos/Makefile.in << EOF
#all:
#depend:
#links:
#generate:
#install:
#install-strip:
#EOF
### workaround for missing gdk-pixbuf/libgdk_pixbuf-2.0.la (version >= 2.21.4 < 3.0.0)
##mkdir -p gdk-pixbuf
##cp $MINGWPREFIX/lib/libgdk_pixbuf-2.0.la gdk-pixbuf/
## fix gdk/win32/gdkdevicemanager-win32.c (version >= 3.0.0)
#mv gdk/win32/gdkdevicemanager-win32.c gdk/win32/gdkdevicemanager-win32.c.bak
#echo "#include <windows.h>" > gdk/win32/gdkdevicemanager-win32.c
#echo "#include <commctrl.h>" >> gdk/win32/gdkdevicemanager-win32.c
#cat gdk/win32/gdkdevicemanager-win32.c.bak >> gdk/win32/gdkdevicemanager-win32.c
### fix gdk/win32/gdkevents-win32.c (version >= 3.0.0 <= 3.18.8)
##mv gdk/win32/gdkevents-win32.c gdk/win32/gdkevents-win32.c.bak
##cat > gdk/win32/gdkevents-win32.c << EOF
###define _WIN32_WINNT 0x0500
###include <windows.h>
###include <commctrl.h>
##EOF
##cat gdk/win32/gdkevents-win32.c.bak >> gdk/win32/gdkevents-win32.c
##sed -e "s/return_exposes/0/" gdk/win32/gdkevents-win32.c.bak >> gdk/win32/gdkevents-win32.c
## fix missing WM_DWMCOMPOSITIONCHANGED in gdk/win32/gdkevents-win32.c (version >= 3.22.0)
#patch -ulbf gdk/win32/gdkevents-win32.c << EOF
#--- gdk/win32/gdkevents-win32.c  2016-09-20 11:27:08.435915000 +0200
#+++ gdk/win32/gdkevents-win32.c  2016-09-20 13:59:07.162734000 +0200
#@@ -3534,2 +3534,3 @@
#
#+#ifdef WM_DWMCOMPOSITIONCHANGED
#     case WM_DWMCOMPOSITIONCHANGED:
#@@ -3537,2 +3538,3 @@
#       break;
#+#endif
#
#EOF
### fix missing WM_DWMCOMPOSITIONCHANGED in gdk/win32/gdkwindow-win32.c (version >= 3.22.2)
##mv gdk/win32/gdkwindow-win32.c gdk/win32/gdkwindow-win32.c.bak &&
##echo "#define _WIN32_WINNT 0x0600" > gdk/win32/gdkwindow-win32.c &&
##cat gdk/win32/gdkwindow-win32.c.bak >> gdk/win32/gdkwindow-win32.c
## fix missing WM_DWMCOMPOSITIONCHANGED in gdk/win32/gdkevents-win32.c (version >= 3.18.9)
#mv gdk/win32/gdkevents-win32.c gdk/win32/gdkevents-win32.c.bak &&
#echo "#define _WIN32_WINNT 0x0600" > gdk/win32/gdkevents-win32.c &&
#cat gdk/win32/gdkevents-win32.c.bak >> gdk/win32/gdkevents-win32.c
### fix gtk/gtkfilechoosernativewin32.c (version >= 3.22.2)
##patch -ulbf gtk/gtkfilechoosernativewin32.c << EOF
##--- gtk/gtkfilechoosernativewin32.c  2016-10-22 06:18:04.000000000 +0200
##+++ gtk/gtkfilechoosernativewin32.c  2016-10-24 20:32:32.082655400 +0200
##@@ -24,2 +24,4 @@
## #define WINVER _WIN32_WINNT
##+#undef WIDL_C_INLINE_WRAPPERS
##+#include <shobjidl.h>
## #define NTDDI_VERSION NTDDI_VISTA
##EOF
## fix missing WM_CLIPBOARDUPDATE in gdk/win32/gdkdisplay-win32.c (version >= 3.22.0)
#patch -ulbf gdk/win32/gdkdisplay-win32.c << EOF
#--- gdk/win32/gdkdisplay-win32.c  2016-04-28 05:18:24 +0200
#+++ gdk/win32/gdkdisplay-win32.c  2016-09-20 16:37:20 +0200
#@@ -547,3 +547,5 @@
#       }
#+#ifdef WM_CLIPBOARDUPDATE
#     case WM_CLIPBOARDUPDATE:
#+#endif
#     case WM_DRAWCLIPBOARD:
#EOF
### fix missing gtk/gtk-update-icon-cache (version >= 3.0.0)
##cat > gtk/gtk-update-icon-cache << EOF
##gtk-update-icon-cache.exe \$1 \$2 \$3 \$4 \$5 \$6 \$7 \$8 \$9
##EOF
## fix missing INPUT/INPUT_KEYBOARD in gdk/win32/gdktestutils-win32.c (version >= 3.14.0)
#mv gdk/win32/gdktestutils-win32.c gdk/win32/gdktestutils-win32.c.bak
#echo "#define _WIN32_WINNT 0x0403" > gdk/win32/gdktestutils-win32.c
#cat gdk/win32/gdktestutils-win32.c.bak >> gdk/win32/gdktestutils-win32.c
#patch -ulbf gtk/Makefile.in << EOF
#--- gtk/Makefile.in  2011-04-15 17:06:06 +0200
#+++ gtk/Makefile.in  2011-06-06 15:10:10 +0200
#@@ -86,3 +86,3 @@
# bin_PROGRAMS = gtk-query-immodules-3.0\$(EXEEXT) \$(am__EXEEXT_1)
#-@BUILD_ICON_CACHE_TRUE@am__append_19 = gtk-update-icon-cache
#+@BUILD_ICON_CACHE_TRUE@am__append_19 = gtk-update-icon-cache\$(EXEEXT)
# subdir = gtk
#@@ -2916,3 +2916,3 @@
#           --source builtin_icons stock-icons > gtkbuiltincache.h.tmp &&        \\
#-       mv gtkbuiltincache.h.tmp gtkbuiltincache.h
#+       \$(am__mv) gtkbuiltincache.h.tmp gtkbuiltincache.h || true
#
#EOF
## fix missing GTK_IS_PLUG and GTK_IS_SOCKET in modules/other/gail/gail.c (version >= 3.0.0)
#mv modules/other/gail/gail.c modules/other/gail/gail.c.bak
#echo "inline int GTK_IS_SOCKET (void* obj) { return 0; }" > modules/other/gail/gail.c
#cat modules/other/gail/gail.c.bak >> modules/other/gail/gail.c
## fix missing GTK_IS_PLUG modules/other/gail/gailwindow.c (version >= 3.0.0)
#mv modules/other/gail/gailwindow.c modules/other/gail/gailwindow.c.bak
#echo "inline int GTK_IS_PLUG (void* obj) { return 0; }" > modules/other/gail/gailwindow.c
#cat modules/other/gail/gailwindow.c.bak >> modules/other/gail/gailwindow.c
## fix missing GTK_IS_PLUG modules/other/gail/gailtoplevel.c (version >= 3.0.0)
#mv modules/other/gail/gailtoplevel.c modules/other/gail/gailtoplevel.c.bak
#echo "inline int GTK_IS_PLUG (void* obj) { return 0; }" > modules/other/gail/gailtoplevel.c
#cat modules/other/gail/gailtoplevel.c.bak >> modules/other/gail/gailtoplevel.c
### fix missing VK_PACKET in gdk/win32/gdkevents-win32.c (version >= 3.0.1 <= 3.16.7)
##mv gdk/win32/gdkevents-win32.c gdk/win32/gdkevents-win32.c.bak
##echo "#define VK_PACKET 0xE7" > gdk/win32/gdkevents-win32.c
##cat gdk/win32/gdkevents-win32.c.bak >> gdk/win32/gdkevents-win32.c
## fix missing GDesktopAppInfo in gtk/gtkapplicationwindow.c (version >= 3.4.1)
#patch -ulbf gtk/gtkapplicationwindow.c << EOF
#--- gtk/gtkapplicationwindow.c  2012-04-13 03:41:46 +0200
#+++ gtk/gtkapplicationwindow.c  2012-04-14 19:54:56 +0200
#@@ -270,8 +270,9 @@
#       /* the shell shows it, so don't show it locally */
#       if (g_menu_model_get_n_items (G_MENU_MODEL (window->priv->app_menu_section)) != 0)
#         g_menu_remove (window->priv->app_menu_section, 0);
#     }
#+#ifndef _WIN32
#   else
#     {
#       /* the shell does not show it, so make sure we show it */
#       if (g_menu_model_get_n_items (G_MENU_MODEL (window->priv->app_menu_section)) == 0)
#@@ -311,8 +312,9 @@
#               g_clear_object (&app_info);
#             }
#         }
#     }
#+#endif
# }
#
# static void
# gtk_application_window_update_shell_shows_menubar (GtkApplicationWindow *window,
#EOF
### fix missing gio/gdesktopappinfo.h (version >= 3.6.1)
##mkdir -p gtk/gio
##touch gtk/gio/gdesktopappinfo.h
## fix configure problem in detection of cairo-pdf.h
#patch -ulbf configure << EOF
#--- configure   2010-09-23 16:27:28 +0200
#+++ configure   2010-09-24 12:54:52 +0200
#@@ -23745,6 +23745,2 @@
#
#-else
#-  as_fn_error \$? "
#-*** Can't find cairo-pdf.h. You must build Cairo with the pdf
#-*** backend enabled." "\$LINENO" 5
# fi
#EOF
## fix missing INITCOMMONCONTROLSEX in gtk/gtkprintoperation-win32.c (version >= 3.13.8)
#mv gtk/gtkprintoperation-win32.c gtk/gtkprintoperation-win32.c.bak
#echo "#define _WIN32_IE 0x0300" > gtk/gtkprintoperation-win32.c
#cat gtk/gtkprintoperation-win32.c.bak >> gtk/gtkprintoperation-win32.c
## fix missing INITCOMMONCONTROLSEX in gtk/gtkprintoperation.c (version >= 3.13.8)
#mv gtk/gtkprintoperation.c gtk/gtkprintoperation.c.bak
#echo "#define _WIN32_IE 0x0300" > gtk/gtkprintoperation.c
#cat gtk/gtkprintoperation.c.bak >> gtk/gtkprintoperation.c
## fix missing ACTCTXA in gtk/gtkwin32.c (version >= 3.14.2)
#mv gtk/gtkwin32.c gtk/gtkwin32.c.bak
#echo "#define _WIN32_WINNT 0x0501" > gtk/gtkwin32.c
#cat gtk/gtkwin32.c.bak >> gtk/gtkwin32.c
## fix missing GTK_IS_PLUG (version >= 3.14.5)
#cat >> gtk/gtkplug.h << EOF
##if defined(GDK_WINDOWING_WIN32) && !defined(GTK_IS_PLUG)
##define GTK_IS_PLUG(obj) 0
##endif
#EOF
## fix missing dwmapi.h in gdk/win32/gdkscreen-win32.c (version >= 3.18.9)
#echo "#include <dwmapi.h>" | ${CC:-gcc} -c -xc - -o /dev/null &> /dev/null || patch -ulbf gdk/win32/gdkscreen-win32.c << EOF
#--- gdk/win32/gdkscreen-win32.c  2016-01-07 04:25:56 +0100
#+++ gdk/win32/gdkscreen-win32.c  2016-11-28 16:03:04 +0100
#@@ -23,3 +23,7 @@
#
#+#if defined(__MINGW64_VERSION_MAJOR)
# #include <dwmapi.h>
#+#else
#+#define DwmIsCompositionEnabled(result) (~S_OK)
#+#endif
#
#EOF
## fix missing dwmapi.h in gdk/win32/gdkwindow-win32.c (version >= 3.18.9)
#echo "#include <dwmapi.h>" | ${CC:-gcc} -c -xc - -o /dev/null &> /dev/null || patch -ulbf gdk/win32/gdkwindow-win32.c << EOF
#--- gdk/win32/gdkwindow-win32.c  2016-01-07 04:25:56 +0100
#+++ gdk/win32/gdkwindow-win32.c  2016-11-28 16:00:37 +0100
#@@ -43,3 +43,5 @@
# #include <cairo-win32.h>
#+#if defined(__MINGW64_VERSION_MAJOR)
# #include <dwmapi.h>
#+#endif
#
#@@ -251,2 +253,3 @@
# {
#+#if defined(__MINGW64_VERSION_MAJOR)
#   DWM_BLURBEHIND blur_behind;
#@@ -291,2 +294,5 @@
#   return SUCCEEDED (call_result);
#+#else
#+  return FALSE;
#+#endif
# }
#EOF
## don't link with -ldwmapi if unavailable
#echo "#include <dwmapi.h>" | ${CC:-gcc} -c -xc - -o /dev/null &> /dev/null || (
# mv configure configure.no_dwmapi &&
# sed -e "s/-ldwmapi//" configure.no_dwmapi > configure
#)
## fix missing USER_DEFAULT_SCREEN_DPI in gdk/win32/gdkdisplay-win32.c (version >= 3.22.5)
#mv gdk/win32/gdkdisplay-win32.c gdk/win32/gdkdisplay-win32.c.bak
#grep "^#define _WIN32_WINNT" gdk/win32/gdkdisplay-win32.c.bak > gdk/win32/gdkdisplay-win32.c
#cat >> gdk/win32/gdkdisplay-win32.c << EOF
##include <windows.h>
##ifndef USER_DEFAULT_SCREEN_DPI
##define USER_DEFAULT_SCREEN_DPI 96
##endif
#EOF
#cat gdk/win32/gdkdisplay-win32.c.bak >> gdk/win32/gdkdisplay-win32.c
### fix missing forward declaration of DllMain in gtk/gtkwin32.c (version >= 3.90.0)
##patch -ulbf gtk/gtkwin32.c << EOF
##--- gtk/gtkwin32.c  2017-04-01 09:27:13.869737200 +0200
##+++ gtk/gtkwin32.c  2017-04-01 10:21:46.614447400 +0200
##@@ -33,2 +33,3 @@
## #include <windows.h>
##+BOOL WINAPI DllMain (HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved);
## #include <commctrl.h>
##EOF
### fix missing forward declarations in gtk/gtkprintoperation-win32.c (version >= 3.90.0)
##patch -ulbf gtk/gtkprintoperation-win32.c << EOF
##--- gtk/gtkprintoperation-win32.c.bak2  2017-04-01 09:27:13.548344400 +0200
##+++ gtk/gtkprintoperation-win32.c       2017-04-01 10:12:51.687992800 +0200
##@@ -71,2 +71,6 @@
##
##+UINT_PTR CALLBACK run_mainloop_hook (HWND hdlg, UINT uiMsg, WPARAM wParam, LPARAM lParam);
##+void win32_start_page (GtkPrintOperation *op, GtkPrintContext *print_context, GtkPageSetup *page_setup);
##+GtkPrintOperationResult gtk_print_operation_run_without_dialog (GtkPrintOperation *op, gboolean *do_print);
##+GtkPrintOperationResult gtk_print_operation_run_with_dialog (GtkPrintOperation
##*op, GtkWindow *parent, gboolean *do_print);
## static void win32_poll_status (GtkPrintOperation *op);
##EOF
### avoid failing cairo version check (version >= 3.20.0)
##mv configure configure.bak2
##sed -e 's/as_fn_error.*\("cairo_win32_surface_create_with_format\)/echo \1/' configure.bak2 > configure
### fix missing gdk.def in gdk/Makefile.am, see also https://bugzilla.gnome.org/show_bug.cgi?id=700445 (version >= 3.9.0)
##patch -ulbf gdk/Makefile.am << EOF
##--- gdk/Makefile.am
##+++ gdk/Makefile.am
##@@ -179,10 +179,14 @@ endif # USE_QUARTZ
## if USE_WIN32
## libgdk_3_la_SOURCES += gdkkeynames.c
## libgdk_3_la_LIBADD += win32/libgdk-win32.la
##-libgdk_3_la_DEPENDENCIES = win32/libgdk-win32.la win32/rc/gdk-win32-res.o gdk.def
##-libgdk_3_la_LDFLAGS += -Wl,win32/rc/gdk-win32-res.o -export-symbols \$(srcdir)/gdk.def
##+libgdk_3_la_DEPENDENCIES = win32/libgdk-win32.la win32/rc/gdk-win32-res.o
##+libgdk_3_la_LDFLAGS += -Wl,win32/rc/gdk-win32-res.o
## endif # USE_WIN32
## 
##+if MS_LIB_AVAILABLE
##+libgdk_3_la_LDFLAGS += -Wl,--output-def -Wl,gdk.def
##+endif # MS_LIB_AVAILABLE
##+
## if USE_BROADWAY
## libgdk_3_la_LIBADD += broadway/libgdk-broadway.la
## endif # USE_BROADWAY
##@@ -281,10 +285,11 @@ CLEANFILES += \$(gir_DATA) \$(typelibs_DATA)
## 
## endif # HAVE_INTROSPECTION
## 
##-if OS_WIN32
##-install-def-file: gdk.def
##+if MS_LIB_AVAILABLE
##+CLEANFILES += gdk.def
##+install-def-file:
##        mkdir -p \$(DESTDIR)\$(libdir)
##-       \$(INSTALL) \$(srcdir)/gdk.def \$(DESTDIR)\$(libdir)/gdk-win32-3.0.def
##+       \$(INSTALL) gdk.def \$(DESTDIR)\$(libdir)/gdk-win32-3.0.def
## uninstall-def-file:
##        -rm \$(DESTDIR)\$(libdir)/gdk-win32-3.0.def
## else
##@@ -293,17 +298,21 @@ uninstall-def-file:
## endif
## 
## if MS_LIB_AVAILABLE
##+libgdk_dlname = \`sed -n "s/^dlname='\\([A-Za-z0-9.+-]\\+\\)'/\\1/p" libgdk-3.la\`
## noinst_DATA = gdk-win32-\$(GTK_API_VERSION).lib
##+CLEANFILES += gdk-win32-\$(GTK_API_VERSION).lib gdk-win32-\$(GTK_API_VERSION).exp
## 
##-gdk-win32-\$(GTK_API_VERSION).lib: libgdk-win32-\$(GTK_API_VERSION).la gdk.def
##-       lib -machine:@LIB_EXE_MACHINE_FLAG@ -name:libgdk-win32-\$(GTK_API_VERSION)-@LT_CURRENT_MINUS_AGE@.dll -def:gdk.def -out:\$@
##+gdk-win32-\$(GTK_API_VERSION).lib: libgdk-3.la
##+       lib -machine:@LIB_EXE_MACHINE_FLAG@ -name:\$(libgdk_dlname) -def:gdk.def -out:\$@
## 
## install-ms-lib:
##        mkdir -p \$(DESTDIR)\$(libdir)
##        \$(INSTALL) gdk-win32-\$(GTK_API_VERSION).lib \$(DESTDIR)\$(libdir)
##+       \$(INSTALL) gdk-win32-\$(GTK_API_VERSION).exp \$(DESTDIR)\$(libdir)
## 
## uninstall-ms-lib:
##        -rm \$(DESTDIR)\$(libdir)/gdk-win32-\$(GTK_API_VERSION).lib
##+       -rm \$(DESTDIR)\$(libdir)/gdk-win32-\$(GTK_API_VERSION).exp
## else
## install-ms-lib:
## uninstall-ms-lib:
##EOF
##patch -ulbf gtk/Makefile.am << EOF
##--- gtk/Makefile.am
##+++ gtk/Makefile.am
##@@ -56,22 +56,22 @@ AM_CPPFLAGS =                                          \\
##        \$(GTK_DEP_CFLAGS)                            \\
##        \$(INCLUDED_IMMODULE_DEFINE)
## 
##+CLEANFILES =
##+
## if PLATFORM_WIN32
## no_undefined = -no-undefined
## endif
## 
##-if OS_WIN32
##-gtk_def = gtk.def
##-gtk_win32_symbols = -export-symbols \$(srcdir)/gtk.def
##-
##+if MS_LIB_AVAILABLE
##+CLEANFILES += gtk.def
## gtk_win32_res = gtk-win32-res.o
## gtk_win32_res_ldflag = -Wl,gtk-win32-res.o
## 
## gtk-win32-res.o : gtk-win32.rc
##        \$(WINDRES) gtk-win32.rc \$@
## 
##-install-def-file: gtk.def
##-       \$(INSTALL) \$(srcdir)/gtk.def \$(DESTDIR)\$(libdir)/gtk-win32-3.0.def
##+install-def-file:
##+       \$(INSTALL) gtk.def \$(DESTDIR)\$(libdir)/gtk-win32-3.0.def
## uninstall-def-file:
##        -rm \$(DESTDIR)\$(libdir)/gtk-win32-3.0.def
## else
##@@ -79,17 +79,23 @@ install-def-file:
## uninstall-def-file:
## endif
## 
##+
##+
## if MS_LIB_AVAILABLE
##+libgtk_dlname = \`sed -n "s/^dlname='\\([A-Za-z0-9.+-]\\+\\)'/\\1/p" libgtk-3.la\`
## noinst_DATA = gtk-win32-\$(GTK_API_VERSION).lib
##+CLEANFILES += gdk-win32-\$(GTK_API_VERSION).lib gdk-win32-\$(GTK_API_VERSION).exp
## 
##-gtk-win32-\$(GTK_API_VERSION).lib: libgtk-win32-\$(GTK_API_VERSION).la gtk.def
##-       lib -machine:@LIB_EXE_MACHINE_FLAG@ -name:libgtk-win32-\$(GTK_API_VERSION)-@LT_CURRENT_MINUS_AGE@.dll -def:gtk.def -out:\$@
##+gtk-win32-\$(GTK_API_VERSION).lib: libgtk-3.la
##+       lib -machine:@LIB_EXE_MACHINE_FLAG@ -name:\$(libgtk_dlname) -def:gtk.def -out:\$@
## 
## install-ms-lib:
##        \$(INSTALL) gtk-win32-\$(GTK_API_VERSION).lib \$(DESTDIR)\$(libdir)
##+       \$(INSTALL) gtk-win32-\$(GTK_API_VERSION).exp \$(DESTDIR)\$(libdir)
## 
## uninstall-ms-lib:
##        -rm \$(DESTDIR)\$(libdir)/gtk-win32-\$(GTK_API_VERSION).lib
##+       -rm \$(DESTDIR)\$(libdir)/gtk-win32-\$(GTK_API_VERSION).exp
## else
## install-ms-lib:
## uninstall-ms-lib:
##@@ -1240,10 +1246,14 @@ libgtk_3_la_DEPENDENCIES = \$(deps)
## if USE_WIN32
## libgtk_3_la_LIBADD += -lole32 -lgdi32 -lcomdlg32 -lwinspool -lcomctl32
## libgtk_3_la_LDFLAGS += -Wl,-luuid
##-libgtk_3_la_DEPENDENCIES += \$(gtk_def) \$(gtk_win32_res) \$(deps)
##-libgtk_target_ldflags = \$(gtk_win32_res_ldflag) \$(gtk_win32_symbols)
##+libgtk_3_la_DEPENDENCIES += \$(gtk_win32_res) \$(deps)
##+libgtk_target_ldflags = \$(gtk_win32_res_ldflag)
## endif
## 
##+if MS_LIB_AVAILABLE
##+libgtk_3_la_LDFLAGS += -Wl,--output-def -Wl,gtk.def
##+endif # MS_LIB_AVAILABLE
##+
## install-exec-hook:
## if DISABLE_EXPLICIT_DEPS
##        \$(SHELL) \$(top_srcdir)/sanitize-la.sh \$(DESTDIR)\$(libdir)/libgtk-3.la
##EOF
##patch -ulbf libgail-util/Makefile.am << EOF
##--- libgail-util/Makefile.am
##+++ libgail-util/Makefile.am
##@@ -1,13 +1,15 @@
## include \$(top_srcdir)/Makefile.decl
## 
##-EXTRA_DIST += gailutil.def
## if PLATFORM_WIN32
## no_undefined = -no-undefined
## endif
##-if OS_WIN32
##-export_symbols = -export-symbols \$(srcdir)/gailutil.def
##-install-def-file: gailutil.def
##-       \$(INSTALL) \$(srcdir)/gailutil.def \$(DESTDIR)\$(libdir)
##+
##+CLEANFILES =
##+
##+if MS_LIB_AVAILABLE
##+CLEANFILES += gailutil.def
##+install-def-file:
##+       \$(INSTALL) gailutil.def \$(DESTDIR)\$(libdir)
## uninstall-def-file:
##        -rm \$(DESTDIR)\$(libdir)/gailutil.def
## else
##@@ -17,12 +19,15 @@ endif
## 
## if MS_LIB_AVAILABLE
## noinst_DATA = gailutil.lib
##+CLEANFILES += gailutil.lib gailutil.exp gailutil.def
## 
## install-ms-lib:
##        \$(INSTALL) gailutil.lib \$(DESTDIR)\$(libdir)
##+       \$(INSTALL) gailutil.exp \$(DESTDIR)\$(libdir)
## 
## uninstall-ms-lib:
##        -rm \$(DESTDIR)\$(libdir)/gailutil.lib
##+       -rm \$(DESTDIR)\$(libdir)/gailutil.exp
## else
## install-ms-lib:
## uninstall-ms-lib:
##@@ -71,11 +76,16 @@ libgailutil_3_la_LIBADD = \\
## libgailutil_3_la_LDFLAGS = \\
##        -version-info \$(GAIL_LT_VERSION_INFO)       \\
##        \$(no_undefined)                            \\
##-       \$(export_symbols)                     \\
##         \$(LDFLAGS)
##+        
##+if MS_LIB_AVAILABLE
##+libgailutil_3_la_LDFLAGS += -Wl,--output-def -Wl,gailutil.def
##+endif # MS_LIB_AVAILABLE
##+
##+libgailutil_dlname = \`sed -n "s/^dlname='\\([A-Za-z0-9.+-]\\+\\)'/\\1/p" libgailutil-3.la\`
## 
##-gailutil.lib: libgailutil-3.la gailutil.def
##-       lib -machine:@LIB_EXE_MACHINE_FLAG@ -name:libgailutil-3.0-\$(GAIL_LT_CURRENT_MINUS_AGE).dll -def:gailutil.def -out:\$@
##+gailutil.lib: libgailutil-3.la
##+       lib -machine:@LIB_EXE_MACHINE_FLAG@ -name:\$(libgailutil_dlname) -def:gailutil.def -out:\$@
## 
## install-data-local: install-ms-lib install-def-file
## 
##EOF
### skip building examples/bp (version >= 3.22.0)
##cat > examples/bp/Makefile.in << EOF
##clean:
##all:
##install:
##install-strip:
##EOF
## fix missing DISPLAYCONFIG_VIDEO_OUTPUT_TECHNOLOGY in configure (version >= 3.22.0)
#mv configure configure.bak &&
#sed -e "s/as_fn_error\(.*DISPLAYCONFIG_VIDEO_OUTPUT_TECHNOLOGY is unavailable\)/echo\1/" configure.bak > configure
#wl-showstatus configure &&
##./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --with-gdktarget=win32 --without-x --enable-introspection=no LDFLAGS="-Wl,--enable-auto-import" &&
##./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --with-gdktarget=win32 --with-x --with-xinput --enable-introspection=no LDFLAGS="-Wl,--as-needed -luuid -Wl,--enable-auto-import" &&
##./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --with-gdktarget=win32 --with-x --with-xinput --enable-introspection=no LDFLAGS="-Wl,--enable-auto-import" &&
##./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --with-x --enable-introspection=no LDFLAGS="-Wl,--enable-auto-import -Wl,--allow-multiple-definition" &&
##PKG_CONFIG=$(which pkg-config) ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --with-x --enable-introspection=no LDFLAGS="-Wl,--enable-auto-import -Wl,--allow-multiple-definition" &&
##PKG_CONFIG=$(which pkg-config) ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --with-x --disable-introspection --disable-glibtest LDFLAGS="-Wl,--enable-auto-import -Wl,--allow-multiple-definition" &&
#PKG_CONFIG=$(which pkg-config) ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --enable-win32-backend --disable-x11-backend --without-x --disable-introspection --disable-glibtest LDFLAGS="-Wl,--enable-auto-import -Wl,--allow-multiple-definition" &&
#####--disable-schemas-compile
# wl-showstatus build &&
# # remove smiley's (SOH, ASCII 1) from Makefile
# ( sed -i.bak s/$'\x01'//g $(grep -l $'\x01' `find . -iname Makefile`) || true ) &&
# # fix missing libuuid.dll.a (version >= 3.0.0)
# sed -i.bak "s/-luuid//g; s/^\(am__append_14.*\)/\1 -Wl,-luuid/" $(grep -l "luuid" `find . -iname Makefile`) &&
# # fix missing gtk_style_get_font (version >= 3.0.0 <= 3.8.4)
# ( mv -f gtk/gtk.def gtk/gtk.def.bak && sed -i.bak "s/^ *gtk_style_get_font$//" gtk/gtk.def.bak > gtk/gtk.def || true ) &&
# mv -f gdk/Makefile.bak gdk/Makefile &&
# # fix already defined isinf (version >= 3.4.3)
# echo "#define HAVE_ISINF 1" >> config.h &&
# #( make || make LIBS="-Wl,--as-needed -lpng.dll" ) &&
# ( PYTHONPATH=$MINGWPREFIX/share:$MINGWPREFIX/share/glib-2.0${PYTHONPATH:+:$PYTHONPATH} make || PYTHONPATH=$MINGWPREFIX/share:$MINGWPREFIX/share/glib-2.0${PYTHONPATH:+:$PYTHONPATH} make LIBS="-Wl,--as-needed -luuid" ) &&
# wl-showstatus build-install &&
# ( make -j1 all install-strip || make -i install-strip ) &&
# mkdir -p $INSTALLPREFIX/include/gtk-`echo $VERSION|sed 's/^\([0-9]*\.[0-9]*\)\..*$/\1/'`/gdk/win32 &&
# #cp -f gdk/win32/*.h $INSTALLPREFIX/include/gtk-*/gdk/win32/ &&
# for D in $INSTALLPREFIX/include/gtk-*/gdk/win32 ; do
#  cp -f gdk/win32/*.h $D/
# done &&
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf gtk+-$VERSION
#####gtk/gtkcsssection.c:139: undefined reference to `__sync_fetch_and_sub_4'
##make clean; make CFLAGS="-march=i686" CXXFLAGS="-march=i686" && echo OK



export NAME="GTK+ 3"
export STATUS=
export URL=http://www.gtk.org/
export BASENAME=gtk3
export DESCRIPTION="GTK+ is a highly usable, feature rich toolkit for creating graphical user interfaces which boasts cross platform compatibility and an easy to use API."
export CATEGORY=gui
export TYPE=library
#export VERSION=3.24.14
#export VERSIONDATE=20200218
#export VERSION=3.24.16
#export VERSIONDATE=20200328
#export VERSION=3.24.17
#export VERSIONDATE=20200404
####/include/xmmintrin.h:120: syntax error, unexpected '{' in '  return __extension__ (__m128){ 0.0f, 0.0f, 0.0f, 0.0f };' at '{'
#export VERSION=3.24.18
#export VERSIONDATE=20200410
#export VERSION=3.24.20
#export VERSIONDATE=20200428
####meson.build:990:0: ERROR: Program(s) ['check-version.py'] not found or not executable
#export VERSION=3.24.21
#export VERSIONDATE=20200629
#export VERSION=3.24.22
#export VERSIONDATE=20200811
#export VERSION=3.24.23
#export VERSIONDATE=20200904
#export VERSION=3.24.24
#export VERSIONDATE=20201207
#export VERSION=3.24.25
#export VERSIONDATE=20210213
#export VERSION=3.24.26
#export VERSIONDATE=20210225
#export VERSION=3.24.27
#export VERSIONDATE=20210313
#export VERSION=3.24.28
#export VERSIONDATE=20210327
export VERSION=3.24.29
export VERSIONDATE=20210423
wl-showstatus --package-version
export DEPENDENCIES=glib2,gobject-introspection,atk,pango,cairo,gdk-pixbuf,gettext,libiconv,libpng,libjpeg,libtiff,freetype2,fontconfig,expat,libepoxy,harfbuzz,fribidi
export OPTIONALDEPENDENCIES=libx11
#export OPTIONALDEPENDENCIES=libx11,libcloudproviders,librest,libjson-glib
export BUILDDEPENDENCIES=
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=COPYING
export LICENSETYPE=LGPL2
export DOWNLOADURL="http://ftp.gnome.org/pub/gnome/sources/gtk+/ gtk+-"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/gtk+/$(echo $VERSION|sed 's/^\([0-9]*\.[0-9]*\)\..*$/\1/')/gtk+-$VERSION.tar.xz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
tar xJ --force-local -f $TARBALLDIR/$BASENAME/gtk+-$VERSION.tar.xz
cd gtk+-$VERSION
# fix MSVC issue
mkdir -p winfix
cp -rf $PYDIR/lib/distutils winfix/
patch -ulbf winfix/distutils/cygwinccompiler.py << EOF
@@ -85,3 +85,3 @@
         else:
-            raise ValueError("Unknown MS Compiler version %s " % msc_ver)
+            return None

EOF
# avoid -Werror=array-bounds
sed -i.bak -e "s/'-Werror=array-bounds',//" meson.build
mkdir -p build_both &&
 wl-showstatus configure &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -D win32-backend=true -D x11-backend=false -D wayland-backend=false -D broadway-backend=false -D quartz-backend=false -D print-backends=file -D documentation=true -D man-pages=false -D introspection=true -D demos=false -D build-examples=false -D build-tests=false -D install-tests=false . build_both &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Dwin32-backend=true -Dx11-backend=$(if pkg-config --exists x11; then echo "true"; else echo "false"; fi) -Dwayland-backend=false -Dbroadway-backend=false -Dquartz-backend=false -Dprint_backends= -Dcloudproviders=false -Ddocumentation=true -Dman-pages=false -Dintrospection=true -Ddemos=false -Dbuild-examples=false -Dbuild-tests=false -Dinstall-tests=false . build_both &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Dwin32-backend=true -Dx11-backend=$(if pkg-config --exists x11; then echo "true"; else echo "false"; fi) -Dwayland-backend=false -Dbroadway-backend=false -Dquartz-backend=false -Dprint_backends= -Dcloudproviders=false -Ddocumentation=true -Dman-pages=false -Dintrospection=true -Ddemos=false -Dbuild-examples=false -Dbuild-tests=false -Dinstall-tests=false -Dc_args="-fcommon" . build_both &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Dwin32-backend=true -Dx11-backend=$(if pkg-config --exists x11; then echo "true"; else echo "false"; fi) -Dwayland-backend=false -Dbroadway-backend=false -Dquartz-backend=false -Dprint_backends=$(if pkg-config --exists cloudproviders; then echo "cloudprint"; fi) -Dcloudproviders=$(if pkg-config --exists cloudproviders; then echo "true"; else echo "false"; fi) -Ddocumentation=true -Dman-pages=false -Dintrospection=true -Ddemos=false -Dbuild-examples=false -Dbuild-tests=false -Dinstall-tests=false -Dc_args="-fcommon" . build_both &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Dwin32_backend=true -Dx11_backend=$(if pkg-config --exists x11; then echo "true"; else echo "false"; fi) -Dwayland_backend=false -Dbroadway_backend=false -Dquartz_backend=false -Dprint_backends= -Dcloudproviders=false -Dgtk_doc=false -Dman=false -Dintrospection=true -Ddemos=false -Dexamples=false -Dtests=false -Dinstalled_tests=false -Dc_args="-fcommon" . build_both &&
 PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Dwin32_backend=true -Dx11_backend=$(if pkg-config --exists x11; then echo "true"; else echo "false"; fi) -Dwayland_backend=false -Dbroadway_backend=false -Dquartz_backend=false -Dprint_backends= -Dcloudproviders=false -Dgtk_doc=false -Dman=false -Dintrospection=true -Ddemos=false -Dexamples=false -Dtests=false -Dinstalled_tests=false -Dc_args="-fcommon" . build_both &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Dwin32_backend=true -Dx11_backend=$(if pkg-config --exists x11; then echo "true"; else echo "false"; fi) -Dwayland_backend=false -Dbroadway_backend=false -Dquartz_backend=false -Dprint_backends=$(if pkg-config --exists cloudproviders; then echo "cloudprint"; fi) -Dcloudproviders=$(if pkg-config --exists cloudproviders; then echo "true"; else echo "false"; fi) -Dgtk_doc=false -Dman=false -Dintrospection=true -Ddemos=false -Dexamples=false -Dtests=false -Dinstalled_tests=false -Dc_args="-fcommon" . build_both &&
 # fix slash/backslash path issue when calling Python from Ninja
 sed -i.bak -e "s/join_paths/os.path.join/g; /COMMAND =.*python\.exe/ s?\"/\([a-zA-Z]\)/?\"\1:/?; /COMMAND =.*python\.exe/ s?/?\\\\?g" build_both/build.ninja &&
 # fix execution of Python scripts
 sed -i.bak2 -e "s?\(COMMAND\|POST_BUILD\)\( *= *\| *=.*\&\& *\)\(\"\{0,1\}[^ ]*\)\(\.py\|glib-mkenums\|g-ir-scanner\)\(\"\{0,1\} \)?\1\2python.exe \3\4\5?" build_both/build.ninja &&
 # fix missing .exe suffix for glib-compile-resources/glib-compile-schemas (version >= 3.24.29)
 sed -i.bak3 -e "s?\(/bin/glib-compile-\)\(resources\|schemas\)\([ \"].*\)*\$?\1\2.exe\3?" build_both/build.ninja &&
 wl-showstatus build-install &&
 #( PKG_CONFIG= PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -Cbuild_both || PKG_CONFIG= PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -j1 -Cbuild_both ) &&
 ( PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -Cbuild_both || PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -j1 -Cbuild_both ) &&
 wl-showstatus build-install &&
 #PKG_CONFIG= PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -Cbuild_both install &&
 #( PKG_CONFIG= PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -Cbuild_both install || PKG_CONFIG= PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -j1 -Cbuild_both install || ( PKG_CONFIG= PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -j1 -Cbuild_both; PKG_CONFIG= PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -Cbuild_both install )) &&
 ( PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -Cbuild_both install || PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -j1 -Cbuild_both install || ( PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -j1 -Cbuild_both; PATH=$PATH:$PYDIR PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -Cbuild_both install )) &&
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf gtk+-$VERSION



