export NAME="Praat"
export STATUS=
export URL=http://www.praat.org/
#export URL=http://www.fon.hum.uva.nl/praat/
export BASENAME=praat
export DESCRIPTION="Praat, a computer program with which you can analyse, synthesize, and manipulate speech, and create high-quality pictures for your articles and thesis."
export CATEGORY=audio
export TYPE=library
#export VERSION=5.3.45
#export VERSIONDATE=20130315
#export VERSION=5.3.46
#export VERSIONDATE=20130422
#export VERSION=5.3.47
#export VERSIONDATE=20130424
#export VERSION=5.3.48
#export VERSIONDATE=20130502
####64-bit: Graphics_image.cpp:35:22: fatal error: GdiPlus.h: No such file or directory compilation terminated.
#export VERSION=5.3.49
#export VERSIONDATE=20130514
#export VERSION=5.3.50
#export VERSIONDATE=20130522
#export VERSION=5.3.52
#export VERSIONDATE=20130613
#export VERSION=5.3.53
#export VERSIONDATE=20130710
#export VERSION=5.3.54
#export VERSIONDATE=20130901
#export VERSION=5.3.55
#export VERSIONDATE=20130903
#export VERSION=5.3.56
#export VERSIONDATE=20130916
#export VERSION=5.3.57
#export VERSIONDATE=20131027
#export VERSION=5.3.58
#export VERSIONDATE=20131118
#export VERSION=5.3.59
#export VERSIONDATE=20131120
#export VERSION=5.3.60
#export VERSIONDATE=20131209
#export VERSION=5.3.61
#export VERSIONDATE=20140102
#export VERSION=5.3.62
#export VERSIONDATE=20140103
#export VERSION=5.3.63
#export VERSIONDATE=20140125
#export VERSION=5.3.64
#export VERSIONDATE=20140213
#export VERSION=5.3.65
#export VERSIONDATE=20140228
#export VERSION=5.3.66
#export VERSIONDATE=20140310
#export VERSION=5.3.67
#export VERSIONDATE=20140319
#export VERSION=5.3.68
#export VERSIONDATE=20140321
#export VERSION=5.3.69
#export VERSIONDATE=20140329
#export VERSION=5.3.70
#export VERSIONDATE=20140403
#export VERSION=5.3.71
#export VERSIONDATE=20140410
#export VERSION=5.3.72
#export VERSIONDATE=20140418
#export VERSION=5.3.73
#export VERSIONDATE=20140422
#export VERSION=5.3.74
#export VERSIONDATE=20140425
#export VERSION=5.3.75
#export VERSIONDATE=20140501
#export VERSION=5.3.76
#export VERSIONDATE=20140508
#export VERSION=5.3.78
#export VERSIONDATE=20140612
#export VERSION=5.3.79
#export VERSIONDATE=20140622
#export VERSION=5.3.80
#export VERSIONDATE=20140630
#export VERSION=5.3.81
#export VERSIONDATE=20140704
#export VERSION=5.3.82
#export VERSIONDATE=20140726
#export VERSION=5.3.83
#export VERSIONDATE=20140816
#export VERSION=5.3.85
#export VERSIONDATE=20140919
#export VERSION=5.3.86
#export VERSIONDATE=20140929
#export VERSION=5.4.00
#export VERSIONDATE=20141004
#export VERSION=5.4.02
#export VERSIONDATE=20141205
#export VERSION=5.4.03
#export VERSIONDATE=20141220
#export VERSION=5.4.04
#export VERSIONDATE=20141230
#export VERSION=5.4.05
#export VERSIONDATE=20150219
#export VERSION=5.4.06
#export VERSIONDATE=20150221
#export VERSION=5.4.07
#export VERSIONDATE=20150323
#export VERSION=5.4.08
#export VERSIONDATE=20150324
#export VERSION=5.4.09
#export VERSIONDATE=20150602
####/include/psdk_inc/intrin-impl.h:849:1: error: undefined named operand 'Data'
#### __buildstos(__stosb, unsigned char, "b")
####/include/psdk_inc/intrin-impl.h:856:1: error: undefined named operand 'Data'
#### __buildstos(__stosw, unsigned short, "w")
#export VERSION=5.4.10
#export VERSIONDATE=20150628
#export VERSION=5.4.11
#export VERSIONDATE=20150409
#export VERSION=5.4.12
#export VERSIONDATE=20150711
####ar.exe: ipaSerifRegular24.o: No such file or directory
#export VERSION=5.4.13
#export VERSIONDATE=20150723
#export VERSION=5.4.14
#export VERSIONDATE=20150725
#export VERSION=5.4.15
#export VERSIONDATE=20150811
#export VERSION=5.4.16
#export VERSIONDATE=20150817
#export VERSION=5.4.17
#export VERSIONDATE=20150821
#export VERSION=5.4.18
#export VERSIONDATE=20150907
#export VERSION=6.0.36
#export VERSIONDATE=20180116
#export VERSION=6.0.37
#export VERSIONDATE=20180204
#export VERSION=6.0.38
#export VERSIONDATE=20180330
#export VERSION=6.0.40
#export VERSIONDATE=20180512
#export VERSION=6.0.41
#export VERSIONDATE=20180807
#export VERSION=6.0.42
#export VERSIONDATE=20180816
#export VERSION=6.0.43
#export VERSIONDATE=20180909
#export VERSION=6.0.45
#export VERSIONDATE=20190101
#export VERSION=6.0.46
#export VERSIONDATE=20190104
#export VERSION=6.0.47
#export VERSIONDATE=20190209
#export VERSION=6.0.48
#export VERSIONDATE=20190218
#export VERSION=6.0.49
#export VERSIONDATE=20190303
#export VERSION=6.0.50
#export VERSIONDATE=20190401
#export VERSION=6.0.51
#export VERSIONDATE=20190430
#export VERSION=6.0.52
#export VERSIONDATE=20190503
#export VERSION=6.0.53
#export VERSIONDATE=20190527
#export VERSION=6.0.54
#export VERSIONDATE=20190607
#export VERSION=6.0.55
#export VERSIONDATE=20190614
#export VERSION=6.0.56
#export VERSIONDATE=20190621
#export VERSION=6.1
#export VERSIONDATE=20190714
#export VERSION=6.1.01
#export VERSIONDATE=20190815
#export VERSION=6.1.02
#export VERSIONDATE=20190826
#export VERSION=6.1.03
#export VERSIONDATE=20190902
#export VERSION=6.1.04
#export VERSIONDATE=20190929
#export VERSION=6.1.05
#export VERSIONDATE=20191017
#export VERSION=6.1.07
#export VERSIONDATE=20191126
#export VERSION=6.1.08
#export VERSIONDATE=20191206
####sys/melder.h:554:59: error: missing terminating ' character
####melder/melder_templates.h:22:60: error: 'enable_if_t' in namespace 'std' does not name a template type
#export VERSION=6.1.09
#export VERSIONDATE=20200127
#export VERSION=6.1.10
#export VERSIONDATE=20200324
#export VERSION=6.1.11
#export VERSIONDATE=20200406
#export VERSION=6.1.12
#export VERSIONDATE=20200414
#export VERSION=6.1.13a
#export VERSIONDATE=20200420
#export VERSION=6.1.14
#export VERSIONDATE=20200503
#export VERSION=6.1.15
#export VERSIONDATE=20200521
#export VERSION=6.1.16
#export VERSIONDATE=20200607
#export VERSION=6.1.21
#export VERSIONDATE=20200921
#export VERSION=6.1.22
#export VERSIONDATE=20200925
#export VERSION=6.1.23
#export VERSIONDATE=20200929
#export VERSION=6.1.24
#export VERSIONDATE=20200929
#export VERSION=6.1.25
#export VERSIONDATE=20201005
#export VERSION=6.1.26
#export VERSIONDATE=20201006
#export VERSION=6.1.27
#export VERSIONDATE=20201014
#export VERSION=6.1.28
#export VERSIONDATE=20201021
#export VERSION=6.1.29
#export VERSIONDATE=20201028
#export VERSION=6.1.30
#export VERSIONDATE=20201103
#export VERSION=6.1.31
#export VERSIONDATE=20201111
#export VERSION=6.1.32
#export VERSIONDATE=20201116
#export VERSION=6.1.33
#export VERSIONDATE=20201120
#export VERSION=6.1.34
#export VERSIONDATE=20201126
#export VERSION=6.1.35
#export VERSIONDATE=20201130
#export VERSION=6.1.36
#export VERSIONDATE=20201207
#export VERSION=6.1.37
#export VERSIONDATE=20201217
#export VERSION=6.1.38
#export VERSIONDATE=20210103
#export VERSION=6.1.40
#export VERSIONDATE=20210228
#export VERSION=6.1.41
#export VERSIONDATE=20210329
#export VERSION=6.1.42
#export VERSIONDATE=20210417
#export VERSION=6.1.43
#export VERSIONDATE=20210514
#export VERSION=6.1.44
#export VERSIONDATE=20210519
#export VERSION=6.1.45
#export VERSIONDATE=20210521
#export VERSION=6.1.47
#export VERSIONDATE=20210522
#export VERSION=6.1.48
#export VERSIONDATE=20210603
#export VERSION=6.1.49
#export VERSIONDATE=20210613
#export VERSION=6.1.50
#export VERSIONDATE=20210622
#export VERSION=6.1.51
#export VERSIONDATE=20210623
#export VERSION=6.1.52
#export VERSIONDATE=20210826
#export VERSION=6.1.53
#export VERSIONDATE=20210909
#export VERSION=6.1.54
#export VERSIONDATE=20211010
#export VERSION=6.1.55
#export VERSIONDATE=20211026
#export VERSION=6.1.56
#export VERSIONDATE=20211104
#export VERSION=6.2
#export VERSIONDATE=20211116
#export VERSION=6.2.01
#export VERSIONDATE=20211118
#export VERSION=6.2.02
#export VERSIONDATE=20211203
#export VERSION=6.2.03
#export VERSIONDATE=20211204
#export VERSION=6.2.04
#export VERSIONDATE=20211219
#export VERSION=6.2.05
#export VERSIONDATE=20220106
#export VERSION=6.2.06
#export VERSIONDATE=20220122
#export VERSION=6.2.07
#export VERSIONDATE=20220129
#export VERSION=6.2.09
#export VERSIONDATE=20220217
#export VERSION=6.2.10
#export VERSIONDATE=20220318
#export VERSION=6.2.11
#export VERSIONDATE=20220409
#export VERSION=6.2.12
#export VERSIONDATE=20220418
#export VERSION=6.2.13
#export VERSIONDATE=20220519
#export VERSION=6.2.14
#export VERSIONDATE=20220524
#export VERSION=6.2.15
#export VERSIONDATE=20220815
#export VERSION=6.2.16
#export VERSIONDATE=20220819
#export VERSION=6.2.17
#export VERSIONDATE=20220824
#export VERSION=6.2.18
#export VERSIONDATE=20220912
#export VERSION=6.2.19
#export VERSIONDATE=20220913
#export VERSION=6.2.20
#export VERSIONDATE=20220925
#export VERSION=6.2.21
#export VERSIONDATE=20221002
#export VERSION=6.2.22a
#export VERSIONDATE=20221007
#export VERSION=6.2.23
#export VERSIONDATE=20221009
#export VERSION=6.3
#export VERSIONDATE=20221116
#export VERSION=6.3.01
#export VERSIONDATE=20221122
#export VERSION=6.3.02
#export VERSIONDATE=20221130
#export VERSION=6.3.03
#export VERSIONDATE=20221218
#export VERSION=6.3.04
#export VERSIONDATE=20230125
#export VERSION=6.3.05
#export VERSIONDATE=20230128
#export VERSION=6.3.06
#export VERSIONDATE=20230201
#export VERSION=6.3.07
#export VERSIONDATE=20230207
#export VERSION=6.3.08
#export VERSIONDATE=20230210
#export VERSION=6.3.09
#export VERSIONDATE=20230303
#export VERSION=6.3.10
#export VERSIONDATE=20230504
#export VERSION=6.3.11
#export VERSIONDATE=20230718
#export VERSION=6.3.12
#export VERSIONDATE=20230724
#export VERSION=6.3.13
#export VERSIONDATE=20230801
#export VERSION=6.3.15
#export VERSIONDATE=20230823
#export VERSION=6.3.16
#export VERSIONDATE=20230830
#export VERSION=6.3.17
#export VERSIONDATE=20230911
#export VERSION=6.3.18
#export VERSIONDATE=20231009
#export VERSION=6.3.19
#export VERSIONDATE=20231021
#export VERSION=6.3.20
#export VERSIONDATE=20231025
#export VERSION=6.4
#export VERSIONDATE=20231116
#export VERSION=6.4.01
#export VERSIONDATE=20231201
#export VERSION=6.4.02
#export VERSIONDATE=20231231
#export VERSION=6.4.03
#export VERSIONDATE=20240105
#export VERSION=6.4.04
#export VERSIONDATE=20240107
#export VERSION=6.4.05
#export VERSIONDATE=20240129
#export VERSION=6.4.06
#export VERSIONDATE=20240226
#export VERSION=6.4.07
#export VERSIONDATE=20240318
#export VERSION=6.4.08
#export VERSIONDATE=20240415
#export VERSION=6.4.09
#export VERSIONDATE=20240421
#export VERSION=6.4.10
#export VERSIONDATE=20240422
#export VERSION=6.4.11
#export VERSIONDATE=20240427
export VERSION=6.4.12
export VERSIONDATE=20240503
wl-showstatus --package-version
export DEPENDENCIES=
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=COPYING
export LICENSETYPE=
#export DOWNLOADURL="http://www.fon.hum.uva.nl/praat/download_sources.html praat _sources.tar.gz"
export DOWNLOADURL="https://github.com/praat/praat/releases"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
#export DOWNLOADSOURCEURL=http://www.fon.hum.uva.nl/praat/praat`echo $VERSION|sed -e "s/\.//g"`_sources.tar.gz
#export DOWNLOADSOURCEURL=https://github.com/praat/praat/archive/v$VERSION.tar.gz
#export DOWNLOADSOURCEURL=https://github.com/praat/praat/archive/refs/tags/$VERSION.tar.gz
export DOWNLOADSOURCEURL=https://github.com/praat/praat/archive/refs/tags/v$VERSION.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
mkdir -p $BASENAME-$VERSION
#tar xz --force-local -f $TARBALLDIR/$BASENAME/praat`echo $VERSION|sed -e "s/\.//g"`_sources.tar.gz -C$BASENAME-$VERSION
#mv $TARBALLDIR/$BASENAME/v$VERSION.tar.gz $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.gz
#tar xz --force-local -f $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.gz
tar xz --force-local -f $TARBALLDIR/$BASENAME/v$VERSION.tar.gz
#tar xz --force-local -f $TARBALLDIR/$BASENAME/$VERSION.tar.gz
#cd $BASENAME-$VERSION/sources_`echo $VERSION|sed -e "s/\.//g"`
cd $BASENAME-$VERSION
## fix missing __mingw_snwprintf in sys/melder.h (version >= 5.3.78 <= 6.0.38)
#mv sys/melder.h sys/melder.h.bak
#sed -e "s/__mingw_snwprintf/snwprintf/" sys/melder.h.bak > sys/melder.h
## fix missing LONG_MIN/LONG_MAX in sys/Graphics_image.cpp (version >= 5.3.78 <= 6.0.38)
#mv sys/Graphics_image.cpp sys/Graphics_image.cpp.bak
#echo "#include <limits.h>" > sys/Graphics_image.cpp
#cat sys/Graphics_image.cpp.bak >> sys/Graphics_image.cpp
## fix missing M_PI in external/espeak/klatt.cpp (version <= 6.0.38)
#mv external/espeak/klatt.cpp external/espeak/klatt.cpp.bak &&
#echo "#undef __STRICT_ANSI__" > external/espeak/klatt.cpp &&
#cat external/espeak/klatt.cpp.bak >> external/espeak/klatt.cpp
## fix missing M_PI in external/espeak/wavegen.cpp (version <= 6.0.38)
#mv external/espeak/wavegen.cpp external/espeak/wavegen.cpp.bak &&
#echo "#undef __STRICT_ANSI__" > external/espeak/wavegen.cpp &&
#cat external/espeak/wavegen.cpp.bak >> external/espeak/wavegen.cpp
## fix error: undefined named operand 'Data' (version >= 5.4.08 <= 6.0.38)
#sed -i.bak -e "s?^\(#define Data\)?//\1?" sys/winport_on.h
## fix math issues
#####error: '_hypot' was not declared in this scope
#mv external/espeak/compiledict.cpp external/espeak/compiledict.cpp.bak &&
#echo "#undef __STRICT_ANSI__" > external/espeak/compiledict.cpp &&
#cat external/espeak/compiledict.cpp.bak >> external/espeak/compiledict.cpp
## fix stray single quotes (version >= 6.0.45)
#for F in $(grep -li "0x[0-9A-F]\{4,4\}'[0-9A-F]\{4,4\}\|[0-9]'[0-9]\{3,3\}" $(find -name '*.h' -or -name '*.cpp')); do
# sed -i.bak -e "s/\(0x[0-9A-F]\{4,4\}\)'\([0-9A-F]\{1,4\}\)'\([0-9A-F]\{4,4\}\)'\([0-9A-F]\{4,4\}\)/\1\2\3\4/gi; s/\(0x[0-9A-F]\{1,4\}\)'\([0-9A-F]\{4,4\}\)/\1\2/gi; s/\(0x[0-9A-F]\{1,2\}\)'\([0-9A-F]\{2,2\}\)'\([0-9A-F]\{2,2\}\)/\1\2\3/gi; s/\([0-9]\)'\([0-9]\{3,3\}\)'\([0-9]\{3,3\}\)/\1\2/g; s/\([0-9]\)'\([0-9]\{3,3\}\)/\1\2/g" $F
#done
##sed -i.bak -e "s/\([0-9]\)'\([0-9]\{3,3\}\)/\1\2/g" melder/MelderString.h
#sed -i.bak2 -e "s/\([0-9]\)'\([0-9]\{3,3\}\)/\1\2/g" melder/melder_files.cpp
## fix missing enable_if_t in melder/melder_templates.h (version >= 6.1.08)
#sed -i.bak2 -e "s/enable_if_t/enable_if/" melder/melder_templates.h
## fix missing automatrix in fon/Photo.cpp (version >= 6.1.10)
#####fon/Photo.cpp:450:13: error: missing template arguments before 'z'
#patch -ulbf fon/Photo.cpp << EOF
#@@ -449,3 +449,3 @@
#        Graphics_setWindow (g, xmin, xmax, ymin, ymax);
#-       automatrix z = newmatrixraw <MelderColour> (iymax - (iymin - 1), ixmax - (ixmin - 1));
#+       automatrix<MelderColour> z = newmatrixraw <MelderColour> (iymax - (iymin - 1), ixmax - (ixmin - 1));
#        for (integer iy = iymin; iy <= iymax; iy ++) {
#EOF
# fix GCC 11 issues in melder/melder.h (version >= 6.1.42 <= 6.1.43)
#### bug reported: https://github.com/praat/praat/issues/1739
mv melder/melder.h melder/melder.h.bak &&
echo "#include <limits>" > melder/melder.h &&
cat melder/melder.h.bak >> melder/melder.h
# fix undefined getpid in sys/praat.cpp (version >= 6.3.10)
patch -ulbf sys/praat.cpp << EOF
@@ -1117,2 +1117,3 @@
 #ifdef _WIN32
+#define getpid() 0
        static void *theWinApplicationWindow;
EOF
# fix foned/SoundRecorder.cpp (version >= 6.4.07)
patch -ulbf foned/SoundRecorder.cpp << EOF
@@ -132,3 +132,3 @@
                win_waveInCheck (me);
-               if (! (Melder_debug == 8)
+               if (! (Melder_debug == 8) )
                        waveInReset (my hWaveIn);
EOF
#wl-showstatus configure &&
#cat > makefile.defs << EOF
#CC=${CC:-gcc} -std=gnu99
##CXX=${CXX:-g++} -std=c++11 -Wshadow
#CXX=${CXX:-g++} -std=c++14 -Wshadow
##CFLAGS=-DWINVER=0x0500 -D_WIN32_WINNT=0x0500 -D_WIN32_IE=0x0500 -DUNICODE -Dmain=wingwmain -O1
#CFLAGS=-DWINVER=0x0500 -D_WIN32_WINNT=0x0500 -D_WIN32_IE=0x0500 -DUNICODE -Dmain=wingwmain -O1 -D_FILE_OFFSET_BITS=64
#CXXFLAGS=\$(CFLAGS) -D_USE_MATH_DEFINES
#LINK=g++
#EXECUTABLE=Praat.exe
#LIBS=-lwinmm -lwsock32 -lcomctl32 -lole32 -lgdi32 -lgdiplus -lcomdlg32 -static-libgcc -static-libstdc++ -mwindows
#AR=ar
#RANLIB=ranlib
#WINDRES =windres
#ICON=praat_win.o
#MAIN_ICON=main/praat_win.o
#EOF
wl-showstatus configure &&
 ## create makefile.defs (version <= 6.4.03)
 #sed -e "s/^\(PREFIX\s*=\s*\).*$/\1/" makefiles/makefile.defs.mingw$(if ! ( echo $RUNPLATFORM | grep -q x86_64 ); then echo "32"; else echo "64"; fi) > makefile.defs &&
 # create makefile.defs (version >= 6.4.04)
 sed -e "s/^\(PREFIX\s*=\s*\).*$/\1/" makefiles/makefile.defs.msys-mingw$(if ! ( echo $RUNPLATFORM | grep -q x86_64 ); then echo "32"; else echo "64"; fi) > makefile.defs &&
 ## fix quotes in hex values (version >= 6.0.41)
 #sed -i.bak -e "s/\(0x[0-9a-fA-F]*\)'\([0-9a-fA-F]\{4\}\)'\([0-9a-fA-F]\{4\}\)'\([0-9a-fA-F]\{4\}\)/\1\2\3\4/g; s/\(0x\|[0-9]\)\([0-9a-fA-F]*\)'\([0-9a-fA-F]\{4\}\)/\1\2\3/g; s/\([0-9]\)'\([0-9]\{2\}\)/\1\2/g" $(grep -l "0x[0-9a-fA-F]\{0,4\}\('[0-9a-fA-F]\{4\}\)\|[0-9]'[0-9]\{3\}" $(find -name '*.[hc]' -or -name '*.[hc]pp'))
 # fix makefile.defs for building with clang
 sed -i.bak -e "s/^LIBS = /&-pthread /" makefile.defs
 wl-showstatus build &&
 #make &&
 make CC=${CC:-gcc} CXX=${CXX:-g++} AR=${AR:-ar} RANLIB=${RANLIB:-ranlib} WINDRES=${WINDRES:-windres} &&
 strip *.exe &&
 wl-showstatus build-install &&
 mkdir -p $INSTALLPREFIX/bin &&
 cp -f *.exe $INSTALLPREFIX/bin/ &&
 #wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd ../.. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION



