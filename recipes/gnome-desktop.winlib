#export NAME="gnome-desktop"
#export STATUS=
#export URL=http://www.gnome.org/projects/gnome-desktop
#export BASENAME=gnome-desktop
#export DESCRIPTION=""
#export CATEGORY=
#export TYPE=library
##export VERSION=2.32.0
##export VERSIONDATE=20101008
##export VERSION=2.32.1
##export VERSIONDATE=20101017
##export VERSION=3.0.0
##export VERSIONDATE=20110405
##export VERSION=3.0.1
##export VERSIONDATE=20110426
##export VERSION=3.0.2
##export VERSIONDATE=20110524
##export VERSION=3.1.1
##export VERSIONDATE=20110509
##export VERSION=3.1.2
##export VERSIONDATE=20110614
##export VERSION=3.1.3
##export VERSIONDATE=20110712
##export VERSION=3.1.4
##export VERSIONDATE=20110725
#####libgnome-desktop/gnome-bg.c:1: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'gdk_x11_get_xatom_by_name'
##export VERSION=3.1.5
##export VERSIONDATE=20110813
##export VERSION=3.2.0
##export VERSIONDATE=20110926
##export VERSION=3.2.1
##export VERSIONDATE=20111016
##export VERSION=3.3.1
##export VERSIONDATE=20111024
##export VERSION=3.3.2
##export VERSIONDATE=20111121
##export VERSION=3.3.4
##export VERSIONDATE=20120117
##export VERSION=3.3.5
##export VERSIONDATE=20120206
##export VERSION=3.3.90
##export VERSIONDATE=20120221
##export VERSION=3.3.91
##export VERSIONDATE=20120305
##export VERSION=3.3.92
##export VERSIONDATE=20120319
#####desktop-docs/fdl/: raise NotImplementedError
##export VERSION=3.4.0
##export VERSIONDATE=20120326
##export VERSION=3.4.1
##export VERSIONDATE=20120416
##export VERSION=3.4.2
##export VERSIONDATE=20120514
##export DEPENDENCIES=gsettings-desktop-schemas,libxrandr,libx11
##export VERSION=3.5.2
##export VERSIONDATE=20120605
##export VERSION=3.5.3
##export VERSIONDATE=20120626
##export VERSION=3.5.4
##export VERSIONDATE=20120717
##export VERSION=3.5.5
##export VERSIONDATE=20120807
##export VERSION=3.5.91
##export VERSIONDATE=20120905
##export VERSION=3.6.0
##export VERSIONDATE=20120924
##export VERSION=3.6.0.1
##export VERSIONDATE=20120927
#####No package 'xkeyboard-config' found
##export VERSION=3.6.1
##export VERSIONDATE=20121018
##export VERSION=3.6.2
##export VERSIONDATE=20121113
#####libgnome-desktop/gnome-bg-crossfade.c:377: undefined reference to `GDK_WINDOW_XDISPLAY'
#####libgnome-desktop/gnome-rr.c:804: undefined reference to `gdk_x11_window_get_xid'
#####libgnome-desktop/gnome-rr.c:806: undefined reference to `gdk_x11_screen_get_xscreen'
#####libgnome-desktop/gnome-rr.c:1132: undefined reference to `gdk_x11_display_grab'
#####libgnome-desktop/gnome-rr.c:1137: undefined reference to `gdk_x11_display_ungrab'
#####libgnome-desktop/gnome-rr.c:758: undefined reference to `gdk_x11_register_standard_event_type'
#####libgnome-desktop/gnome-rr-config.c:1472: undefined reference to `gnome_rr_output_get_name'
#####libgnome-desktop/gnome-rr-config.c:517: undefined reference to `gnome_rr_output_get_name'
#####libgnome-desktop/gnome-rr-config.c:1900: undefined reference to `gdk_x11_display_grab'
#####libgnome-desktop/gnome-rr-config.c:1964: undefined reference to `gdk_x11_display_ungrab'
#####libgnome-desktop/gnome-rr-config.c:1964: undefined reference to `gdk_x11_display_ungrab'
##export VERSION=3.6.3
##export VERSIONDATE=20130317
#####libgnome-desktop/gnome-bg-crossfade.c:382: undefined reference to `_gdk_x11_get_xatom_by_name'
#####libgnome-desktop/gnome-rr.c:805: undefined reference to `_gdk_x11_window_get_xid'
#####libgnome-desktop/gnome-rr.c:807: undefined reference to `_gdk_x11_screen_get_xscreen'
##export VERSION=3.7.1
##export VERSIONDATE=20121026
##export VERSION=3.7.2
##export VERSIONDATE=20121120
##export VERSION=3.7.3
##export VERSIONDATE=20121221
##export VERSION=3.7.4
##export VERSIONDATE=20130115
##export VERSION=3.7.5
##export VERSIONDATE=20130206
##export VERSION=3.8.0
##export VERSIONDATE=20130327
##export VERSION=3.8.0.1
##export VERSIONDATE=20130328
##export VERSION=3.8.1
##export VERSIONDATE=20130416
##export VERSION=3.8.2
##export VERSIONDATE=20130514
##export VERSION=3.8.3
##export VERSIONDATE=20130608
##export VERSION=3.8.4
##export VERSIONDATE=20130904
##export VERSION=3.9.1.1
##export VERSIONDATE=20130530
##export VERSION=3.9.5
##export VERSIONDATE=20130730
#####libgnome-desktop/gnome-rr-config.c:1883:5: error: implicit declaration of function 'gdk_x11_display_grab' [-Werror=implicit-function-declaration]
##export VERSION=3.10.0
##export VERSIONDATE=20130924
##export VERSION=3.10.1
##export VERSIONDATE=20131016
##export VERSION=3.10.2
##export VERSIONDATE=20131121
##export VERSION=3.11.1
##export VERSIONDATE=20131030
##export VERSION=3.11.2
##export VERSIONDATE=20131122
##export VERSION=3.11.4
##export VERSIONDATE=20140116
##export VERSION=3.11.5
##export VERSIONDATE=20140204
#####libgnome-desktop/gnome-bg.c:1175:2: error: implicit declaration of function 'XOpenDisplay' [-Werror=implicit-function-declaration]
##export VERSION=3.12.0
##export VERSIONDATE=20140324
##export VERSION=3.12.1
##export VERSIONDATE=20140418
#####libgnome-desktop/gnome-wall-clock.c:28:22: fatal error: langinfo.h: No such file or directory
##export VERSION=3.12.2
##export VERSIONDATE=20140514
#####libgnome-desktop/gnome-idle-monitor.c:209:15: error: implicit declaration of function 'gdk_x11_device_get_id' [-Werror=implicit-function-declaration]
##export VERSION=3.13.1
##export VERSIONDATE=20140502
##export VERSION=3.13.2
##export VERSIONDATE=20140529
##export VERSION=3.13.3
##export VERSIONDATE=20140627
##export VERSION=3.13.4
##export VERSIONDATE=20140724
##export VERSION=3.14.0
##export VERSIONDATE=20140923
#####libgnome-desktop/libgsystem/gsystem-file-utils.c:58:14: error: 'EINTR' undeclared (first use in this function)
##export VERSION=3.14.1
##export VERSIONDATE=20141015
##export VERSION=3.14.2
##export VERSIONDATE=20141113
##export VERSION=3.15.1
##export VERSIONDATE=20141030
##export VERSION=3.15.2
##export VERSIONDATE=20141125
##export VERSION=3.15.2.1
##export VERSIONDATE=20141205
##export VERSION=3.15.3
##export VERSIONDATE=20141215
##export VERSION=3.15.4
##export VERSIONDATE=20150121
#####libgnome-desktop/gnome-rr.c:1676:1: error: invalid storage class for function 'gnome_rr_rotation_from_transform'
##export VERSION=3.16.0
##export VERSIONDATE=20150323
##export VERSION=3.16.1
##export VERSIONDATE=20150415
##export VERSION=3.16.2
##export VERSIONDATE=20150512
##export VERSION=3.17.2
##export VERSIONDATE=20150527
##export VERSION=3.17.3
##export VERSIONDATE=20150624
##export VERSION=3.17.4
##export VERSIONDATE=20150721
##export VERSION=3.18.0
##export VERSIONDATE=20150922
##export VERSION=3.18.1
##export VERSIONDATE=20151013
##export VERSION=3.18.2
##export VERSIONDATE=20151110
##export VERSION=3.19.1
##export VERSIONDATE=20151031
##export VERSION=3.19.2
##export VERSIONDATE=20151127
##export VERSION=3.19.3
##export VERSIONDATE=20151216
##export VERSION=3.19.4
##export VERSIONDATE=20160216
##export VERSION=3.19.92
##export VERSIONDATE=20160314
##export VERSION=3.20.0
##export VERSIONDATE=20160322
#####Requested 'gdk-pixbuf-2.0 >= 2.33.0' but version of GdkPixbuf is 2.32.3
##export VERSION=3.20.1
##export VERSIONDATE=20160411
##export VERSION=3.20.2
##export VERSIONDATE=20160510
##export VERSION=3.21.1
##export VERSIONDATE=20160427
##export VERSION=3.21.2
##export VERSIONDATE=20160525
##export VERSION=3.21.3
##export VERSIONDATE=20160621
##export VERSION=3.21.4
##export VERSIONDATE=20160725
##export VERSION=3.22.0
##export VERSIONDATE=20160920
##export VERSION=3.22.1
##export VERSIONDATE=20161011
##export VERSION=3.22.2
##export VERSIONDATE=20161108
##export VERSION=3.23.1
##export VERSIONDATE=20161025
##export VERSION=3.23.2
##export VERSIONDATE=20161122
##export VERSION=3.23.3
##export VERSIONDATE=20161213
##export VERSION=3.24.0
##export VERSIONDATE=20170321
##export VERSION=3.24.1
##export VERSIONDATE=20170409
##export VERSION=3.24.2
##export VERSIONDATE=20170509
##export VERSION=3.25.1
##export VERSIONDATE=20170425
##export VERSION=3.25.2
##export VERSIONDATE=20170523
##export VERSION=3.25.3
##export VERSIONDATE=20170620
#####Requested 'gdk-pixbuf-2.0 >= 2.36.5' but version of GdkPixbuf is 2.36.3
#####Requested 'glib-2.0 >= 2.53.0' but version of GLib is 2.50.2
#####Requested 'gio-2.0 >= 2.53.0' but version of GIO is 2.50.2
##export VERSION=3.25.4
##export VERSIONDATE=20170720
##export VERSION=3.26.0
##export VERSIONDATE=20170912
##export VERSION=3.26.1
##export VERSIONDATE=20171003
##export VERSION=3.26.2
##export VERSIONDATE=20171101
##export VERSION=3.27.1
##export VERSIONDATE=20171021
##export VERSION=3.27.2
##export VERSIONDATE=20171114
##export VERSION=3.28.0
##export VERSIONDATE=20180313
##export VERSION=3.28.1
##export VERSIONDATE=20180411
##export VERSION=3.28.2
##export VERSIONDATE=20180510
#####Requested 'gsettings-desktop-schemas >= 3.27.0' but version of gsettings-desktop-schemas is 3.24.1
##export VERSION=3.29.1
##export VERSIONDATE=20180417
##export VERSION=3.29.3
##export VERSIONDATE=20180620
##export VERSION=3.29.4
##export VERSIONDATE=20180721
##export VERSION=3.30.0
##export VERSIONDATE=20180904
##export VERSION=3.30.1
##export VERSIONDATE=20180926
##export VERSION=3.30.2
##export VERSIONDATE=20181028
#export VERSION=3.30.2.2
#export VERSIONDATE=20190424
#export DEPENDENCIES=gtk3,gsettings-desktop-schemas,libx11,libxrandr,xkeyboard-config,iso-codes
#export OPTIONALDEPENDENCIES=
#export BUILDDEPENDENCIES=itstool
#export OPTIONALBUILDDEPENDENCIES=
##export VERSION=3.31.1
##export VERSIONDATE=20181010
##export VERSION=3.31.2
##export VERSIONDATE=20181115
##export VERSION=3.31.3
##export VERSIONDATE=20181212
##export VERSION=3.31.4
##export VERSIONDATE=20190109
##export VERSION=3.32.0
##export VERSIONDATE=20190312
##export VERSION=3.32.1
##export VERSIONDATE=20190412
##export VERSION=3.32.1.2
##export VERSIONDATE=20190424
##export VERSION=3.32.2
##export VERSIONDATE=20190507
##export VERSION=3.33.1
##export VERSIONDATE=20190426
##export VERSION=3.33.2
##export VERSIONDATE=20190523
##export VERSION=3.33.3
##export VERSIONDATE=20190619
##export VERSION=3.33.4
##export VERSIONDATE=20190720
##export VERSION=3.34.0
##export VERSIONDATE=20190910
##export VERSION=3.34.1
##export VERSIONDATE=20191008
##export VERSION=3.34.2
##export VERSIONDATE=20191204
##export VERSION=3.34.3
##export VERSIONDATE=20200109
##export VERSION=3.34.4
##export VERSIONDATE=20200218
##export VERSION=3.34.5
##export VERSIONDATE=20200401
##export VERSION=3.34.6
##export VERSIONDATE=20200430
##export VERSION=3.34.7
##export VERSIONDATE=20200605
##export VERSION=3.34.8
##export VERSIONDATE=20200815
##export VERSION=3.35.1
##export VERSIONDATE=20191018
##export VERSION=3.35.2
##export VERSIONDATE=20191125
##export VERSION=3.35.3
##export VERSIONDATE=20200106
##export VERSION=3.35.4
##export VERSIONDATE=20200115
##export VERSION=3.36.0
##export VERSIONDATE=20200311
##export VERSION=3.36.1
##export VERSIONDATE=20200401
##export VERSION=3.36.2
##export VERSIONDATE=20200429
##export VERSION=3.36.3.1
##export VERSIONDATE=20200615
##export VERSION=3.36.4
##export VERSIONDATE=20200708
##export VERSION=3.36.5
##export VERSIONDATE=20200811
##export VERSION=3.36.6
##export VERSIONDATE=20200909
##export VERSION=3.36.7
##export VERSIONDATE=20201007
##export VERSION=3.36.8
##export VERSIONDATE=20201125
##export VERSION=3.36.9
##export VERSIONDATE=20210109
##export VERSION=3.37.1
##export VERSIONDATE=20200428
##export VERSION=3.37.2
##export VERSIONDATE=20200606
##export VERSION=3.37.3
##export VERSIONDATE=20200707
##export VERSION=3.38.0
##export VERSIONDATE=20200914
##export VERSION=3.38.1
##export VERSIONDATE=20201006
##export VERSION=3.38.2
##export VERSIONDATE=20201125
##export VERSION=3.38.3
##export VERSIONDATE=20210109
##export VERSION=3.38.4
##export VERSIONDATE=20210216
##export VERSION=3.38.6
##export VERSIONDATE=20210504
##export VERSION=3.38.7
##export VERSIONDATE=20210608
##export VERSION=3.38.8
##export VERSIONDATE=20210714
##export VERSION=40.0
##export VERSIONDATE=20210323
#####libgnome-desktop\meson.build:98:6: ERROR:  Program(s) ['g-ir-scanner'] not found or not executable
#wl-showstatus --package-version
##export DEPENDENCIES=gtk3,gsettings-desktop-schemas,libx11,libxrandr,xkeyboard-config,iso-codes,gobject-introspection
##export OPTIONALDEPENDENCIES=
##export BUILDDEPENDENCIES=meson,itstool
##export OPTIONALBUILDDEPENDENCIES=
#export LICENSEFILE=COPYING
#export LICENSETYPE="GPL/FDL"
#export DOWNLOADURL="http://ftp.gnome.org/pub/GNOME/sources/gnome-desktop/"
#export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
##export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/$BASENAME/`echo $VERSION|sed 's/^\([0-9]*\.[0-9]*\)\..*$/\1/'`/$BASENAME-$VERSION.tar.bz2
#export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/$BASENAME/$(echo $VERSION|sed 's/^\([0-9]*\.[0-9]*\)\..*$/\1/')/$BASENAME-$VERSION.tar.xz
##export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/$BASENAME/$(echo $VERSION|sed 's/^\([0-9]*\)\..*$/\1/')/$BASENAME-$VERSION.tar.xz
#wl-showstatus download
#wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
#wl-wait4deps
##tar xfj $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.bz2
#tar xfJ $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.xz
#cd $BASENAME-$VERSION
## fix missing gdk/gdkx.h
#mkdir -p gdk
#cat > gdk/gdkx.h << EOF
#////fix error: /include/w32api/winspool.h:255: error: two or more data types in declaration specifiers
#//#undef Status
#//#include <windows.h>
##include <gdk/gdkwin32.h>
#//#include <X11/X.h>
#//#include <X11/Xlib.h>
##define GDK_WINDOW_XID(dw) (int)GDK_WINDOW_HWND(dw)
##define GDK_DISPLAY_XDISPLAY(d) gdk_display_get_default_screen(d)
##define GDK_SCREEN_XDISPLAY(d) gdk_display_get_default_screen(d)
##define GDK_WINDOW_XDISPLAY(win) win
#EOF
## fix conflicting definition of interface in libgnome-desktop/edid.h
#patch -ulbf libgnome-desktop/edid.h << EOF
#--- libgnome-desktop/edid.h  2010-03-27 12:34:40 +0100
#+++ libgnome-desktop/edid.h  2010-11-17 17:39:44 +0100
#@@ -26,2 +26,5 @@
# #define EDID_H
#+#ifdef interface
#+#undef interface
#+#endif
#
#EOF
### fix libgnome-desktop/gnome-rr.c
##patch -ulbf libgnome-desktop/gnome-rr.c << EOF
##--- libgnome-desktop/gnome-rr.c  2010-10-04 23:32:20 +0200
##+++ libgnome-desktop/gnome-rr.c  2011-02-05 23:25:22 +0100
##@@ -806,2 +806,5 @@
## {
##+#ifdef _WIN32
##+    return FALSE;
##+#else
##     GnomeRRCrtc *crtc;
##@@ -847,2 +850,3 @@
##     return timestamp_updated;
##+#endif
## }
##EOF
### fix libgnome-desktop/gnome-rr.c
##mv libgnome-desktop/gnome-rr.c libgnome-desktop/gnome-rr.c.bak
##echo "#include <windows.h>" > libgnome-desktop/gnome-rr.c
###echo "#include <X11/extensions/Xrandr.h>" >> libgnome-desktop/gnome-rr.c
##cat libgnome-desktop/gnome-rr.c.bak >> libgnome-desktop/gnome-rr.c
## fix libgnome-desktop/gnome-bg.c
#mv libgnome-desktop/gnome-bg.c libgnome-desktop/gnome-bg.c.bak
#cat > libgnome-desktop/gnome-bg.c << EOF
#//inline GdkAtom gdk_x11_get_xatom_by_name(const gchar* n) { return gdk_atom_intern(n, FALSE); }
##define gdk_x11_get_xatom_by_name(n) gdk_atom_intern(n, FALSE)
##define GDK_WINDOW_XWINDOW(win) win
##define GDK_WINDOW_XDISPLAY(win) win
##define GDK_VISUAL_XVISUAL(vis) vis
##define gdk_x11_display_grab(d)
##define gdk_x11_display_ungrab(d)
#EOF
#cat libgnome-desktop/gnome-bg.c.bak >> libgnome-desktop/gnome-bg.c
### fix libgnome-desktop/libgsystem/gsystem-file-utils.c (cersion <= 3.12.1)
##patch -ulbf libgnome-desktop/libgsystem/gsystem-file-utils.c << EOF
##--- libgnome-desktop/libgsystem/gsystem-file-utils.c  2012-08-27 23:30:50 +0200
##+++ libgnome-desktop/libgsystem/gsystem-file-utils.c  2012-10-18 23:22:06 +0200
##@@ -27,4 +27,8 @@
## #include <glib/gstdio.h>
##+#ifdef __MINGW32__
##+#include <fcntl.h>
##+#else
## #include <gio/gunixinputstream.h>
## #include <glib-unix.h>
##+#endif
##
##@@ -82,3 +86,7 @@
##
##+#ifdef __MINGW32__
##+  return g_win32_input_stream_new (fd, TRUE);
##+#else
##   return g_unix_input_stream_new (fd, TRUE);
##+#endif
## }
##EOF
### fix libgnome-desktop/libgsystem/gsystem-file-utils.c (cersion >= 3.13.1 <= 3.14.2)
##patch -ulbf libgnome-desktop/libgsystem/gsystem-file-utils.c << EOF
##--- libgnome-desktop/libgsystem/gsystem-file-utils.c  2014-05-02 15:06:06 +0200
##+++ libgnome-desktop/libgsystem/gsystem-file-utils.c  2014-05-02 20:10:30 +0200
##@@ -33,2 +33,6 @@
## #include <glib/gstdio.h>
##+#ifdef __MINGW32__
##+#include <fcntl.h>
##+#include <glib/gwin32.h>
##+#else
## #include <gio/gunixinputstream.h>
##@@ -37,2 +41,3 @@
## #include <glib-unix.h>
##+#endif
## #include <limits.h>
##@@ -162,3 +167,7 @@
##
##+#ifdef __MINGW32__
##+  return g_win32_input_stream_new (fd, TRUE);
##+#else
##   return g_unix_input_stream_new (fd, TRUE);
##+#endif
## }
##EOF
## fix missing gdk_x11_get_xatom_by_name in libgnome-desktop/gnome-bg-crossfade.c (version >= 3.8.0.1)
#mv libgnome-desktop/gnome-bg-crossfade.c libgnome-desktop/gnome-bg-crossfade.c.bak
#cat > libgnome-desktop/gnome-bg-crossfade.c << EOF
##define gdk_x11_get_xatom_by_name(n) gdk_atom_intern(n, FALSE)
#EOF
#cat libgnome-desktop/gnome-bg-crossfade.c.bak >> libgnome-desktop/gnome-bg-crossfade.c
## fix missing scandir in libgnome-desktop/gnome-languages.c (version >= 3.8.3)
#patch -ulbf libgnome-desktop/gnome-languages.c << EOF
#--- libgnome-desktop/gnome-languages.c  2013-03-17 02:49:54 +0100
#+++ libgnome-desktop/gnome-languages.c  2013-07-17 11:27:56 +0200
#@@ -616,2 +616,3 @@
#         gboolean found_locales = FALSE;
#+#ifndef _WIN32
#         struct dirent **dirents;
#@@ -630,2 +631,3 @@
#         }
#+#endif
#         return found_locales;
#EOF
### fix already defined interface in libgnome-desktop/meta-dbus-idle-monitor.c (version >= 3.13.1)
##patch -ulbf libgnome-desktop/meta-dbus-idle-monitor.c << EOF
##--- libgnome-desktop/meta-dbus-idle-monitor.c  2014-05-02 15:06:38 +0200
##+++ libgnome-desktop/meta-dbus-idle-monitor.c  2014-05-02 19:59:34 +0200
##@@ -1758,5 +1758,5 @@
## static void
##-meta_dbus_object_notify (GDBusObject *object, GDBusInterface *interface)
##+meta_dbus_object_notify (GDBusObject *object, GDBusInterface *iface)
## {
##-  _ExtendedGDBusInterfaceInfo *info = (_ExtendedGDBusInterfaceInfo *) g_dbus_interface_get_info (interface);
##+  _ExtendedGDBusInterfaceInfo *info = (_ExtendedGDBusInterfaceInfo *) g_dbus_interface_get_info (iface);
##   /* info can be NULL if the other end is using a D-Bus interface we don't know
##@@ -1819,3 +1819,3 @@
##   MetaDBusObjectProxy *object = META_DBUS_OBJECT_PROXY (gobject);
##-  GDBusInterface *interface;
##+  GDBusInterface *iface;
##
##@@ -1824,4 +1824,4 @@
##     case 1:
##-      interface = g_dbus_object_get_interface (G_DBUS_OBJECT (object), "org.gnome.Mutter.IdleMonitor");
##-      g_value_take_object (value, interface);
##+      iface = g_dbus_object_get_interface (G_DBUS_OBJECT (object), "org.gnome.Mutter.IdleMonitor");
##+      g_value_take_object (value, iface);
##       break;
##@@ -1905,3 +1905,3 @@
##   MetaDBusObjectSkeleton *object = META_DBUS_OBJECT_SKELETON (gobject);
##-  GDBusInterfaceSkeleton *interface;
##+  GDBusInterfaceSkeleton *iface;
##
##@@ -1910,7 +1910,7 @@
##     case 1:
##-      interface = g_value_get_object (value);
##-      if (interface != NULL)
##+      iface = g_value_get_object (value);
##+      if (iface != NULL)
##         {
##-          g_warn_if_fail (META_DBUS_IS_IDLE_MONITOR (interface));
##-          g_dbus_object_skeleton_add_interface (G_DBUS_OBJECT_SKELETON (object), interface);
##+          g_warn_if_fail (META_DBUS_IS_IDLE_MONITOR (iface));
##+          g_dbus_object_skeleton_add_interface (G_DBUS_OBJECT_SKELETON (object), iface);
##         }
##@@ -1935,3 +1935,3 @@
##   MetaDBusObjectSkeleton *object = META_DBUS_OBJECT_SKELETON (gobject);
##-  GDBusInterface *interface;
##+  GDBusInterface *iface;
##
##@@ -1940,4 +1940,4 @@
##     case 1:
##-      interface = g_dbus_object_get_interface (G_DBUS_OBJECT (object), "org.gnome.Mutter.IdleMonitor");
##-      g_value_take_object (value, interface);
##+      iface = g_dbus_object_get_interface (G_DBUS_OBJECT (object), "org.gnome.Mutter.IdleMonitor");
##+      g_value_take_object (value, iface);
##       break;
##EOF
## fix missing langinfo.h (version >= 3.12.0)
#echo "#define nl_langinfo(item) NULL" > langinfo.h
##cat > langinfo.h << EOF
###include <locale.h>
###define locale_t _locale_t
###define newlocale(dummycat,l,dummyloc) _create_locale(LC_ALL,l)
###define setlocale uselocale
###define freelocale _free_locale
##define nl_langinfo(codeset) "UTF-8"
##EOF
## fix missing gdk_x11_device_get_id in libgnome-desktop/gnome-idle-monitor.c (version >= 3.16.0)
#mv libgnome-desktop/gnome-idle-monitor.c libgnome-desktop/gnome-idle-monitor.c.bak
#echo "#define gdk_x11_device_get_id(dev) 0" > libgnome-desktop/gnome-idle-monitor.c
##cat libgnome-desktop/gnome-idle-monitor.c.bak >> libgnome-desktop/gnome-idle-monitor.c
#sed -e "s?^\(G_STATIC_ASSERT\)?//\1?" libgnome-desktop/gnome-idle-monitor.c.bak >> libgnome-desktop/gnome-idle-monitor.c
## fix missing gdk_x11_device_get_id in libgnome-desktop/test-idle-monitor.c (version >= 3.16.0)
#mv libgnome-desktop/test-idle-monitor.c libgnome-desktop/test-idle-monitor.c.bak
#echo "#define gdk_x11_device_get_id(dev) 0" > libgnome-desktop/test-idle-monitor.c
#cat libgnome-desktop/test-idle-monitor.c.bak >> libgnome-desktop/test-idle-monitor.c
## fix format issue in libgnome-desktop/gnome-desktop-thumbnail.c (version >= 3.16.2)
#patch -ulbf libgnome-desktop/gnome-desktop-thumbnail.c << EOF
#--- libgnome-desktop/gnome-desktop-thumbnail.c  2015-02-16 15:24:26.000000000 +0100
#+++ libgnome-desktop/gnome-desktop-thumbnail.c  2015-05-12 14:20:39.199089500 +0200
#@@ -1506,3 +1506,3 @@
#
#-  g_snprintf (mtime_str, 21, "%ld",  mtime);
#+  g_snprintf (mtime_str, 21, "%ld",  (long)mtime);
#   width = gdk_pixbuf_get_option (pixbuf, "tEXt::Thumb::Image::Width");
#EOF
## fix libgnome-desktop/gnome-languages.c on older MinGW (version >= 3.20.1)
#mv libgnome-desktop/gnome-languages.c libgnome-desktop/gnome-languages.c.bak
#cat > libgnome-desktop/gnome-languages.c << EOF
##include <dirent.h>
##ifndef DTTOIF
##define DTTOIF(type) (type)
##endif
#EOF
#cat libgnome-desktop/gnome-languages.c.bak >> libgnome-desktop/gnome-languages.c
## avoid missing F_SETFD libgnome-desktop/gnome-desktop-thumbnail-script.c (version >= 3.26.0)
#patch -ulbf libgnome-desktop/gnome-desktop-thumbnail-script.c << EOF
#@@ -32,5 +32,7 @@
# #include <stdlib.h>
# #include <sys/stat.h>
#+#ifndef _WIN32
# #include <fcntl.h>
#+#endif
#
# #ifdef ENABLE_SECCOMP
#@@ -647,7 +649,9 @@
#     return;
#
#+#ifndef _WIN32
#   /* Otherwise, mark not - close-on-exec all the fds in the array */
#   for (i = 0; i < fd_array->len; i++)
#     fcntl (g_array_index (fd_array, int, i), F_SETFD, 0);
#+#endif
# }
#
#EOF
## fix missing gio-unix in configure (version >= 3.30.0)
#sed -i.bak2 -e "s/gio-unix/gio-windows/g" configure
#wl-showstatus configure &&
### fix building DLLs on 64-bit
##if ( echo $RUNPLATFORM | grep -q x86_64 ); then
## autoreconf -f -i -I m4 -I $MINGWPREFIX/share/aclocal
##fi &&
## fix problem detecting GNU gettext tools on 64-bit
#if ( echo $RUNPLATFORM | grep -q x86_64 ); then
# mv configure configure.bak &&
# sed -e "s/as_fn_error\(.*GNU gettext tools not found; required for intltool\)/as_echo\1/" configure.bak > configure
#fi &&
##INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM LDFLAGS="-no-undefined -Wl,-no-undefined" &&
##INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --without-x --with-x=no --enable-introspection=no LDFLAGS="-no-undefined -Wl,-no-undefined" &&
##INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --without-x --with-x=no --enable-introspection=no --disable-scrollkeeper LDFLAGS="-Wl,-no-undefined" &&
##INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --disable-shared --without-x --with-x=no --enable-introspection=no --disable-scrollkeeper --disable-desktop-docs LDFLAGS="-Wl,-no-undefined" &&
##INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --without-x --with-x=no --enable-introspection=no --disable-scrollkeeper --disable-desktop-docs LDFLAGS="-Wl,-no-undefined" &&
##INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PATH=$PATH:$PERLDIR/../c/bin PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --without-x --with-x=no --enable-introspection=no --disable-scrollkeeper --disable-desktop-docs LDFLAGS="-Wl,-no-undefined" &&
##INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PATH=$PATH:$PERLDIR/../c/bin PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --without-x --with-x=no --enable-introspection=no --disable-scrollkeeper --disable-desktop-docs LDFLAGS="-Wl,-no-undefined" &&
#INTLTOOL_PERL="$PERLDIR/bin/perl.exe" PATH=$PATH:$PERLDIR/../c/bin PYTHON=$PYDIR/python.exe ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --enable-static --enable-shared --without-x --with-x=no --disable-introspection --disable-scrollkeeper --disable-udev --disable-desktop-docs LDFLAGS="-Wl,-no-undefined" &&
# wl-showstatus build-install &&
# #echo "#undef HAVE_RANDR" >> config.h &&
# ## fix error: /include/w32api/winspool.h:255: error: two or more data types in declaration specifiers (version <= 3.14.2)
# #mv config.h config.h.bak &&
# #echo "#include <windows.h>" > config.h &&
# #cat config.h.bak >> config.h &&
# ## undefine G_OS_UNIX and define G_OS_WIN32 (version >= 3.13.1)
# #echo "#undef G_OS_UNIX" >> config.h &&
# #echo "#define G_OS_WIN32" >> config.h &&
# ## fix missing -lrt (version <= 3.14.2)
# #mv libgnome-desktop/Makefile libgnome-desktop/Makefile.bak &&
# #sed -e "s/-lrt//" libgnome-desktop/Makefile.bak > libgnome-desktop/Makefile &&
# ( make install-strip || make install-strip WARN_CFLAGS= ) &&
# wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && rm -rf $BASENAME-$VERSION



export NAME="GNOME Desktop"
export STATUS=
export URL=http://www.gnome.org/projects/gnome-desktop
export BASENAME=gnome-desktop
export DESCRIPTION="GNOME Desktop"
export CATEGORY=
export TYPE=library
#export VERSION=40.0
#export VERSIONDATE=20210323
#export VERSION=40.1
#export VERSIONDATE=20210503
#export VERSION=40.2
#export VERSIONDATE=20210610
#export VERSION=40.3
#export VERSIONDATE=20210715
#export VERSION=40.4
#export VERSIONDATE=20210819
#export VERSION=40.5
#export VERSIONDATE=20211103
#export VERSION=40.6
#export VERSIONDATE=20211206
#export VERSION=40.7
#export VERSIONDATE=20220111
#export VERSION=41.0
#export VERSIONDATE=20210819
#export VERSION=41.1
#export VERSIONDATE=20211103
#export VERSION=41.2
#export VERSIONDATE=20211208
#export VERSION=41.3
#export VERSIONDATE=20220112
#export VERSION=41.4
#export VERSIONDATE=20220321
#export VERSION=41.6
#export VERSIONDATE=20220428
####libgnome-desktop/gnome-gettext-portable.c:36:1: error: unknown type name 'locale_t'
#wl-showstatus --package-version
#export DEPENDENCIES=gtk3,gsettings-desktop-schemas,libx11,libxrandr,xkeyboard-config,iso-codes,gobject-introspection
#export OPTIONALDEPENDENCIES=
#export BUILDDEPENDENCIES=meson,itstool
#export OPTIONALBUILDDEPENDENCIES=
#export VERSION=42.0
#export VERSIONDATE=20220321
#export VERSION=42.1
#export VERSIONDATE=20220428
#export VERSION=42.2
#export VERSIONDATE=20220602
#export VERSION=42.3
#export VERSIONDATE=20220712
#export VERSION=42.4
#export VERSIONDATE=20220808
#export VERSION=42.5
#export VERSIONDATE=20220927
#export VERSION=42.6
#export VERSIONDATE=20221025
#export VERSION=42.7
#export VERSIONDATE=20221206
#export VERSION=42.8
#export VERSIONDATE=20230110
#export VERSION=43
#export VERSIONDATE=20220918
#export VERSION=43.1
#export VERSIONDATE=20230120
export VERSION=43.2
export VERSIONDATE=20230216
wl-showstatus --package-version
export DEPENDENCIES=gtk4,gsettings-desktop-schemas,libx11,libxrandr,xkeyboard-config,iso-codes,gobject-introspection
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=meson,itstool
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=COPYING
export LICENSETYPE="GPL/FDL"
export DOWNLOADURL="http://ftp.gnome.org/pub/GNOME/sources/gnome-desktop/"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=http://ftp.gnome.org/pub/gnome/sources/$BASENAME/$(echo $VERSION|sed 's/^\([0-9]*\)\..*$/\1/')/$BASENAME-$VERSION.tar.xz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
#tar xfj $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.bz2
tar xfJ $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.xz
cd $BASENAME-$VERSION
# fix MSVC issue
mkdir -p winfix
cp -rf $PYDIR/lib/distutils winfix/
patch -ulbf winfix/distutils/cygwinccompiler.py << EOF
@@ -85,3 +85,3 @@
         else:
-            raise ValueError("Unknown MS Compiler version %s " % msc_ver)
+            return None

EOF
# fix libgnome-desktop/gnome-wall-clock.c (version >= 3.38.3)
patch -ulbf libgnome-desktop/gnome-wall-clock.c << EOF
@@ -27,2 +27,8 @@
 #include <locale.h>
+#ifdef _WIN32
+#define locale_t _locale_t
+#define newlocale(dummycat,l,dummyloc) _create_locale(LC_ALL,l)
+#define uselocale(l) setlocale(0,l)
+#define freelocale _free_locale
+#endif
 #include <glib/gi18n-lib.h>
EOF
# fix missing F_SETFD in libgnome-desktop/gnome-desktop-thumbnail-script.c (version >= 3.36.2)
patch -ulbf libgnome-desktop/gnome-desktop-thumbnail-script.c << EOF
@@ -826,4 +826,6 @@
   /* Otherwise, mark not - close-on-exec all the fds in the array */
+#ifdef F_SETFD
   for (i = 0; i < fd_array->len; i++)
     fcntl (g_array_index (fd_array, int, i), F_SETFD, 0);
+#endif
 }
EOF
# fix missing realpath in libgnome-desktop/gnome-desktop-thumbnail-script.c (version >= 42.0)
mv libgnome-desktop/gnome-desktop-thumbnail-script.c libgnome-desktop/gnome-desktop-thumbnail-script.c.bak &&
echo "#define realpath(N,R) _fullpath((R),(N),_MAX_PATH)" > libgnome-desktop/gnome-desktop-thumbnail-script.c &&
cat libgnome-desktop/gnome-desktop-thumbnail-script.c.bak >> libgnome-desktop/gnome-desktop-thumbnail-script.c
# fix libgnome-desktop/gnome-idle-monitor.c (version >= 3.38.3)
patch -ulbf libgnome-desktop/gnome-idle-monitor.c << EOF
@@ -36,3 +36,2 @@

-G_STATIC_ASSERT(sizeof(unsigned long) == sizeof(gpointer));

EOF
## fix libgnome-desktop/gnome-languages.c (version >= 3.38.3)
#patch -ulbf libgnome-desktop/gnome-languages.c << EOF
#@@ -31,3 +31,8 @@
# #include <locale.h>
#+#ifdef _WIN32
#+#define nl_langinfo(codeset) "UTF-8"
#+#define locale_t _locale_t
#+#else
# #include <langinfo.h>
#+#endif
# #include <sys/stat.h>
#@@ -41,3 +46,5 @@
#
#+#ifndef _WIN32
# #include <langinfo.h>
#+#endif
# #ifndef __LC_LAST
#@@ -290,2 +297,3 @@
#
#+#ifndef _WIN32
#         locale = newlocale (LC_MESSAGES_MASK, language_name, (locale_t) 0);
#@@ -295,2 +303,3 @@
#         }
#+#endif
#
#@@ -308,2 +317,8 @@
#
#+#ifdef _WIN32
#+        if (pcodeset != NULL)
#+                *pcodeset = g_strdup (language_name);
#+        if (is_utf8 != NULL)
#+                *is_utf8 = stricmp(language_name, "UTF-8") == 0;
#+#else
#         locale = newlocale (LC_CTYPE_MASK, language_name, (locale_t) 0);
#@@ -328,2 +343,3 @@
#         freelocale (locale);
#+#endif
# }
#@@ -495,2 +511,3 @@
#
#+#ifndef _WIN32
#         ndirents = scandir (LIBLOCALEDIR, &dirents, select_dirs, alphasort);
#@@ -505,2 +522,3 @@
#         }
#+#endif
#         return found_locales;
#@@ -708,2 +726,3 @@
#
#+#ifndef _WIN32
#                 if (locale != NULL) {
#@@ -714,2 +733,3 @@
#                 }
#+#endif
#
#@@ -724,2 +744,3 @@
#
#+#ifndef _WIN32
#                 if (locale != NULL) {
#@@ -728,2 +749,3 @@
#                 }
#+#endif
#         }
#@@ -761,2 +783,3 @@
#         name = NULL;
#+#ifndef _WIN32
#         if (territory != NULL) {
#@@ -783,2 +806,3 @@
#         }
#+#endif
#
#@@ -1365,2 +1389,3 @@
#
#+#ifndef _WIN32
#         if (translation != NULL) {
#@@ -1372,2 +1397,3 @@
#         }
#+#endif
#
#@@ -1409,2 +1435,3 @@
#
#+#ifndef _WIN32
#         if (translation != NULL) {
#@@ -1413,2 +1440,3 @@
#         }
#+#endif
#
#EOF
# fix libgnome-desktop/gnome-languages.c (version >= 42.0)
patch -ulbf libgnome-desktop/gnome-languages.c << EOF
@@ -30,3 +30,11 @@
 #include <dirent.h>
+#ifdef _WIN32
+#define nl_langinfo(codeset) "UTF-8"
+#define locale_t _locale_t
+#define freelocale(...)
+#define newlocale(...) 0
+#define nl_langinfo_l(...) "UTF-8"
+#else
 #include <langinfo.h>
+#endif
 #include <sys/stat.h>
@@ -46,3 +54,2 @@

-#include <langinfo.h>
 #ifndef __LC_LAST
@@ -499,2 +506,3 @@
         gboolean found_locales = FALSE;
+#ifndef _WIN32
         struct dirent **dirents;
@@ -513,2 +521,3 @@
         }
+#endif
         return found_locales;
EOF
# fix missing locale_t in libgnome-desktop/gnome-gettext-portable.c (version >= 42.0)
sed -i.bak -e "s/locale_t/_&/" libgnome-desktop/gnome-gettext-portable.c
## fix libgnome-desktop/gnome-gettext-portable.c (version >= 41.0)
#patch -ulbf libgnome-desktop/gnome-gettext-portable.c << EOF
#@@ -22,2 +22,8 @@
# #include <locale.h>
#+#ifdef _WIN32
#+#define locale_t _locale_t
#+#define newlocale(dummycat,l,dummyloc) _create_locale(LC_ALL,l)
#+#define uselocale(l) setlocale(0,l)
#+#define freelocale _free_locale
#+#endif
# #ifdef HAVE_XLOCALE
#EOF
# fix missing EXIT_FAILURE in libgnome-desktop/test-desktop-thumbnail.c (version >= 40.0)
mv libgnome-desktop/test-desktop-thumbnail.c libgnome-desktop/test-desktop-thumbnail.c.bak &&
echo "#include <stdlib.h>" > libgnome-desktop/test-desktop-thumbnail.c &&
cat libgnome-desktop/test-desktop-thumbnail.c.bak >> libgnome-desktop/test-desktop-thumbnail.c
# skip building tests
sed -i.bak2 -e "s/^subdir('tests')/#&/" meson.build
# fix missing gio-unix
sed -i.bak -e "s/gio-unix/gio-windows/" meson.build
mkdir -p build_both &&
 wl-showstatus configure &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -D date_in_gnome_version=false -D udev=disabled -D system=disabled -D documentation=true -D installed_tests=false -Dc_args="-I$(pwd)/winfix -I$(echo $MINGWPREFIX|sed -e "s?^/\([a-zA-Z]\)/?\1:/?"g)/include/gsettings-desktop-schemas" . build_both &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Ddate_in_gnome_version=false -Dudev=disabled -Dsystem=disabled -Dgtk_doc=false -Ddesktop_docs=false -Dinstalled_tests=false -Dc_args="-I$(pwd)/winfix -I$(echo $MINGWPREFIX|sed -e "s?^/\([a-zA-Z]\)/?\1:/?"g)/include/gsettings-desktop-schemas" . build_both &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Ddate_in_gnome_version=false -Dudev=disabled -Dsystemd=disabled -Dgtk_doc=false -Ddesktop_docs=false -Dinstalled_tests=false -Dc_args="-I$(pwd)/winfix -I$(echo $MINGWPREFIX|sed -e "s?^/\([a-zA-Z]\)/?\1:/?"g)/include/gsettings-desktop-schemas" . build_both &&
 PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Dudev=disabled -Dsystemd=disabled -Dgtk_doc=false -Ddesktop_docs=false -Dinstalled_tests=false -Dc_args="-I$(pwd)/winfix -I$(echo $MINGWPREFIX|sed -e "s?^/\([a-zA-Z]\)/?\1:/?"g)/include/gsettings-desktop-schemas" . build_both &&
 #PKG_CONFIG= PYTHONPATH=${PYTHONPATH:+$PYTHONPATH:}$MINGWPREFIX/lib $PYDIR/python.exe $(which meson.py) --prefix $INSTALLPREFIX --backend ninja --buildtype release --strip --default-library both -Ddate_in_gnome_version=false -Dudev=disabled -Dsystemd=disabled -Dgtk_doc=false -Ddesktop_docs=false -Dinstalled_tests=false -Dc_args="-I$(pwd)/winfix -I$(echo $MINGWPREFIX|sed -e "s?^/\([a-zA-Z]\)/?\1:/?"g)/include/gsettings-desktop-schemas -Dlocale_t=_locale_t" . build_both &&
 # fix slash/backslash path issue when calling Python from Ninja
 sed -i.bak -e "s/join_paths/os.path.join/g; /COMMAND =.*python\.exe/ s?\"/\([a-zA-Z]\)/?\"\1:/?; /COMMAND =.*python\.exe/ s?/?\\\\?g" build_*/build.ninja &&
 wl-showstatus build-install &&
 PATH=$PATH:$PYDIR PKG_CONFIG= PYTHONPATH=$(pwd)/winfix:$MINGWPREFIX/lib${PYTHONPATH:+:$PYTHONPATH} ninja -Cbuild_both install &&
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && rm -rf $BASENAME-$VERSION



