export NAME="FreeTDS"
export STATUS=
export URL=http://www.freetds.org/
export BASENAME=freetds
export DESCRIPTION="FreeTDS is a set of libraries for Unix and Linux that allows your programs to natively talk to Microsoft SQL Server and Sybase databases."
export CATEGORY=db
export TYPE=library
#export VERSION=0.64
#export VERSION=0.82
#export VERSIONDATE=
#export VERSION=0.91
#export VERSIONDATE=20110818
#export VERSION=0.91.81
#export VERSIONDATE=20121122
#export VERSION=0.91.82
#export VERSIONDATE=20121206
#export VERSION=0.91.83
#export VERSIONDATE=20130301
#export VERSION=0.91.84
#export VERSIONDATE=20130406
#export VERSION=0.91.85
#export VERSIONDATE=20130413
#export VERSION=0.91.86
#export VERSIONDATE=20130507
#export VERSION=0.91.87
#export VERSIONDATE=20130520
#export VERSION=0.91.89
#export VERSIONDATE=20130607
#export VERSION=0.91.90
#export VERSIONDATE=20130822
#export VERSION=0.91.91
#export VERSIONDATE=20130914
#export VERSION=0.91.92
#export VERSIONDATE=20130915
#export VERSION=0.91.93
#export VERSIONDATE=20131008
#export VERSION=0.91.95
#export VERSIONDATE=20131018
#export VERSION=0.91.96
#export VERSIONDATE=20131019
#export VERSION=0.91.97
#export VERSIONDATE=20131119
#export VERSION=0.91.98
#export VERSIONDATE=20131120
#export VERSION=0.91.99
#export VERSIONDATE=20131220
#export VERSION=0.91.100
#export VERSIONDATE=20140124
#export VERSION=0.91.102
#export VERSIONDATE=20140302
#export VERSION=0.91.103
#export VERSIONDATE=20140509
#export VERSION=0.91.112
#export VERSIONDATE=20150129
#export VERSION=0.91.112.0.0
#export VERSIONDATE=20150506
#export VERSION=0.92.63
#export VERSIONDATE=20120826
#export VERSION=0.92.79
#export VERSIONDATE=20121003
#export VERSION=0.92.405
#export VERSIONDATE=20121006
#export VERSION=0.95.0
#export VERSIONDATE=20150609
#export VERSION=0.95.1
#export VERSIONDATE=20150613
#export VERSION=0.95.5
#export VERSIONDATE=20150618
#export VERSION=0.95.6
#export VERSIONDATE=20150621
#export VERSION=0.95.8
#export VERSIONDATE=20150622
#export VERSION=0.95.13
#export VERSIONDATE=20150629
#export VERSION=0.95.14
#export VERSIONDATE=20150701
#export VERSION=0.95.18
#export VERSIONDATE=20150702
#export VERSION=0.95.19
#export VERSIONDATE=20150721
#export VERSION=0.95.20
#export VERSIONDATE=20150924
#export VERSION=0.95.21
#export VERSIONDATE=20151011
####include/tds_sysdep_public.h:36:21: fatal error: wspiapi.h: No such file or directory
#export VERSION=0.95.64
#export VERSIONDATE=20151015
####/include/process.h:172:26: error: macro "getpid" passed 1 arguments, but takes just 0
#export VERSION=0.95.65
#export VERSIONDATE=20151020
#export VERSION=0.95.67
#export VERSIONDATE=20151110
#export VERSION=0.95.69
#export VERSIONDATE=20151117
#export VERSION=0.95.73
#export VERSIONDATE=20151202
#export VERSION=0.95.74
#export VERSIONDATE=20151210
#export VERSION=0.95.75
#export VERSIONDATE=20151211
#export VERSION=0.95.76
#export VERSIONDATE=20151220
#export VERSION=0.95.77
#export VERSIONDATE=20151222
#export VERSION=0.95.78
#export VERSIONDATE=20151225
#export VERSION=0.95.79
#export VERSIONDATE=20160104
#export VERSION=0.95.80
#export VERSIONDATE=20160116
#export VERSION=0.95.81
#export VERSIONDATE=20160206
#export VERSION=0.95.82
#export VERSIONDATE=20160210
#export VERSION=0.95.84
#export VERSIONDATE=20160212
#export VERSION=0.95.87
#export VERSIONDATE=20160214
#export VERSION=0.95.88
#export VERSIONDATE=20160321
#export VERSION=0.95.89
#export VERSIONDATE=20160326
#export VERSION=0.95.91
#export VERSIONDATE=20160406
#export VERSION=0.95.92
#export VERSIONDATE=20160416
#export VERSION=0.95.94
#export VERSIONDATE=20160419
#export VERSION=0.95.95
#export VERSIONDATE=20160423
#export VERSION=1.00
#export VERSIONDATE=20160519
#export VERSION=1.00.1
#export VERSIONDATE=20160610
#export VERSION=1.00.3
#export VERSIONDATE=20160613
#export VERSION=1.00.6
#export VERSIONDATE=20160619
#export VERSION=1.00.7
#export VERSIONDATE=20160626
#export VERSION=1.00.8
#export VERSIONDATE=20160627
#export VERSION=1.00.9
#export VERSIONDATE=20160628
#export VERSION=1.00.10
#export VERSIONDATE=20160718
#export VERSION=1.00.11
#export VERSIONDATE=20160719
#export VERSION=1.00.13
#export VERSIONDATE=20160725
#export VERSION=1.00.14
#export VERSIONDATE=20160826
#export VERSION=1.00.15
#export VERSIONDATE=20160902
#export VERSION=1.00.16
#export VERSIONDATE=20161104
#export VERSION=1.00.18
#export VERSIONDATE=20161106
#export VERSION=1.00.19
#export VERSIONDATE=20161112
#export VERSION=1.00.20
#export VERSIONDATE=20161116
#export VERSION=1.00.21
#export VERSIONDATE=20161117
#export VERSION=1.00.23
#export VERSIONDATE=20161206
#export VERSION=1.00.24
#export VERSIONDATE=20161225
#export VERSION=1.00.25
#export VERSIONDATE=20170205
#export VERSION=1.00.26
#export VERSIONDATE=20170207
#export VERSION=1.00.27
#export VERSIONDATE=20170215
#export VERSION=1.00.33
#export VERSIONDATE=20170427
#export VERSION=1.00.37
#export VERSIONDATE=20170430
#export VERSION=1.00.38
#export VERSIONDATE=20170503
#export VERSION=1.00.39
#export VERSIONDATE=20170518
#export VERSION=1.00.40
#export VERSIONDATE=20170525
#export VERSION=1.00.41
#export VERSIONDATE=20170606
#export VERSION=1.00.42
#export VERSIONDATE=20170607
#export VERSION=1.00.43
#export VERSIONDATE=20170609
#export VERSION=1.00.44
#export VERSIONDATE=20170611
#export VERSION=1.00.47
#export VERSIONDATE=20170619
#export VERSION=1.00.48
#export VERSIONDATE=20170706
#export VERSION=1.00.54
#export VERSIONDATE=20170815
#export VERSION=1.00.55
#export VERSIONDATE=20170903
#export VERSION=1.00.56
#export VERSIONDATE=20170914
#export VERSION=1.00.58
#export VERSIONDATE=20170917
#export VERSION=1.00.59
#export VERSIONDATE=20170918
#export VERSION=1.00.60
#export VERSIONDATE=20170922
#export VERSION=1.00.62
#export VERSIONDATE=20170922
#export VERSION=1.00.63
#export VERSIONDATE=20170923
#export VERSION=1.00.64
#export VERSIONDATE=20171001
#export VERSION=1.00.67
#export VERSIONDATE=20171010
#export VERSION=1.00.68
#export VERSIONDATE=20171028
#export VERSION=1.00.70
#export VERSIONDATE=20171101
#export VERSION=1.00.74
#export VERSIONDATE=20171118
#export VERSION=1.00.77
#export VERSIONDATE=20171119
#export VERSION=1.00.78
#export VERSIONDATE=20171122
#export VERSION=1.00.79
#export VERSIONDATE=20171126
#export VERSION=1.00.80
#export VERSIONDATE=20171130
#export VERSION=1.00.81
#export VERSIONDATE=20180215
#export VERSION=1.00.82
#export VERSIONDATE=20180220
#export VERSION=1.00.83
#export VERSIONDATE=20180311
#export VERSION=1.00.84
#export VERSIONDATE=20180402
#export VERSION=1.00.85
#export VERSIONDATE=20180403
#export VERSION=1.00.87
#export VERSIONDATE=20180412
#export VERSION=1.00.88
#export VERSIONDATE=20180416
#export VERSION=1.00.89
#export VERSIONDATE=20180417
#export VERSION=1.00.91
#export VERSIONDATE=20180418
#export VERSION=1.00.92
#export VERSIONDATE=20180701
#export VERSION=1.00.94
#export VERSIONDATE=20180722
#export VERSION=1.00.96
#export VERSIONDATE=20180724
#export VERSION=1.00.97
#export VERSIONDATE=20180828
#export VERSION=1.00.98
#export VERSIONDATE=20180912
#export VERSION=1.00.99
#export VERSIONDATE=20180929
#export VERSION=1.00.100
#export VERSIONDATE=20181003
#export VERSION=1.00.103
#export VERSIONDATE=20181005
#export VERSION=1.00.104
#export VERSIONDATE=20181007
#export VERSION=1.00.107
#export VERSIONDATE=20181106
#export VERSION=1.00.108
#export VERSIONDATE=20181113
#export VERSION=1.00.109
#export VERSIONDATE=20181127
#export VERSION=1.00.110
#export VERSIONDATE=20190105
#export VERSION=1.00.111
#export VERSIONDATE=20190121
#export VERSION=1.00.112
#export VERSIONDATE=20190429
#export VERSION=1.1
#export VERSIONDATE=20190314
#export VERSION=1.1.1
#export VERSIONDATE=20190318
#export VERSION=1.1.2
#export VERSIONDATE=20190322
#export VERSION=1.1.3
#export VERSIONDATE=20190328
#export VERSION=1.1.4
#export VERSIONDATE=20190330
#export VERSION=1.1.5
#export VERSIONDATE=20190418
#export VERSION=1.1.6
#export VERSIONDATE=20190429
#export VERSION=1.1.10
#export VERSIONDATE=20190709
#export VERSION=1.1.11
#export VERSIONDATE=20190710
#export VERSION=1.1.12
#export VERSIONDATE=20190810
#export VERSION=1.1.14
#export VERSIONDATE=20190831
#export VERSION=1.1.15
#export VERSIONDATE=20190902
#export VERSION=1.1.16
#export VERSIONDATE=20190923
#export VERSION=1.1.17
#export VERSIONDATE=20191008
#export VERSION=1.1.19
#export VERSIONDATE=20191013
#export VERSION=1.1.20
#export VERSIONDATE=20191017
#export VERSION=1.1.21
#export VERSIONDATE=20191113
#export VERSION=1.1.23
#export VERSIONDATE=20191201
####net.c:87:21: fatal error: mstcpip.h: No such file or directory
#export VERSION=1.1.24
#export VERSIONDATE=20191210
#export VERSION=1.1.26
#export VERSIONDATE=20200330
#export VERSION=1.1.29
#export VERSIONDATE=20200409
#export VERSION=1.1.30
#export VERSIONDATE=20200410
#export VERSION=1.1.32
#export VERSIONDATE=20200411
#export VERSION=1.1.33
#export VERSIONDATE=20200417
#export VERSION=1.1.36
#export VERSIONDATE=20200504
#export VERSION=1.1.39
#export VERSIONDATE=20200517
#export VERSION=1.1.40
#export VERSIONDATE=20200522
#export VERSION=1.1.41
#export VERSIONDATE=20200613
#export VERSION=1.1.42
#export VERSIONDATE=20200614
#export VERSION=1.2
#export VERSIONDATE=20200704
#export VERSION=1.2.2
#export VERSIONDATE=20200707
#export VERSION=1.2.3
#export VERSIONDATE=20200709
#export VERSION=1.2.4
#export VERSIONDATE=20200904
#export VERSION=1.2.5
#export VERSIONDATE=20200918
#export VERSION=1.2.6
#export VERSIONDATE=20201029
#export VERSION=1.2.9
#export VERSIONDATE=20201030
#export VERSION=1.2.10
#export VERSIONDATE=20201031
#export VERSION=1.2.11
#export VERSIONDATE=20201112
#export VERSION=1.2.12
#export VERSIONDATE=20201121
#export VERSION=1.2.13
#export VERSIONDATE=20201129
#export VERSION=1.2.17
#export VERSIONDATE=20201209
#export VERSION=1.2.18
#export VERSIONDATE=20201218
#export VERSION=1.2.19
#export VERSIONDATE=20210410
#export VERSION=1.2.20
#export VERSIONDATE=20210413
#export VERSION=1.2.21
#export VERSIONDATE=20210424
#export VERSION=1.3
#export VERSIONDATE=20210713
#export VERSION=1.3.1
#export VERSIONDATE=20210818
#export VERSION=1.3.2
#export VERSIONDATE=20210825
#export VERSION=1.3.3
#export VERSIONDATE=20210831
#export VERSION=1.3.4
#export VERSIONDATE=20211113
#export VERSION=1.3.5
#export VERSIONDATE=20211225
#export VERSION=1.3.6
#export VERSIONDATE=20211227
#export VERSION=1.3.7
#export VERSIONDATE=20220205
#export VERSION=1.3.8
#export VERSIONDATE=20220210
#export VERSION=1.3.9
#export VERSIONDATE=20220211
#export VERSION=1.3.10
#export VERSIONDATE=20220415
#export VERSION=1.3.11
#export VERSIONDATE=20220531
#export VERSION=1.3.12
#export VERSIONDATE=20220611
#export VERSION=1.3.13
#export VERSIONDATE=20220817
#export VERSION=1.3.14
#export VERSIONDATE=20221108
#export VERSION=1.3.15
#export VERSIONDATE=20221122
#export VERSION=1.3.16
#export VERSIONDATE=20221209
#export VERSION=1.3.17
#export VERSIONDATE=20230121
#export VERSION=1.3.18
#export VERSIONDATE=20230401
#export VERSION=1.3.19
#export VERSIONDATE=20230814
#export VERSION=1.3.20
#export VERSIONDATE=20230827
#export VERSION=1.3.21
#export VERSIONDATE=20230927
#export VERSION=1.4
#export VERSIONDATE=20230923
#export VERSION=1.4.1
#export VERSIONDATE=20230926
#export VERSION=1.4.2
#export VERSIONDATE=20230927
#export VERSION=1.4.3
#export VERSIONDATE=20231013
#export VERSION=1.4.4
#export VERSIONDATE=20231021
#export VERSION=1.4.5
#export VERSIONDATE=20231022
#export VERSION=1.4.6
#export VERSIONDATE=20231028
#export VERSION=1.4.7
#export VERSIONDATE=20231124
#export VERSION=1.4.8
#export VERSIONDATE=20231126
#export VERSION=1.4.9
#export VERSIONDATE=20231203
#export VERSION=1.4.10
#export VERSIONDATE=20231204
#export VERSION=1.4.11
#export VERSIONDATE=20240329
#export VERSION=1.4.12
#export VERSIONDATE=20240401
#export VERSION=1.4.13
#export VERSIONDATE=20240510
#export VERSION=1.4.14
#export VERSIONDATE=20240517
#export VERSION=1.4.15
#export VERSIONDATE=20240528
#export VERSION=1.4.16
#export VERSIONDATE=20240529
#export VERSION=1.4.17
#export VERSIONDATE=20240603
#export VERSION=1.4.19
#export VERSIONDATE=20240704
#export VERSION=1.4.20
#export VERSIONDATE=20240716
#export VERSION=1.4.21
#export VERSIONDATE=20240722
#export VERSION=1.4.22
#export VERSIONDATE=20240724
#export VERSION=1.4.23
#export VERSIONDATE=20240930
#export VERSION=1.4.24
#export VERSIONDATE=20241210
#export VERSION=1.4.25
#export VERSIONDATE=20250123
#export VERSION=1.4.27
#export VERSIONDATE=20250416
####src/tds/convert.c:585:1: error: conflicting types for 'tds_convert_int1'; have 'TDS_INT(const TDS_TINYINT *, int,  CONV_RESULT *)' {aka 'int(const unsigned char *, int,  union conv_result *)'}
#export VERSION=1.5
#export VERSIONDATE=20250418
#export VERSION=1.5.1
#export VERSIONDATE=20250422
#export VERSION=1.5.2
#export VERSIONDATE=20250601
#export VERSION=1.5.3
#export VERSIONDATE=20250620
#export VERSION=1.5.4
#export VERSIONDATE=20250626
export VERSION=1.5.5
export VERSIONDATE=20250830
wl-showstatus --package-version
#export DEPENDENCIES=libiconv,openssl
export DEPENDENCIES=libiconv,gnutls,libgcrypt,libtasn1
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=
export OPTIONALBUILDDEPENDENCIES=
#export LICENSEFILE=COPYING.LIB
export LICENSEFILE=COPYING_LIB.txt
export LICENSETYPE=LGPL
#export DOWNLOADURL="http://ibiblio.org/pub/Linux/ALPHA/freetds/stable/"
#export DOWNLOADURL="ftp://ftp.freetds.org/pub/freetds/stable/"
#export DOWNLOADURL="http://www.freetds.org/files/stable/"
export DOWNLOADURL="https://www.freetds.org/files/stable/"
#export DOWNLOADURL="https://github.com/FreeTDS/freetds/tags"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
#export DOWNLOADSOURCEURL=http://ftp.ibiblio.org/pub/Linux/ALPHA/freetds/stable/$BASENAME-$VERSION.tar.gz
#export DOWNLOADSOURCEURL=ftp://ftp.freetds.org/pub/freetds/stable/$BASENAME-$VERSION.tar.bz2
#export DOWNLOADSOURCEURL=http://www.freetds.org/files/stable/$BASENAME-$VERSION.tar.bz2
export DOWNLOADSOURCEURL=https://www.freetds.org/files/stable/$BASENAME-$VERSION.tar.bz2
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
#tar xz --force-local -f $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.gz
tar xj --force-local -f $TARBALLDIR/$BASENAME/$BASENAME-$VERSION.tar.bz2
cd $BASENAME-$VERSION
## fix include/tdsthread.h (version >= 0.91.112 <= 0.92.405)
#patch -ulbf include/tdsthread.h << EOF
#--- include/tdsthread.h  2015-01-29 01:40:17.000000000 +0100
#+++ include/tdsthread.h  2015-04-23 14:28:26.107397200 +0200
#@@ -27,5 +27,5 @@
# #undef TDS_HAVE_MUTEX
#
#-#if defined(_THREAD_SAFE) && defined(TDS_HAVE_PTHREAD_MUTEX)
#+#if defined(_THREAD_SAFE) && defined(TDS_HAVE_PTHREAD_MUTEX) && !defined(_WIN32)
#
# #include <pthread.h>
#EOF
#cp -f win32/config.h include/
# fix missing wspiapi.h
echo "#include <wspiapi.h>" | gcc -c -xc - &>/dev/null || (
 mv include/freetds/sysdep_private.h include/freetds/sysdep_private.h.bak
 grep -v "#include <wspiapi.h>" include/freetds/sysdep_private.h.bak > include/freetds/sysdep_private.h
 mv include/tds_sysdep_public.h.in include/tds_sysdep_public.h.in.bak
 grep -v "#include <wspiapi.h>" include/tds_sysdep_public.h.in.bak > include/tds_sysdep_public.h.in
)
# fix missing in_addr_t/EAI_OVERFLOW in src/replacements/getaddrinfo.c
if ! gcc --version | grep -qi MinGW-W64 &> /dev/null; then
mv src/replacements/getaddrinfo.c src/replacements/getaddrinfo.c.bak
cat > src/replacements/getaddrinfo.c << EOF
#define in_addr_t uint32_t
#define EAI_OVERFLOW 8
#define hostip host
EOF
cat src/replacements/getaddrinfo.c.bak >> src/replacements/getaddrinfo.c
fi
## compile Windows ODBC DLL separately
#cd win32/dev-cpp
#cp ../version.rc FreeTDS_private.rc
#make -f Makefile.win
#cd ../..
#echo "#define sleep(t) _sleep((t) * 1000)" >> include/config.h
# fix redefinition of getpid in src/replacements/fakepoll.c (version >= 0.95.64)
mv src/replacements/fakepoll.c src/replacements/fakepoll.c.bak
cat > src/replacements/fakepoll.c << EOF
#define getpid wingetpid
#include <process.h>
#undef getpid
EOF
cat src/replacements/fakepoll.c.bak >> src/replacements/fakepoll.c
# fix missing inet_pton in src/tds/tls.c (version >= 1.00)
mv src/tds/tls.c src/tds/tls.c.bak &&
echo "#define _WIN32_WINNT 0x0600" > src/tds/tls.c &&
cat src/tds/tls.c.bak >> src/tds/tls.c
# fix missing inet_pton in src/tds/tls.c (version >= 1.00.1)
if ! ${CC:-gcc} --version | grep -q "MinGW-W64\|-w64" ; then
mv src/tds/tls.c src/tds/tls.c.bak2 &&
echo "#define inet_pton(af,src,dst) 0" > src/tds/tls.c &&
cat src/tds/tls.c.bak2 >> src/tds/tls.c
fi
# fix mismatching redefinition of tds_convert_int1() in src/tds/convert.c (version >= 1.4.25)
patch -ulbf src/tds/convert.c << EOF
@@ -583,3 +583,3 @@
 static TDS_INT
-tds_convert_int1(const int8_t * src, int desttype, CONV_RESULT * cr)
+tds_convert_int1(const TDS_TINYINT * src, int desttype, CONV_RESULT * cr)
 {
EOF
## fix libtds.la
#mv $INSTALLPREFIX/lib/libtds.la $INSTALLPREFIX/lib/libtds.la.bak
#sed -e "s/^dlname=''$/dlname='libsybdb-5.dll'/; s/library_names=''/library_names='libsybdb.dll.a'/" $INSTALLPREFIX/lib/libtds.la.bak > $INSTALLPREFIX/lib/libtds.la
#rm $INSTALLPREFIX/lib/libtds.la.bak
wl-showstatus configure &&
 # fix building DLLs on 64-bit
 #if ( echo $RUNPLATFORM | grep -q x86_64 ); then
 # echo "AM_GNU_GETTEXT_VERSION(`gettext --version|head -n1|sed -e "s/^.* \([0-9\.]*\) *$/\1/"`)" >> configure.ac &&
 # autoreconf -f -i -I m4 -I $MINGWPREFIX/share/aclocal
 #fi
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --disable-odbc --disable-pool --disable-apps &&
 #./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --with-gnutls --without-openssl --disable-pool &&
 ./configure --prefix=$INSTALLPREFIX --build=$BUILDPLATFORM --host=$RUNPLATFORM --with-gnutls --without-openssl --enable-msdblib --enable-pool &&
 wl-showstatus build-install &&
 ( make install-strip || (
  # fix undefined reference to _imp___lock_file/_imp___unlock_file
  echo "#undef HAVE__LOCK_FILE" >> include/config.h &&
  make install-strip
 ) || make -j1 install-strip ) &&
 cp -f $INSTALLPREFIX/lib/libsybdb.la $INSTALLPREFIX/lib/libtds.la &&
 cp -f $INSTALLPREFIX/lib/libsybdb.a $INSTALLPREFIX/lib/libtds.a &&
 ( cp $INSTALLPREFIX/lib/libsybdb.dll.a $INSTALLPREFIX/lib/libtds.dll.a || true ) &&
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION



#mkdir -p build_win &&
# wl-showstatus configure &&
# cmake.exe -Wno-dev -GNinja -DCMAKE_INSTALL_PREFIX:PATH=$INSTALLPREFIX -DCMAKE_BUILD_TYPE:STRING=Release -DWITH_OPENSSL:BOOL=ON -S. -Bbuild_win &&
# wl-showstatus build-install &&
# ninja -Cbuild_win install/strip &&
#    echo OK