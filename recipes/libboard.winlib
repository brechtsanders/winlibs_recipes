export NAME="libboard"
export STATUS=
export URL=https://github.com/GreycLab/libboard
export BASENAME=libboard
export DESCRIPTION="The LibBoard C++ library allows the drawing of Postscript, SVG, and FIG (XFig) vector graphics using the C++ programming language. It is suitable for adding SVG/EPS/FIG output support to a program; but also for drawing graphics that involve a large (huge?) number of primitives. In the latter case, one can indeed use loops, variables, functions and all C++ features. Produced files may afterwards be edited using dedicated tools."
export CATEGORY=graphics
export TYPE=library
export VERSION=0.9.6
export VERSIONDATE=20250822
wl-showstatus --package-version
export DEPENDENCIES=imagemagick
export OPTIONALDEPENDENCIES=
export BUILDDEPENDENCIES=cmake,ninja
export OPTIONALBUILDDEPENDENCIES=
export LICENSEFILE=LICENSE
export LICENSETYPE=
export DOWNLOADURL="https://github.com/GreycLab/libboard/tags"
export INSTALLPREFIX=`pwd`/inst_$BASENAME-$VERSION
export DOWNLOADSOURCEURL=https://github.com/GreycLab/libboard/archive/refs/tags/v$VERSION.tar.gz
wl-showstatus download
wl-download -v -d $TARBALLDIR/$BASENAME $DOWNLOADSOURCEURL
wl-wait4deps
wl-showstatus extract
tar xz --force-local -f $TARBALLDIR/$BASENAME/v$VERSION.tar.gz
cd $BASENAME-$VERSION
# fix CMakeLists.txt (version >= 0.9.6)
patch -ulbf CMakeLists.txt << EOF
@@ -65,3 +65,3 @@

-IF(NOT MYPROJ_RAN_ONCE)
+IF(FALSE)
   SET(MYPROJ_RAN_ONCE 1 CACHE INTERNAL "")
EOF
mkdir -p build_win &&
 wl-showstatus configure &&
 cmake.exe -Wno-dev -GNinja -DCMAKE_INSTALL_PREFIX:PATH=$INSTALLPREFIX -DCMAKE_BUILD_TYPE:STRING=Release -S. -Bbuild_win &&
 # fix missing link libraries
 sed -i.bak -e "s/^\s*LINK_LIBRARIES\s*=.*$/& -Wl,--as-needed $(${PKG_CONFIG:-pkg-config} --libs-only-l Magick++)/" build_win/build.ninja &&
 wl-showstatus build-install &&
 ninja -Cbuild_win install/strip &&
 # manually move .dll to bin folder
 mkdir -p $INSTALLPREFIX/bin &&
 mv -f $INSTALLPREFIX/lib/*.dll $INSTALLPREFIX/bin/ &&
 wl-makepackage -c -d && wl-install -d $BASENAME-$VERSION && cd .. && wl-showstatus cleanup && rm -rf $BASENAME-$VERSION



